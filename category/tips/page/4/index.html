<!DOCTYPE html>
<html lang="en-US">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="HandheldFriendly" content="True" />
<meta name="MobileOptimized" content="320" />

<title>tips | jeromecukier.net | Page 4</title>

<link rel="profile" href="http://gmpg.org/xfn/11">
<link rel="pingback" href="/xmlrpc.php">
<link rel='dns-prefetch' href='//fonts.googleapis.com' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel="alternate" type="application/rss+xml" title="jeromecukier.net &raquo; Feed" href="/feed/" />
<link rel="alternate" type="application/rss+xml" title="jeromecukier.net &raquo; Comments Feed" href="/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="jeromecukier.net &raquo; tips Category Feed" href="/category/tips/feed/" />
<!-- This site uses the Google Analytics by MonsterInsights plugin v7.0.5 - Using Analytics tracking - https://www.monsterinsights.com/ -->
<!-- Note: MonsterInsights is not currently configured on this site. The site owner needs to authenticate with Google Analytics in the MonsterInsights settings panel. -->
<!-- No UA code set -->
<!-- / Google Analytics by MonsterInsights -->
		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2\/svg\/","svgExt":".svg","source":{"concatemoji":"http:\/\/localhost:8888\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.6.10"}};
			!function(a,b,c){function d(a){var c,d,e,f,g,h=b.createElement("canvas"),i=h.getContext&&h.getContext("2d"),j=String.fromCharCode;if(!i||!i.fillText)return!1;switch(i.textBaseline="top",i.font="600 32px Arial",a){case"flag":return i.fillText(j(55356,56806,55356,56826),0,0),!(h.toDataURL().length<3e3)&&(i.clearRect(0,0,h.width,h.height),i.fillText(j(55356,57331,65039,8205,55356,57096),0,0),c=h.toDataURL(),i.clearRect(0,0,h.width,h.height),i.fillText(j(55356,57331,55356,57096),0,0),d=h.toDataURL(),c!==d);case"diversity":return i.fillText(j(55356,57221),0,0),e=i.getImageData(16,16,1,1).data,f=e[0]+","+e[1]+","+e[2]+","+e[3],i.fillText(j(55356,57221,55356,57343),0,0),e=i.getImageData(16,16,1,1).data,g=e[0]+","+e[1]+","+e[2]+","+e[3],f!==g;case"simple":return i.fillText(j(55357,56835),0,0),0!==i.getImageData(16,16,1,1).data[0];case"unicode8":return i.fillText(j(55356,57135),0,0),0!==i.getImageData(16,16,1,1).data[0];case"unicode9":return i.fillText(j(55358,56631),0,0),0!==i.getImageData(16,16,1,1).data[0]}return!1}function e(a){var c=b.createElement("script");c.src=a,c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var f,g,h,i;for(i=Array("simple","flag","unicode8","diversity","unicode9"),c.supports={everything:!0,everythingExceptFlag:!0},h=0;h<i.length;h++)c.supports[i[h]]=d(i[h]),c.supports.everything=c.supports.everything&&c.supports[i[h]],"flag"!==i[h]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[i[h]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(g=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",g,!1)):(a.attachEvent("onload",g),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),f=c.source||{},f.concatemoji?e(f.concatemoji):f.wpemoji&&f.twemoji&&(e(f.twemoji),e(f.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<link rel='stylesheet' id='YoutubeShortcodeMargenn-css'  href='/wp-content/plugins/youtube-shortcode/youtube-shortcode.css?ver=4.6.10' type='text/css' media='all' />
<link rel='stylesheet' id='casper-google-fonts-css'  href='//fonts.googleapis.com/css?family=Noto+Serif%3A400%2C700%2C400italic%7COpen+Sans%3A700%2C400&#038;ver=4.6.10' type='text/css' media='all' />
<link rel='stylesheet' id='casper-style-css'  href='/wp-content/themes/casper/style.css?ver=4.6.10' type='text/css' media='all' />
<script type='text/javascript' src='/wp-includes/js/jquery/jquery.js?ver=1.12.4'></script>
<script type='text/javascript' src='/wp-includes/js/jquery/jquery-migrate.min.js?ver=1.4.1'></script>
<link rel='https://api.w.org/' href='/wp-json/' />
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="/wp-includes/wlwmanifest.xml" /> 
<meta name="generator" content="WordPress 4.6.10" />

   	<style type="text/css">
					.blog-title a, .blog-description, .social-icons a { color: #222222; }
		
						                
		
							.main-navigation a { color: ; }
		                                            </style>
    		<style type="text/css">.recentcomments a{display:inline !important;padding:0 !important;margin:0 !important;}</style>
			<style type="text/css">
			.site-title a,
		.site-description {
			color: #222222;
		}
		</style>
	<style type="text/css" id="syntaxhighlighteranchor"></style>
</head>

<body class="archive paged category category-tips category-14 paged-4 category-paged-4 group-blog">

<header id="masthead" role="banner" class="site-head site-header" style="background-image: url(http://localhost:8888/wp-content/uploads/2018/04/Screenshot-2018-04-09-19.38.59.png);">
    <nav id="site-navigation" class="main-navigation" role="navigation">
        <div>
            <h1 class="menu-toggle">
                <a class="icon-bars" href="#">
                    <span class="hidden">Menu</span>
                </a>
            </h1>
            <a class="skip-link screen-reader-text" href="#content">Skip to content</a>
            <div class="menu"><ul><li ><a href="/">Home</a></li></ul></div>
        </div>
    </nav><!-- #site-navigation -->

    <div class="vertical-row">
        <div class="vertical">
            <div class="site-head-content inner">
                
                <div class="social-icons">
                                                                                                                                                                                                                                                                                                                                                                                                                                                    </div>
                <h1 class="blog-title"><a class="blog-logo" href='/' rel='home'>jeromecukier.net</a></h1>
                <h2 class="blog-description">Just another WordPress site</h2>
            </div>
        </div>
    </div>
</header><!-- #masthead -->

<main id="content" class="content" role="main">

	<section id="primary" class="content-area">
		<main id="main" class="site-main" role="main">

		
			<header class="page-header">
				<h1 class="page-title">
					tips				</h1>
							</header><!-- .page-header -->

						
				
<article id="post-429" class="post-429 post type-post status-publish format-standard hentry category-data-visualization category-protovis category-tips tag-arrays tag-data tag-protovis tag-tutorial">
		    <header class="post-header">
        			<span class="post-meta">
				<span class="posted-on"><a href="/2011/02/07/working-with-data-in-protovis-part-1-of-5/" rel="bookmark"><time class="entry-date published" datetime="2011-02-07T19:41:46+00:00">February 7, 2011</time></a></span><span class="byline"> by <span class="author vcard"><a class="url fn n" href="/author/jerome/">jerome</a></span></span> on <a href="/category/data-visualization/" rel="category tag">data visualization</a>, <a href="/category/protovis/" rel="category tag">protovis</a>, <a href="/category/tips/" rel="category tag">tips</a>			</span>
		        <h1 class="post-title"><a href="/2011/02/07/working-with-data-in-protovis-part-1-of-5/" rel="bookmark">Working with data in protovis &#8211; part 1 of 5</a></h1>
         
    </header>
	<section class="post-content">

		<p>When I started using <a href="http://www.protovis.org/">protovis </a>I had only a very basic knowledge of javascript, which in theory isn’t a problem as protovis is meant to be learned by example, and as it has its own logic and structure which is different from typical javascript code. So I started by looking and modifying examples which was enough to do basic stuff.<br />
But I soon felt limited by what hid behind a single property: <strong>data</strong>. I knew that protovis had lots of features to manipulate and process data but they were not obvious from the examples.</p>
<p>I mean,</p>
<table border="0" cellpadding="0" width="640">
<tbody>
<tr>
<td>
<pre class="brush: jscript; title: ; notranslate" title="">var vis = new pv.Panel()
.width(150)
.height(150);

vis.add(pv.Bar)
.data([1, 1.2, 1.7, 1.5, .7, .3])
.width(20)
.height(function(d) d * 80)

vis.render();</pre>
</td>
<td><a href="http://jckr.github.io/blog/wp-content/uploads/2011/01/basic-example1.png"><img class="aligncenter size-full wp-image-433" title="basic example" src="http://jckr.github.io/blog/wp-content/uploads/2011/01/basic-example1.png" alt="" width="150" height="150" /></a></td>
</tr>
</tbody>
</table>
<p>Here, it’s pretty obvious that the bars represent the values 1, 1.2, 1.7, 1.5, 0.7 and 0.3 respectively. One can infer that the sizes of bars are 25 pixels wide and 80 times their value long.</p>
<p>But protovis doesn’t usually look like this “hello world” kind of example, but rather like this:</p>
<pre class="brush: jscript; title: ; notranslate" title="">
/* Compute yield medians by site and by variety. */
function median(data) pv.median(data, function(d) d.yield);
var site = pv.nest(barley).key(function(d) d.site).rollup(median);
var variety = pv.nest(barley).key(function(d) d.variety).rollup(median);
/* Nest yields data by site then year. */
barley = pv.nest(barley)
    .key(function(d) d.site)
    .sortKeys(function(a, b) site[b] - site[a])
    .key(function(d) d.year)
    .sortValues(function(a, b) variety[b.variety] - variety[a.variety])
    .entries();
[. . .]
/* A panel per site-year. */
var cell = vis.add(pv.Panel)
    .data(barley)
    .height(h)
    .top(function() this.index * h)
    .strokeStyle(&quot;#999&quot;);</pre>
<p>What just happened? <a href="http://vis.stanford.edu/protovis/jsdoc/symbols/pv.Nest.html">pv.nest</a>, key, rollup, sortKeys, entries – what could that do?</p>
<p>To go beyond merely touching up examples, and do your own visualizations from scratch, it is important to get a good grip on how to feed protovis with data. In order to do so, you need a few javascript notions.</p>
<h2>Arrays, arrays, how do they work?</h2>
<p>In javascript, an array is an ordered list of stuff.</p>
<p>In our initial example, we had one such list:</p>
<pre class="brush: jscript; light: true; title: ; notranslate" title="">[1, 1.2, 1.7, 1.5, .7, .3]</pre>
<p>Anything can be put in an array: numbers, strings, Booleans (true/false values), objects … including other arrays. All elements of an array don’t have to be of the same type. Arrays can be assigned to a variable.</p>
<pre class="brush: jscript; light: true; title: ; notranslate" title="">var a = [1, 1.2, 1.7, 1.5, .7, .3];</pre>
<p>Elements of the array can be accessed using the [] notation. In javascript, indices start at 0, so the first element of an array can be obtained so:</p>
<pre class="brush: jscript; light: true; title: ; notranslate" title="">a[0];</pre>
<p>This returns 1. Javascript has many functions to create and manipulate arrays, which we will talk about later. For the time being, let’s look at arrays of arrays. If we wrote instead:</p>
<pre class="brush: jscript; light: true; title: ; notranslate" title="">var a = [[1, 1.2], [1.7, 1.5], [.7, .3]];</pre>
<p>a is now an array of arrays, or “multi-dimensional array”.</p>
<p>a[0] is now worth [1, 1.2]. To access the first number of the array, one has to write a[0][0], which will return the first element (1) of the first element ([1, 1.2]) of a.</p>
<p>Javascript also has another type of array called associative arrays, where values are assigned to keys instead of an index. For instance,</p>
<pre class="brush: jscript; light: true; title: ; notranslate" title="">var a = {yield: 27.00000, variety: &quot;Manchuria&quot;, year: 1931, site: &quot;University Farm&quot;};</pre>
<p>is an associative array. To access a value, one can use a . operator:</p>
<pre class="brush: jscript; light: true; title: ; notranslate" title="">a.yield</pre>
<p>will retun 27.</p>
<pre class="brush: jscript; light: true; title: ; notranslate" title="">a[&quot;yield&quot;]</pre>
<p>also works.</p>
<p>Like other variable types, it is possible to have an array of associative arrays. In fact, this is used quite often in protovis.</p>
<h2>Protovis and arrays – deconstructing the first example</h2>
<p>The reason why I introduced javascript arrays is that the data property <span style="text-decoration: underline;">requires an array</span>. Protovis then loops through that array, performing operations on each of its elements. To that end, it uses things such as accessor functions and properties of an object called this.</p>
<p>To explain all of this let’s go back to the first example and analyse it line by line.</p>
<pre class="brush: jscript; title: ; notranslate" title="">var vis = new pv.Panel()
  .width(150)
  .height(150);
vis.add(pv.Bar)
  .data([1, 1.2, 1.7, 1.5, .7, .3])
  .width(20)
  .bottom(0)
  .height(function(d) d * 80)
  .left(function() this.index * 25);
vis.render();</pre>
<p>The first 3 lines create a panel, which is like the sheet of paper on which protovis will draw the chart. Its width and height properties must be filled, as they are 0 by default which would make the whole visualization invisible.</p>
<p>The next line adds a bar chart to this panel we’ve just created.</p>
<p>The line after specifies the data on which to work: here comes our array. Here, we have written the array literally in the data property, but nothing prevents us to assign it to a variable first and to pass the variable instead.</p>
<p>The next line, and the line with the bottom property, assign constant numbers to these properties. It means that all the bars will have a width of 20 pixels, and they will all be aligned with the bottom of the panel – that’s what</p>
<pre class="brush: jscript; first-line: 7; title: ; notranslate" title="">bottom(0)</pre>
<p>does.</p>
<p>Now let’s look at the two remaining lines:</p>
<pre class="brush: jscript; first-line: 8; title: ; notranslate" title="">.height(function(d) d * 80)
.left(function() this.index * 25);</pre>
<p>The first line uses an accessor function. What this does is that it looks at the current element, and perform an operation on it, the result of which will be the height of that element.</p>
<p>In proper javascript, we would have written:</p>
<pre class="brush: jscript; light: true; title: ; notranslate" title="">function(d) {return d*80;}</pre>
<p>but protovis uses a shorthand notation that allows us to omit curly braces and the return statement. By the way, d in the function is completely arbitrary, and could be any variable name –</p>
<pre class="brush: jscript; light: true; title: ; notranslate" title="">function(a) a*80</pre>
<p>also works. It’s just that the name of the variable between parentheses will represent the value of the current element.</p>
<p>The second line uses the this object. this represents what protovis is working on at the moment, and it has properties that can be used. The most commonly used is index: this.index returns the position of the current element in its array, so it is going to be: 0 for the first bar, 1 for the next one, etc.</p>
<p>So this line specifies that each new bar should start every 25 pixels from the left border of the panel.</p>
<p>You may wonder, why not write</p>
<pre class="brush: jscript; light: true; title: ; notranslate" title="">.left(this.index * 25);</pre>
<p>and omit the function()? Well, function() means that the content of the property gets re-evaluated. If we had omitted it, this.index * 25 would have been computed once (for a result of 0) and that value would have been used for all the bars.</p>
<p>By the way, instead of writing the height property as it is, we could have written:</p>
<pre class="brush: jscript; light: true; title: ; notranslate" title="">.height(function()[1, 1.2, 1.7, 1.5, .7, .3][this.index] * 80)</pre>
<p>Using an accessor function is shorter and clearer.</p>
<p>Next: <a href="http://jckr.github.io/blog/?p=479">Multi-dimensional arrays, inheritance and hierarchy</a></p>
	    		<div class="clear">&nbsp;</div>
	</section>
</article><!-- #post-## -->
			
				
<article id="post-342" class="post-342 post type-post status-publish format-standard hentry category-book-review category-charts category-data-publishing category-data-visualization category-tips tag-advice tag-chart tag-data-presentation tag-graphics tag-guidelines tag-how-to tag-meaningful-graphics">
		    <header class="post-header">
        			<span class="post-meta">
				<span class="posted-on"><a href="/2010/02/10/making-data-meaningful-style-guide-on-the-presentation-of-statistics/" rel="bookmark"><time class="entry-date published" datetime="2010-02-10T18:53:46+00:00">February 10, 2010</time></a></span><span class="byline"> by <span class="author vcard"><a class="url fn n" href="/author/jerome/">jerome</a></span></span> on <a href="/category/book-review/" rel="category tag">book review</a>, <a href="/category/charts/" rel="category tag">charts</a>, <a href="/category/data-publishing/" rel="category tag">data publishing</a>, <a href="/category/data-visualization/" rel="category tag">data visualization</a>, <a href="/category/tips/" rel="category tag">tips</a>			</span>
		        <h1 class="post-title"><a href="/2010/02/10/making-data-meaningful-style-guide-on-the-presentation-of-statistics/" rel="bookmark">Making data meaningful &#8211; Style guide on the presentation of statistics</a></h1>
         
    </header>
	<section class="post-content">

		<p><a href="http://bit.ly/mdm-2"><img class="aligncenter size-full wp-image-343" title="Making Data Meaningful part 2" src="http://jckr.github.io/blog/wp-content/uploads/2010/02/mdm2.png" alt="Making Data Meaningful part 2" width="400" height="564" /></a><br />
Introducing <a href="http://bit.ly/mdm-2">Making Data Meaningful Part 2 &#8211; Style guide on the presentation of statistics</a> &#8211; which, as its name cleverly suggests, is a compilation of  advice to present graphical information.</p>
<p>It&#8217;s a follow up to <a href="/category/tips/page/4/www.unece.org/stats/documents/writing/">Making Data Meaningul part 1</a> , which focused on <em>writing </em>about data, as opposed to visualize it.</p>
<p>The book is a cooperation between representatives of national statistical offices and intergovernmental organizations &#8211; all public statisticians, if you will. I hope it will help others to communicate their data better. Personally, I have written the part about charts and collaborated to some other chapters. But if I could sum up my advice in one sentence, it would be: go buy <a href="http://www.perceptualedge.com/">Stephen Few</a> books. Start with <a href="http://www.amazon.com/Show-Me-Numbers-Designing-Enlighten/dp/0970601999/ref=sr_1_1?ie=UTF8&amp;s=books&amp;qid=1265820159&amp;sr=8-1">Show me the numbers.</a></p>
<p>The list of people who collaborated to the book includes:</p>
<ul>
<li>from the <a href="/category/tips/page/4/www.abs.gov.au/">Australian Bureau of Statistics</a>, Kerrie Duff and Andrew Mair;</li>
<li>from the <a href="http://www.census.gov/">Census Bureau</a>, Ken Meyer;</li>
<li>from <a href="/category/tips/page/4/www.eia.doe.gov/">EIA</a>, Colleen Blessing;</li>
<li>from <a href="http://www.oecd.org/">OECD</a>, my colleagues Eileen Capponi and Terri Mitton.</li>
<li>from <a href="/category/tips/page/4/www.statcan.gc.ca/">Statistics Canada</a>, John Flanders, Martine Grenier, Martin Lachance and Eric St John (who edited the manuscript);</li>
<li>from the <a href="http://www.statistics.admin.ch/">Swiss Federal Statistical Office</a>, <a href="http://blogstats.wordpress.com/">Armin Grossenbacher</a> and Thomas Schultz;</li>
<li>from the <a href="/category/tips/page/4/www.statistics.gov.uk/">UK Office of National Statistics</a>, David Marder and Alan Smith;</li>
<li>and from <a href="http://www.unece.org/">UNECE</a>, Petteri Baer, Jessica Gardner (who coordinated the project), and Anne-Christine Wanders.</li>
</ul>
	    		<div class="clear">&nbsp;</div>
	</section>
</article><!-- #post-## -->
			
				
<article id="post-279" class="post-279 post type-post status-publish format-standard hentry category-data-publishing category-data-visualization category-tips category-web-sites tag-area-charts tag-bar-charts tag-bitmap tag-blog tag-blogging-charts tag-charts tag-data-visualization tag-excel tag-line-charts tag-processing tag-tool">
		    <header class="post-header">
        			<span class="post-meta">
				<span class="posted-on"><a href="/2009/12/21/plotter-a-tool-to-create-bitmap-charts-for-the-web/" rel="bookmark"><time class="entry-date published" datetime="2009-12-21T19:29:13+00:00">December 21, 2009</time></a></span><span class="byline"> by <span class="author vcard"><a class="url fn n" href="/author/jerome/">jerome</a></span></span> on <a href="/category/data-publishing/" rel="category tag">data publishing</a>, <a href="/category/data-visualization/" rel="category tag">data visualization</a>, <a href="/category/tips/" rel="category tag">tips</a>, <a href="/category/web-sites/" rel="category tag">web sites</a>			</span>
		        <h1 class="post-title"><a href="/2009/12/21/plotter-a-tool-to-create-bitmap-charts-for-the-web/" rel="bookmark">Plotter: a tool to create bitmap charts for the web</a></h1>
         
    </header>
	<section class="post-content">

		<p>In the past couple of months, I have been busy maintaining a <a href="http://www.oecd.org/statistics/factblog">blog for OECD: Factblog</a>.</p>
<p>The idea is to illustrate topics on which we work by a chart which we&#8217;ll change regularly. So in order to do that, I&#8217;d have to be able to create charts of publishable quality.</p>
<h2>Excel screenshots: not a good option</h2>
<p>There are quite a few tools to create charts on the net. Despite this, the <em>de facto</em> standard is still a screenshot of Excel, a solution which is even used <a href="http://theappleblog.com/2009/12/18/iphone-and-ipod-touch-see-international-surge/">by the most reputable blogs.</a></p>
<p><div id="attachment_289" style="width: 605px" class="wp-caption aligncenter"><a href="http://theappleblog.com/2009/12/18/iphone-and-ipod-touch-see-international-surge/"><img class="size-full wp-image-289" title="excelinblog" src="http://jckr.github.io/blog/wp-content/uploads/2009/12/excelinblog.png" alt="excelinblog" width="595" height="555" /></a><p class="wp-caption-text">This is taken from http://theappleblog.com/2009/12/18/iphone-and-ipod-touch-see-international-surge/</p></div></p>
<p><a href="http://theappleblog.com/2009/12/18/iphone-and-ipod-touch-see-international-surge/"></a>But alas, Excel is not fit for web publishing. First, you have to rely on Excel&#8217;s choice of colours and fonts, which won&#8217;t necessarily agree to those of your website. Second, you can&#8217;t control key characteristics of your output, such as its dimensions. And if your chart has to be resized, it will get pixelated. Clearly, there is a better way to do this.</p>
<p><div id="attachment_280" style="width: 671px" class="wp-caption aligncenter"><a href="http://theappleblog.com/2009/12/18/iphone-and-ipod-touch-see-international-surge/"><img class="size-full wp-image-280" title="pixellated" src="http://jckr.github.io/blog/wp-content/uploads/2009/12/pixellated.png" alt="That's a detail of the chart on the link I showed above. The letters and the data bars are not as crisp as they could have been." width="661" height="387" /></a><p class="wp-caption-text">That&#39;s a detail of the chart on the link I showed above. The letters and the data bars are not as crisp as they could have been.</p></div></p>
<h2>How about interactive charts?</h2>
<p>Then again, the most sensible way to present a chart on the web is by making it interactive. And there is no shortage of tools for that. But there are just as many issues.<br />
Some come from the content management system or blogging environment. Many CMS don&#8217;t allow you to use javascript and/or java and/or flash. So you&#8217;ll have to use a technology which is tolerated by your system.</p>
<p>Most javascript charting solutions rely on the &lt;CANVAS&gt; element.  Canvas is supported by most major browsers, with the exception of the Internet Explorer family. IE users still represent roughly 40% of the internet, but much more in the case of my OECD blog, so I can&#8217;t afford to use a non-IE friendly solution. There is at least one library which works well with IE, <a href="http://raphaeljs.com/">RaphaelJS</a>.<br />
Using java cause two problems. First, the hiccup caused by the plug-in loading is enough to discourage some users. Second, it may not be understood well by readers:</p>
<p><div id="attachment_281" style="width: 574px" class="wp-caption aligncenter"><a href="http://jckr.github.io/blog/wp-content/uploads/2009/12/java-reader.png"><img class="size-full wp-image-281" title="java reader" src="http://jckr.github.io/blog/wp-content/uploads/2009/12/java-reader.png" alt="This is how one of my post reads in google reader. " width="564" height="323" /></a><p class="wp-caption-text">This is how one of my posts reads in google reader. </p></div></p>
<p>And it&#8217;s futile to believe that readers will read blogs from their home pages. So if all readers can&#8217;t show it well it&#8217;s a show-stopper.</p>
<h2>A tool to create good bitmap charts</h2>
<p>So, in a variety of situations the good old bitmap image is still the most appropriate thing to post. That&#8217;s why I created <a href="http://www.openprocessing.org/visuals/?visualID=6595">my own tools</a> with <a href="http://www.processing.org/">Processing</a>.</p>
<p><a href="http://jckr.github.io/blog/wp-content/uploads/2009/12/plotter-windows.zip">plotter windows</a></p>
<p><a href="http://jckr.github.io/blog/wp-content/uploads/2009/12/plotter-mac-OS-X.zip">plotter mac OS X</a></p>
<p><a href="http://jckr.github.io/blog/wp-content/uploads/2009/12/plotter-linux.zip">plotter linux</a></p>
<p>Here&#8217;s how it works.</p>
<p>when you unzip the files, you have a file called &#8220;mychart.txt&#8221; which is a set of parameters. Edit the file according to the instructions in &#8220;instructions.txt&#8221; to your liking, then launch the tool (plotter application). It will generate an image, called &#8220;mychart.png&#8221;.</p>
<p>The zip files contain the source code, which is also found here on <a href="http://www.openprocessing.org/visuals/?visualID=6595">my openprocessing account</a>.</p>
<p>With my tools, I wanted to address two things. First, I wanted to be able to create a chart and to have a precise control of all of its components, especially the size. In Excel, by contrast, it&#8217;s difficult to control the size of the plotting area, or the placement of the title &#8211; all of this things are done automatically and are difficult to correct (when it&#8217;s possible). Second, I wanted to be able to create functional thumbnails.</p>
<p>If you have to create smaller versions of a chart from a bigger image, the easiest solution is to resize the chart using an image editing software. But that&#8217;s what you&#8217;d get:</p>
<p><div id="attachment_282" style="width: 420px" class="wp-caption aligncenter"><a href="http://jckr.github.io/blog/wp-content/uploads/2009/12/GDP-original.png"><img class="size-full wp-image-282" title="GDP original" src="http://jckr.github.io/blog/wp-content/uploads/2009/12/GDP-original.png" alt="That's the original chart." width="410" height="320" /></a><p class="wp-caption-text">That&#39;s the original chart.</p></div></p>
<p><div id="attachment_283" style="width: 260px" class="wp-caption aligncenter"><a href="http://jckr.github.io/blog/wp-content/uploads/2009/12/GDP-resized.png"><img class="size-full wp-image-283" title="GDP resized" src="http://jckr.github.io/blog/wp-content/uploads/2009/12/GDP-resized.png" alt="And that's the resized version. Legible? nah." width="250" height="180" /></a><p class="wp-caption-text">And that&#39;s the resized version. Legible? nah.</p></div></p>
<p>But what if it were just as easy to re-render the chart in a smaller size, than to resize it with an external program? My tool can do that, too.</p>
<p><div id="attachment_285" style="width: 580px" class="wp-caption aligncenter"><a href="http://jckr.github.io/blog/wp-content/uploads/2009/12/GDP-small1.png"><img class="size-full wp-image-285" title="GDP small" src="http://jckr.github.io/blog/wp-content/uploads/2009/12/GDP-small1.png" alt="Left: resized, right: re-rendered." width="570" height="200" /></a><p class="wp-caption-text">Left: resized, right: re-rendered.</p></div></p>
<p>Here&#8217;s a gallery of various charts done with the tool. The tool supports: line charts, bar charts (both stacked and clustered), dots charts and area charts. No pie charts included. It&#8217;s best suited for simple charts with few series and relatively few data points.</p>
<p><div id="attachment_286" style="width: 420px" class="wp-caption aligncenter"><a href="http://jckr.github.io/blog/wp-content/uploads/2009/12/example-1.png"><img class="size-full wp-image-286" title="example 1" src="http://jckr.github.io/blog/wp-content/uploads/2009/12/example-1.png" alt="Impact of energy subsidies on CO2 emissions" width="410" height="320" /></a><p class="wp-caption-text">Impact of energy subsidies on CO2 emissions</p></div></p>
<p><div id="attachment_287" style="width: 420px" class="wp-caption aligncenter"><a href="http://jckr.github.io/blog/wp-content/uploads/2009/12/example-2.png"><img class="size-full wp-image-287" title="example 2" src="http://jckr.github.io/blog/wp-content/uploads/2009/12/example-2.png" alt="Temperature and emission forecasts" width="410" height="320" /></a><p class="wp-caption-text">Temperature and emission forecasts</p></div></p>
<p><div id="attachment_288" style="width: 420px" class="wp-caption aligncenter"><a href="http://jckr.github.io/blog/wp-content/uploads/2009/12/example-3.png"><img class="size-full wp-image-288" title="example 3" src="http://jckr.github.io/blog/wp-content/uploads/2009/12/example-3.png" alt="Greenhouse gas emission projections" width="410" height="320" /></a><p class="wp-caption-text">Greenhouse gas emission projections</p></div></p>
<p>I hope you find it useful, tell me if you do and let me know if you find bugs.</p>
	    		<div class="clear">&nbsp;</div>
	</section>
</article><!-- #post-## -->
			
				
<article id="post-172" class="post-172 post type-post status-publish format-standard hentry category-tips tag-excel tag-file tag-file-system-object tag-fso tag-html tag-script tag-vba tag-write tag-xhtml">
		    <header class="post-header">
        			<span class="post-meta">
				<span class="posted-on"><a href="/2009/08/20/create-html-files-from-excel-tables/" rel="bookmark"><time class="entry-date published" datetime="2009-08-20T18:14:33+00:00">August 20, 2009</time></a></span><span class="byline"> by <span class="author vcard"><a class="url fn n" href="/author/jerome/">jerome</a></span></span> on <a href="/category/tips/" rel="category tag">tips</a>			</span>
		        <h1 class="post-title"><a href="/2009/08/20/create-html-files-from-excel-tables/" rel="bookmark">Create HTML files from Excel tables</a></h1>
         
    </header>
	<section class="post-content">

		<p>Imagine a situation where you have data neatly stored in Excel, in a form you&#8217;re comfortable with (or stuck with) and you want to combine it to create a beautiful HTML document (or XML,  TXT, you name it).<br />
For the sake of argument, let&#8217;s assume you have this spreadsheet here:</p>
<p style="text-align: center;"><img class="aligncenter" style="margin-right: 149px; margin-left: 148px;" title="spreadsheet" src="http://jckr.github.io/blog/wp-content/uploads/2009/08/spreadsheet.png" alt="spreadsheet" width="373" height="185" /></p>
<p>and you want to create a list of links with the name of the site in column A, and the url in column B. That, and you want to be able to control every minute aspect of the file you would be creating.</p>
<p>The solution to that problem is the <a href="http://msdn.microsoft.com/en-us/library/6kxy1a51(VS.85).aspx">file system object</a> in VBA. You create an object for file operations, like this:</p>
<p><code>Dim fs as Object<br />
Set fs = CreateObject("Scripting.FileSystemObject")</code></p>
<p>You then create an object per file you want to use:</p>
<p><code>Dim f as Object<br />
Set f = fs.opentextfile("myFile.html", 2, True)</code></p>
<p>What these parameters mean: 2 means the file is open for writing and True that it can be created if it doesn&#8217;t exist</p>
<p>You can then add stuff to your heart&#8217;s content by using the writeline method.</p>
<p><code>f.writeline "&lt;ul&gt;"<br />
f.writeline "  &lt;li&gt;&lt;a href=""" &amp; cells(1,2) &amp; """&gt;" &amp; cells(1,1) &amp; "&lt;/a&gt;&lt;/li&gt;"<br />
f.writeline "  &lt;li&gt;&lt;a href=""" &amp; cells(1,2) &amp; """&gt;" &amp; cells(1,1) &amp; "&lt;/a&gt;&lt;/li&gt;"<br />
f.writeline "&lt;/ul&gt;"<br />
</code></p>
<p>And when you&#8217;re done, just close your objects.</p>
<p><code>f.close<br />
</code></p>
<p>Voilà.</p>
<p style="text-align: center;"><img class="size-full wp-image-174 aligncenter" style="margin-right: 125px; margin-left: 125px;" title="result" src="http://jckr.github.io/blog/wp-content/uploads/2009/08/result.png" alt="result" width="421" height="152" /></p>
<p>When I use this technique, I like to have procedures that create the files, create a standard header and footer and write to the file using arguments, rather than using the fileSystemObject methods directly. I do that so I can have really clean, indented files with all the structure under control.<br />
Here is a simple example file:</p>
<p><a href="http://jckr.github.io/blog/wp-content/uploads/2009/08/fso.xlsm">fso.xlsm</a></p>
<p>And here&#8217;s a more complex project I&#8217;ve done using this technique : <a href="http://www.sourceoecd.org/rpsv/figures2008/en/index.htm">http://www.sourceoecd.org/rpsv/figures2008/en/index.htm</a> where all 240 html pages  (and 52 images) have been generated from content found in Excel documents. If the content and the output is more complex than the above example, the idea is pretty much identical.</p>
	    		<div class="clear">&nbsp;</div>
	</section>
</article><!-- #post-## -->
			
				<nav class="pagination navigation paging-navigation" role="navigation">
		<div class="nav-links">
							<div class="page-number">Page 4 of 4</div>
						<div class="newer-posts"><a href="/category/tips/page/3/" ><span class="meta-nav">&larr;</span> Newer Posts</a></div>
			
		</div><!-- .nav-links -->
	</nav><!-- .navigation -->
	
		
		</main><!-- #main -->
	</section><!-- #primary -->

	<div id="secondary" class="widget-area" role="complementary">
		<aside id="search-2" class="widget widget_search"><form role="search" method="get" class="search-form" action="/">
				<label>
					<span class="screen-reader-text">Search for:</span>
					<input type="search" class="search-field" placeholder="Search &hellip;" value="" name="s" />
				</label>
				<input type="submit" class="search-submit" value="Search" />
			</form></aside>		<aside id="recent-posts-2" class="widget widget_recent_entries">		<h1 class="widget-title">Recent Posts</h1>		<ul>
					<li>
				<a href="/2016/08/17/the-big-leagues/">The big leagues</a>
						</li>
					<li>
				<a href="/2016/08/17/creating-a-react-visualization-web-app/">Creating a React visualization web app</a>
						</li>
					<li>
				<a href="/2016/08/13/beyond-rendering/">Beyond rendering</a>
						</li>
					<li>
				<a href="/2016/08/11/react-components/">React components</a>
						</li>
					<li>
				<a href="/2016/08/10/coding-with-react/">Coding with React</a>
						</li>
				</ul>
		</aside>		<aside id="recent-comments-2" class="widget widget_recent_comments"><h1 class="widget-title">Recent Comments</h1><ul id="recentcomments"><li class="recentcomments"><span class="comment-author-link"><a href='http://omeraz.wordpress.com/' rel='external nofollow' class='url'>עומר עזריאל</a></span> on <a href="/2016/08/17/the-big-leagues/#comment-567">The big leagues</a></li><li class="recentcomments"><span class="comment-author-link">Carlos Ayres</span> on <a href="/2012/05/28/manipulating-data-like-a-boss-with-d3/#comment-312">Manipulating data like a boss with d3</a></li><li class="recentcomments"><span class="comment-author-link"><a href='https://migrate.powertripanalytics.com/game-of-thrones-interactions-among-the-top-30-characters/' rel='external nofollow' class='url'>Game of ThronesInteractions Among the Top 30 Characters &#8211; PowerTrip Analytics</a></span> on <a href="/2013/05/13/making-the-game-of-thrones-visualization/#comment-466">Making the game of thrones visualization</a></li><li class="recentcomments"><span class="comment-author-link"><a href='https://abgoswam.wordpress.com/2016/10/08/d3-getting-started/' rel='external nofollow' class='url'>D3 &#8211; Getting Started | abgoswam&#039;s tech blog</a></span> on <a href="/2012/09/04/getting-to-hello-world-with-d3/#comment-419">Getting to &#8220;Hello world&#8221; with d3</a></li><li class="recentcomments"><span class="comment-author-link"><a href='https://plus.google.com/+BrotoBhattacharjee' rel='external nofollow' class='url'>Broto Bhattacharjee</a></span> on <a href="/2012/09/04/getting-to-hello-world-with-d3/#comment-418">Getting to &#8220;Hello world&#8221; with d3</a></li></ul></aside><aside id="archives-2" class="widget widget_archive"><h1 class="widget-title">Archives</h1>		<ul>
			<li><a href='/2016/08/'>August 2016</a></li>
	<li><a href='/2015/05/'>May 2015</a></li>
	<li><a href='/2015/02/'>February 2015</a></li>
	<li><a href='/2014/10/'>October 2014</a></li>
	<li><a href='/2013/11/'>November 2013</a></li>
	<li><a href='/2013/05/'>May 2013</a></li>
	<li><a href='/2013/03/'>March 2013</a></li>
	<li><a href='/2013/01/'>January 2013</a></li>
	<li><a href='/2012/12/'>December 2012</a></li>
	<li><a href='/2012/11/'>November 2012</a></li>
	<li><a href='/2012/10/'>October 2012</a></li>
	<li><a href='/2012/09/'>September 2012</a></li>
	<li><a href='/2012/07/'>July 2012</a></li>
	<li><a href='/2012/06/'>June 2012</a></li>
	<li><a href='/2012/05/'>May 2012</a></li>
	<li><a href='/2012/04/'>April 2012</a></li>
	<li><a href='/2012/01/'>January 2012</a></li>
	<li><a href='/2011/11/'>November 2011</a></li>
	<li><a href='/2011/10/'>October 2011</a></li>
	<li><a href='/2011/09/'>September 2011</a></li>
	<li><a href='/2011/08/'>August 2011</a></li>
	<li><a href='/2011/07/'>July 2011</a></li>
	<li><a href='/2011/06/'>June 2011</a></li>
	<li><a href='/2011/05/'>May 2011</a></li>
	<li><a href='/2011/04/'>April 2011</a></li>
	<li><a href='/2011/03/'>March 2011</a></li>
	<li><a href='/2011/02/'>February 2011</a></li>
	<li><a href='/2011/01/'>January 2011</a></li>
	<li><a href='/2010/11/'>November 2010</a></li>
	<li><a href='/2010/04/'>April 2010</a></li>
	<li><a href='/2010/03/'>March 2010</a></li>
	<li><a href='/2010/02/'>February 2010</a></li>
	<li><a href='/2010/01/'>January 2010</a></li>
	<li><a href='/2009/12/'>December 2009</a></li>
	<li><a href='/2009/10/'>October 2009</a></li>
	<li><a href='/2009/09/'>September 2009</a></li>
	<li><a href='/2009/08/'>August 2009</a></li>
	<li><a href='/2009/07/'>July 2009</a></li>
	<li><a href='/2009/06/'>June 2009</a></li>
	<li><a href='/2009/05/'>May 2009</a></li>
	<li><a href='/2008/12/'>December 2008</a></li>
	<li><a href='/2008/11/'>November 2008</a></li>
	<li><a href='/2008/10/'>October 2008</a></li>
		</ul>
		</aside><aside id="categories-2" class="widget widget_categories"><h1 class="widget-title">Categories</h1>		<ul>
	<li class="cat-item cat-item-2"><a href="/category/book-review/" >book review</a>
</li>
	<li class="cat-item cat-item-3"><a href="/category/charts/" >charts</a>
</li>
	<li class="cat-item cat-item-4"><a href="/category/conferences/" >conferences</a>
</li>
	<li class="cat-item cat-item-5"><a href="/category/d3/" >d3</a>
</li>
	<li class="cat-item cat-item-6"><a href="/category/dashboards/" >dashboards</a>
</li>
	<li class="cat-item cat-item-7"><a href="/category/data-publishing/" >data publishing</a>
</li>
	<li class="cat-item cat-item-8"><a href="/category/data-visualization/" >data visualization</a>
</li>
	<li class="cat-item cat-item-9"><a href="/category/francais/" >français</a>
</li>
	<li class="cat-item cat-item-10"><a href="/category/javascript/" >javascript</a>
</li>
	<li class="cat-item cat-item-11"><a href="/category/presentation/" >presentation</a>
</li>
	<li class="cat-item cat-item-12"><a href="/category/protovis/" >protovis</a>
</li>
	<li class="cat-item cat-item-13"><a href="/category/react/" >react</a>
</li>
	<li class="cat-item cat-item-14 current-cat"><a href="/category/tips/" >tips</a>
</li>
	<li class="cat-item cat-item-1"><a href="/category/uncategorized/" >Uncategorized</a>
</li>
	<li class="cat-item cat-item-15"><a href="/category/web-sites/" >web sites</a>
</li>
		</ul>
</aside><aside id="meta-2" class="widget widget_meta"><h1 class="widget-title">Meta</h1>			<ul>
						<li><a href="/wp-login.php">Log in</a></li>
			<li><a href="/feed/">Entries <abbr title="Really Simple Syndication">RSS</abbr></a></li>
			<li><a href="/comments/feed/">Comments <abbr title="Really Simple Syndication">RSS</abbr></a></li>
			<li><a href="https://wordpress.org/" title="Powered by WordPress, state-of-the-art semantic personal publishing platform.">WordPress.org</a></li>			</ul>
			</aside>		<div class="clear">&nbsp;</div>
	</div><!-- #secondary -->
	<footer id="colophon" class="site-footer" role="contentinfo">
	    <a class="subscribe icon-feed" href="/feed/"><span class="tooltip">Subscribe!</span></a>
		<div class="site-info inner">
		    <section class="copyright">
		    			    		<a href="https://github.com/lacymorrow/casper" rel="home">Casper WP</a> by Lacy Morrow		    			    </section>
		</div><!-- .site-info -->
	</footer><!-- #colophon -->
</main><!-- /#content -->

<script type='text/javascript' src='/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shCore.js?ver=3.0.9b'></script>
<script type='text/javascript' src='/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushJScript.js?ver=3.0.9b'></script>
<script type='text/javascript'>
	(function(){
		var corecss = document.createElement('link');
		var themecss = document.createElement('link');
		var corecssurl = "http://localhost:8888/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shCore.css?ver=3.0.9b";
		if ( corecss.setAttribute ) {
				corecss.setAttribute( "rel", "stylesheet" );
				corecss.setAttribute( "type", "text/css" );
				corecss.setAttribute( "href", corecssurl );
		} else {
				corecss.rel = "stylesheet";
				corecss.href = corecssurl;
		}
		document.getElementsByTagName("head")[0].insertBefore( corecss, document.getElementById("syntaxhighlighteranchor") );
		var themecssurl = "http://localhost:8888/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shThemeDefault.css?ver=3.0.9b";
		if ( themecss.setAttribute ) {
				themecss.setAttribute( "rel", "stylesheet" );
				themecss.setAttribute( "type", "text/css" );
				themecss.setAttribute( "href", themecssurl );
		} else {
				themecss.rel = "stylesheet";
				themecss.href = themecssurl;
		}
		//document.getElementById("syntaxhighlighteranchor").appendChild(themecss);
		document.getElementsByTagName("head")[0].insertBefore( themecss, document.getElementById("syntaxhighlighteranchor") );
	})();
	SyntaxHighlighter.config.strings.expandSource = '+ expand source';
	SyntaxHighlighter.config.strings.help = '?';
	SyntaxHighlighter.config.strings.alert = 'SyntaxHighlighter\n\n';
	SyntaxHighlighter.config.strings.noBrush = 'Can\'t find brush for: ';
	SyntaxHighlighter.config.strings.brushNotHtmlScript = 'Brush wasn\'t configured for html-script option: ';
	SyntaxHighlighter.defaults['pad-line-numbers'] = false;
	SyntaxHighlighter.defaults['toolbar'] = false;
	SyntaxHighlighter.all();
</script>
<script type='text/javascript' src='/wp-content/themes/casper/js/main.js?ver=1.0.0'></script>
<script type='text/javascript' src='/wp-includes/js/wp-embed.min.js?ver=4.6.10'></script>
<!--stats_footer_test--></body>
</html>
