<html>
  <head>
    <title>Reykjavik real estate</title>
    <link type="text/css" rel="stylesheet" href="http://vis.stanford.edu/protovis/ui-lightness/jquery-ui-1.8rc3.custom.css"/>
	<!--<script type="text/javascript" src="reykjavik.js"></script>-->
 <script type="text/javascript" src="http://vis.stanford.edu/protovis/jquery-1.4.2.min.js"></script>
	<script type="text/javascript" src="http://vis.stanford.edu/protovis/jquery-ui-1.8rc3.custom.min.js"></script>
   
    <script type="text/javascript" src="http://blog.oecdfactblog.org/wp-includes/js/protovis-r3.2.js"></script>
    <script type="text/javascript" src="http://tile.cloudmade.com/wml/latest/web-maps-lite.js"></script>
    <style type="text/css">

#fig {
  width: 800px;
  height: 500px;
  margin-top: 10px;
}

#container {
  height: 10px;
}

#periodSlider {
  position: absolute;
  left: 100;
  right: 90;
  margin-top: 3;
}

#periodLabel {
  position: absolute;
  left: 0;
  width: 85;
  text-align: right;
}

#play {
  position: absolute;
  right: 50px;
  cursor: pointer;
}

#reykjavik {position: absolute;left:10px;top:40px;}
    </style>
  </head>
  <body><div id="center"><div id="fig">
    <div id="container">
      <b id="periodLabel">Period:</b>
      <div id="periodSlider"></div>
      <img id="play" src="play.png" alt="Play" onclick="playClick()">
    </div>
    <div id="reykjavik" style="width: 800px; height: 600px"></div>
    <script type="text/javascript+protovis">

// prepping data

var points=[[64.1216366,-21.8262863],[64.148763,-21.9618977],[64.1256341,-21.7547774],[64.1535522,-21.7858807],[64.148763,-21.9618977],[64.1178224,-21.8467969],[64.1191175,-21.8085104],[64.1551493,-21.761286],[64.101382,-21.769828],[64.1016373,-21.8223612],[64.1464708,-21.9503679],[64.135338,-21.89521],[64.1492678,-21.9443486],[64.1578278,-21.7546337],[64.1338611,-21.8646843],[64.1265079,-21.8976963],[64.109643,-21.8266809],[64.1431785,-21.9031453],[64.1479081,-21.9558337],[64.1446191,-21.9595929],[64.1268131,-21.7593159],[64.1060316,-21.8302322],[64.1353069,-21.9443727],[64.1254309,-21.8738986],[64.1487089,-21.8736549],[64.1013453,-21.8292063],[64.1260173,-21.8633884],[64.1247051,-21.7506108],[64.149748,-21.878354],[64.1016417,-21.8529673],[64.1230683,-21.7611181],[64.1486198,-21.865761],[64.1479081,-21.9558337],[64.1507871,-21.9820193],[64.1391234,-21.7830347],[64.1191175,-21.8085104],[64.1252238,-21.7428781],[64.1053157,-21.7883833],[64.135338,-21.89521],[64.123507,-21.9027236],[64.1474241,-21.7833826],[64.1089203,-21.8369113],[64.1496674,-21.7723796],[64.1474137,-21.9245135],[64.1100342,-21.8097309],[64.1426819,-21.9234086],[64.1054554,-21.8129176],[64.1055562,-21.8234513],[64.0987517,-21.8235881],[64.1504636,-21.9554792],[64.1089203,-21.8369113],[64.1506266,-21.9564735],[64.1358371,-21.9050574],[64.1409288,-21.8556694],[64.1074005,-21.7870701],[64.1098538,-21.8075127],[64.1358371,-21.9050574],[64.1417322,-21.7952061],[64.1480152,-21.7881522],[64.1357062,-21.9509867],[64.1252238,-21.7428781],[64.1468221,-21.9284344],[64.1415805,-21.9006872],[64.1441731,-21.8981485],[64.1357062,-21.9509867],[64.1324806,-21.9058876],[64.1492678,-21.9443486],[64.135338,-21.89521],[64.1290589,-21.8796961],[64.149748,-21.878354],[64.1247051,-21.7506108],[64.1441731,-21.8981485],[64.1493495,-21.9621653],[64.1222006,-21.864216],[64.1358371,-21.9050574],[64.144084,-21.9325781],[64.1418286,-21.9335075],[64.1191175,-21.8085104],[64.1268131,-21.7593159],[64.1551493,-21.761286],[64.1115208,-21.7870903],[64.1204169,-21.8826048],[64.0999001,-21.8155572],[64.1268131,-21.7593159],[64.1301646,-21.8867236],[64.0998747,-21.8208409],[64.147714,-21.9728869],[64.133622,-21.9115584],[64.0976209,-21.8418692],[64.1290589,-21.8796961],[64.1503037,-21.9438043],[64.150555,-21.798705],[64.149748,-21.878354],[64.14032,-21.9019555],[64.1309594,-21.855919],[64.1199127,-21.8697449],[64.1320981,-21.8589138],[64.1491345,-21.9494508],[64.0922365,-21.8358451],[64.1426057,-21.9084953],[64.1377748,-21.7969822],[64.1409288,-21.8556694],[64.1492678,-21.9443486],[64.0993532,-21.8501059],[64.137162,-21.9088198],[64.1338611,-21.8646843],[64.106018,-21.836495],[64.14437,-21.8977139],[64.0929361,-21.8411029],[64.14437,-21.8977139],[64.1415805,-21.9006872],[64.1458771,-21.8019872],[64.1338611,-21.8646843],[64.1486198,-21.865761],[64.1446595,-21.9575606],[64.1358371,-21.9050574],[64.126131,-21.7535609],[64.1196365,-21.8595535],[64.148763,-21.9618977],[64.1458235,-21.9719404],[64.0998747,-21.8208409],[64.1217939,-21.8167217],[64.0957686,-21.826377],[64.1119675,-21.8310709],[64.1051685,-21.7852534],[64.130631,-21.8840468],[64.122884,-21.8571423],[64.1104085,-21.794788],[64.1083632,-21.8267035],[64.1424047,-21.8876965],[64.135338,-21.89521],[64.1096265,-21.8127856],[64.1458366,-21.777534],[64.1096265,-21.8127856],[64.126452,-21.7389229],[64.133622,-21.9115584],[64.1492678,-21.9443486],[64.137162,-21.9088198],[64.150555,-21.798705],[64.1409441,-21.7903019],[64.1378219,-21.9572326],[64.13212,-21.8179106],[64.1497124,-21.9495108],[64.1357062,-21.9509867],[64.1417322,-21.7952061],[64.1039959,-21.7843422],[64.11937,-21.8641783],[64.1428279,-21.9375652],[64.1241339,-21.8802587],[64.1273258,-21.744672],[64.1097187,-21.8326331],[64.1252238,-21.7428781],[64.1424047,-21.8876965],[64.1200352,-21.8631909],[64.1474137,-21.9245135],[64.1358371,-21.9050574],[64.1431528,-21.7954426],[64.1428279,-21.9375652],[64.1083632,-21.8267035],[64.118433,-21.8651424],[64.1467252,-21.930412],[64.1075945,-21.8283235],[64.1198117,-21.852863],[64.1397542,-21.777889],[64.1462007,-21.964182],[64.1491512,-21.9532767],[64.1408607,-21.9133437],[64.122884,-21.8571423],[64.1450531,-21.8859366],[64.1020693,-21.8257487],[64.1341538,-21.9520324],[64.137432,-21.9526678],[64.1468518,-21.8634822],[64.1083632,-21.8267035],[64.1468518,-21.8634822],[64.1214538,-21.8530067],[64.1486198,-21.865761],[64.1230864,-21.820286],[64.1170437,-21.8119664],[64.135338,-21.89521],[64.1178514,-21.8600567],[64.123507,-21.9027236],[64.1069476,-21.7909564],[64.0980968,-21.8324444],[64.1439345,-21.9340992],[64.130178,-21.9518806],[64.1196365,-21.8595535],[64.1066997,-21.7837543],[64.1464708,-21.9503679],[64.1446191,-21.9595929],[64.1493444,-21.9679282],[64.1419033,-21.9463298],[64.1450531,-21.8859366],[64.135338,-21.89521],[64.1474137,-21.9245135],[64.094981,-21.8346314],[64.1301646,-21.8867236],[64.1334835,-21.9534597],[64.1096312,-21.7851968],[64.1320981,-21.8589138],[64.1296604,-21.9130964],[64.1525834,-21.7812568],[64.1450623,-21.8918219],[64.1458965,-21.8849333],[64.1191175,-21.8085104],[64.1450623,-21.8918219],[64.1229102,-21.8259686],[64.1503833,-21.9477923],[64.094981,-21.8346314],[64.1206218,-21.8158866],[64.1431528,-21.7954426],[64.1404823,-21.9099837],[64.1150153,-21.7886102],[64.1339297,-21.7444037],[64.1252238,-21.7428781],[64.1020693,-21.8257487],[64.1158137,-21.7945402],[64.1247051,-21.7506108],[64.1214538,-21.8530067],[64.1431528,-21.7954426],[64.1419033,-21.9463298],[64.1191175,-21.8085104],[64.1335822,-21.9168039],[64.133622,-21.9115584],[64.1020693,-21.8257487],[64.1419033,-21.9463298],[64.1463392,-21.7899446],[64.1405389,-21.9083671],[64.1437681,-21.9025433],[64.1500742,-21.9537749],[64.1231365,-21.8170703],[64.1256517,-21.857682],[64.1470486,-21.9496634],[64.0945755,-21.82924],[64.1506266,-21.9564735],[64.1263149,-21.8792702],[64.1355208,-21.8937767],[64.122884,-21.8571423],[64.1263149,-21.8792702],[64.1288614,-21.87585],[64.0962128,-21.84418],[64.1233574,-21.9013908],[64.1491512,-21.9532767],[64.1075945,-21.8283235],[64.1493495,-21.9621653],[64.1315936,-21.8796106],[64.1106761,-21.8154646],[64.1446595,-21.9575606],[64.1178514,-21.8600567],[64.1017648,-21.8333945],[64.1009189,-21.8363986],[64.1357247,-21.8626342],[64.1191175,-21.8085104],[64.1342545,-21.9110861],[64.1301801,-21.8931096],[64.127409,-21.8703446],[64.1275013,-21.7366131],[64.1094159,-21.81031],[64.1097187,-21.8326331],[64.1217939,-21.8167217],[64.1333104,-21.7903338],[64.1409288,-21.8556694],[64.1525834,-21.7812568],[64.1233892,-21.8738952],[64.1336035,-21.8603577],[64.1492678,-21.9443486],[64.1480152,-21.7881522],[64.09889,-21.8520841],[64.1458771,-21.8019872],[64.1067982,-21.8287175],[64.1336035,-21.8603577],[64.1178224,-21.8467969],[64.1539184,-21.7723626],[64.1358797,-21.8606286],[64.1016417,-21.8529673],[64.1335822,-21.9168039],[64.1486198,-21.865761],[64.1191175,-21.8085104],[64.1539184,-21.7723626],[64.1295278,-21.8577827],[64.1424047,-21.8876965],[64.1324806,-21.9058876],[64.1260173,-21.8633884],[64.1588897,-21.7494682],[64.1191175,-21.8085104],[64.135338,-21.89521],[64.0976227,-21.8318158],[64.1346598,-21.8083957],[64.1491345,-21.9494508],[64.1309868,-21.8847978],[64.1296604,-21.9130964],[64.1096312,-21.7851968],[64.1252238,-21.7428781],[64.1203157,-21.8585874],[64.143409,-21.93003],[64.1357062,-21.9509867],[64.1441731,-21.8981485],[64.1055562,-21.8234513],[64.1462007,-21.964182],[64.1357062,-21.9509867],[64.1335822,-21.9168039],[64.1458771,-21.8019872],[64.1247051,-21.7506108],[64.1336203,-21.9502088],[64.1479638,-21.79906],[64.1512903,-21.9479731],[64.1435066,-21.9274312],[64.1416248,-21.8611399],[64.144585,-21.7898751],[64.1357247,-21.8626342],[64.1419033,-21.9463298],[64.1146983,-21.7863822],[64.1430056,-21.7912889],[64.135338,-21.89521],[64.1329926,-21.9505954],[64.1351398,-21.905634],[64.1184883,-21.8316819],[64.1376927,-21.8172864],[64.0941591,-21.8444725],[64.1178224,-21.8467969],[64.1499375,-21.7786101],[64.1415805,-21.9006872],[64.0989631,-21.7797814],[64.1437681,-21.9025433],[64.1439519,-21.8609235],[64.0998747,-21.8208409],[64.133622,-21.9115584],[64.1578278,-21.7546337],[64.0976227,-21.8318158],[64.0986302,-21.8573294],[64.1049778,-21.8169326],[64.1333104,-21.7903338],[64.1406448,-21.9168478],[64.1493495,-21.9621653],[64.0975652,-21.8297727],[64.1382073,-21.8143928],[64.1342545,-21.9110861],[64.1324806,-21.9058876],[64.135338,-21.89521],[64.1535522,-21.7858807],[64.135338,-21.89521],[64.1466603,-21.8874076],[64.1439345,-21.9340992],[64.1504636,-21.9554792],[64.1428279,-21.9375652],[64.1229102,-21.8259686],[64.1409441,-21.7903019],[64.1465455,-21.9427734],[64.1518552,-21.7781496],[64.1301646,-21.8867236],[64.1222006,-21.864216],[64.1466603,-21.8874076],[64.1446191,-21.9595929],[64.149748,-21.878354],[64.1053157,-21.7883833],[64.1223661,-21.8566039],[64.1191175,-21.8085104],[64.1016261,-21.8174125],[64.1428279,-21.9375652],[64.1290842,-21.8516684],[64.1354711,-21.9588311],[64.1383205,-21.9610832],[64.1428279,-21.9375652],[64.1333104,-21.7903338],[64.1023605,-21.776195],[64.1247051,-21.7506108],[64.1191175,-21.8085104],[64.1469545,-21.9424916],[64.154152,-21.7669239],[64.148763,-21.9618977],[64.1468518,-21.8634822],[64.1472629,-21.9330133],[64.14504,-21.8640109],[64.1235953,-21.8945373],[64.1446093,-21.9536371],[64.1465455,-21.9427734],[64.1477107,-21.7757487],[64.1497124,-21.9495108],[64.135338,-21.89521],[64.1539184,-21.7723626],[64.1229102,-21.8259686],[64.0989631,-21.7797814],[64.123507,-21.9027236],[64.1269957,-21.8952287],[64.135338,-21.89521],[64.144774,-21.9041823],[64.1385795,-21.8088539],[64.14504,-21.8640109],[64.1309868,-21.8847978],[64.1342328,-21.8893458],[64.1373608,-21.784326],[64.1252238,-21.7428781],[64.1396391,-21.960105],[64.1472629,-21.9330133],[64.1291334,-21.861604],[64.116849,-21.8084312],[64.1333104,-21.7903338],[64.1329896,-21.9120843],[64.1333104,-21.7903338],[64.1403635,-21.8575422],[64.1486198,-21.865761],[64.128932,-21.7635119],[64.126452,-21.7389229],[64.135338,-21.89521],[64.1273258,-21.744672],[64.1403746,-21.9122483],[64.1486198,-21.865761],[64.144084,-21.9325781],[64.1377748,-21.7969822],[64.138865,-21.7727268],[64.1342545,-21.9110861],[64.135338,-21.89521],[64.1039033,-21.7817379],[64.1191175,-21.8085104],[64.133622,-21.9115584],[64.1246641,-21.8875734],[64.1055562,-21.8234513],[64.1413889,-21.9182286],[64.1191175,-21.8085104],[64.1368687,-21.9559572],[64.1450623,-21.8918219],[64.1233892,-21.8738952],[64.1518552,-21.7781496],[64.1506266,-21.9564735],[64.1290842,-21.8516684],[64.1016261,-21.8174125],[64.1016261,-21.8174125],[64.1396849,-21.8127245],[64.128932,-21.7635119],[64.135338,-21.89521],[64.1273258,-21.744672],[64.1358797,-21.8606286],[64.1588897,-21.7494682],[64.1474241,-21.7833826],[64.1273258,-21.744672],[64.1244016,-21.9017227],[64.0986302,-21.8573294],[64.1503833,-21.9477923],[64.094981,-21.8346314],[64.128932,-21.7635119],[64.1539184,-21.7723626],[64.1377748,-21.7969822],[64.1089203,-21.8369113],[64.1415069,-21.9635231],[64.1146983,-21.7863822],[64.1335822,-21.9168039],[64.1482086,-21.9641318],[64.1204045,-21.8253961],[64.1074005,-21.7870701],[64.1431785,-21.9031453],[64.1416248,-21.8611399],[64.1268905,-21.7630345],[64.101886,-21.8141204],[64.1406844,-21.959739],[64.1277789,-21.8844313],[64.1252238,-21.7428781],[64.1315936,-21.8796106],[64.1373608,-21.784326],[64.1357247,-21.8626342],[64.0980619,-21.8400674],[64.1269957,-21.8952287],[64.0998849,-21.7746594],[64.133622,-21.9115584],[64.1449337,-21.8714493],[64.1342328,-21.8893458],[64.1109993,-21.8317966],[64.0998747,-21.8208409],[64.0999001,-21.8155572],[64.135338,-21.89521],[64.1416248,-21.8611399],[64.1191175,-21.8085104],[64.1438289,-21.9261119],[64.1476715,-21.9447515],[64.135338,-21.89521],[64.1462007,-21.964182],[64.1096312,-21.7851968],[64.1389918,-21.7808217],[64.1541241,-21.7932474],[64.1436398,-21.9224104],[64.0976209,-21.8418692],[64.1496674,-21.7723796],[64.1009189,-21.8363986],[64.154152,-21.7669239],[64.1059746,-21.8110199],[64.135338,-21.89521],[64.1476715,-21.9447515],[64.1031954,-21.8129706],[64.1083632,-21.8267035],[64.1290842,-21.8516684],[64.1115014,-21.78873],[64.1215763,-21.829041],[64.1055562,-21.8234513],[64.1399933,-21.9640978],[64.1358371,-21.9050574],[64.1252238,-21.7428781],[64.1355208,-21.8937767],[64.144176,-21.9354742],[64.1295278,-21.8577827],[64.1431785,-21.9031453],[64.1438289,-21.9261119],[64.1431785,-21.9031453],[64.1058787,-21.7804459],[64.0979704,-21.8546429],[64.1230683,-21.7611181],[64.1446595,-21.9575606],[64.1069476,-21.7909564],[64.1507871,-21.9820193],[64.1370862,-21.8109867],[64.1333104,-21.7903338],[64.1055562,-21.8234513],[64.09889,-21.8520841],[64.1269957,-21.8952287],[64.1338611,-21.8646843],[64.148763,-21.9618977],[64.1069476,-21.7909564],[64.1468221,-21.9284344],[64.1406844,-21.959739],[64.1268905,-21.7630345],[64.1016261,-21.8202863],[64.1390188,-21.8102483],[64.0962128,-21.84418],[64.1402224,-21.9173307],[64.13212,-21.8179106],[64.1415179,-21.9145437],[64.1329896,-21.9120843],[64.1551493,-21.761286],[64.1461585,-21.9601846],[64.1463392,-21.7899446],[64.135338,-21.89521],[64.1191175,-21.8085104],[64.1326691,-21.9515505],[64.1449337,-21.8714493],[64.1519538,-21.7916215],[64.154152,-21.7669239],[64.1315936,-21.8796106],[64.1060316,-21.8302322],[64.1256517,-21.857682],[64.1399933,-21.9640978],[64.1440453,-21.9168064],[64.0957686,-21.826377],[64.0998037,-21.8564435],[64.1462007,-21.964182],[64.1409288,-21.8556694],[64.1230683,-21.7611181],[64.1397542,-21.777889],[64.1329896,-21.9120843],[64.1434581,-21.9599101],[64.1450623,-21.8918219],[64.1074005,-21.7870701],[64.128932,-21.7635119],[64.148763,-21.9618977],[64.135338,-21.89521],[64.0976227,-21.8318158],[64.1008987,-21.83819],[64.1016417,-21.8529673],[64.1551493,-21.761286],[64.1358371,-21.9050574],[64.1551493,-21.761286],[64.1446191,-21.9595929],[64.0998885,-21.8587403],[64.1507871,-21.9820193],[64.126452,-21.7389229],[64.14504,-21.8640109],[64.1096312,-21.7851968],[64.1017058,-21.835575],[64.135338,-21.89521],[64.1008534,-21.8365797],[64.109643,-21.8266809],[64.094981,-21.8346314],[64.1487089,-21.8736549],[64.1467019,-21.8828651],[64.1494733,-21.9614512],[64.1059746,-21.8110199],[64.1191175,-21.8085104],[64.135338,-21.89521],[64.150555,-21.798705],[64.1461585,-21.9601846],[64.1471129,-21.8851893],[64.1323386,-21.9125459],[64.1230683,-21.7611181],[64.1379474,-21.8985107],[64.1354711,-21.9588311],[64.1419033,-21.9463298],[64.1486198,-21.865761],[64.1109993,-21.8317966],[64.1377748,-21.7969822],[64.1083632,-21.8267035],[64.1049778,-21.8169326],[64.1437168,-21.8865119],[64.0958587,-21.8329659],[64.1256671,-21.8768369],[64.0929361,-21.8411029],[64.1357062,-21.9509867],[64.1247051,-21.7506108],[64.1396391,-21.960105],[64.1256517,-21.857682],[64.1480152,-21.7881522],[64.1339291,-21.8001138],[64.1301646,-21.8867236],[64.1464708,-21.9503679],[64.1020693,-21.8257487],[64.1269957,-21.8952287],[64.1458366,-21.777534],[64.1479081,-21.9558337],[64.1408607,-21.9133437],[64.1357062,-21.9509867],[64.1158137,-21.7945402],[64.1398445,-21.9106079],[64.1578278,-21.7546337],[64.1342545,-21.9110861],[64.1503833,-21.9477923],[64.1415069,-21.9635231],[64.1247051,-21.7506108],[64.1055562,-21.8234513],[64.133622,-21.9115584],[64.1441731,-21.8981485],[64.1464708,-21.9503679],[64.1191175,-21.8085104],[64.101886,-21.8141204],[64.1479638,-21.79906],[64.1229102,-21.8259686],[64.1485779,-21.794786],[64.0937923,-21.8355647],[64.1493444,-21.9679282],[64.1301801,-21.8931096],[64.126452,-21.7389229],[64.1416248,-21.8611399],[64.1022775,-21.8548871],[64.144084,-21.9325781],[64.1009189,-21.8363986],[64.1415179,-21.9145437],[64.1336035,-21.8603577],[64.1491345,-21.9494508],[64.1301646,-21.8867236],[64.0982729,-21.8431348],[64.11937,-21.8641783],[64.1443135,-21.7943499],[64.1222006,-21.864216],[64.1008987,-21.83819],[64.1265079,-21.8976963],[64.1214538,-21.8530067],[64.1470785,-21.9278974],[64.1357247,-21.8626342],[64.1290842,-21.8516684],[64.1489239,-21.9531745],[64.1419033,-21.9463298],[64.1008987,-21.83819],[64.1238846,-21.8606743],[64.1430808,-21.8871364],[64.1460117,-21.7860813],[64.1096265,-21.8127856],[64.1358371,-21.9050574],[64.1364809,-21.7980954],[64.1060371,-21.8073009],[64.148763,-21.9618977],[64.1320981,-21.8589138],[64.109643,-21.8266809],[64.1417322,-21.7952061],[64.1364809,-21.7980954],[64.130631,-21.8840468],[64.148763,-21.9618977],[64.1307352,-21.9013806],[64.1309868,-21.8847978],[64.1458965,-21.8849333],[64.1067982,-21.8287175],[64.1320981,-21.8589138],[64.1518552,-21.7781496],[64.1364809,-21.7980954],[64.1204045,-21.8253961],[64.1333104,-21.7903338],[64.1342545,-21.9110861],[64.135338,-21.89521],[64.1438289,-21.9261119],[64.1364809,-21.7980954],[64.0945755,-21.82924],[64.1238846,-21.8606743],[64.1094891,-21.7919034],[64.14032,-21.9019555],[64.1178514,-21.8600567],[64.1404823,-21.9099837],[64.1492209,-21.947009],[64.1235953,-21.8945373],[64.1017648,-21.8333945],[64.1089203,-21.8369113],[64.1101496,-21.8306338],[64.1178514,-21.8600567],[64.1246736,-21.883381],[64.1438289,-21.9261119],[64.1075945,-21.8283235],[64.1268131,-21.7593159],[64.1474137,-21.9245135],[64.143409,-21.93003],[64.1383205,-21.9610832],[64.1238846,-21.8606743],[64.1450623,-21.8918219],[64.1364809,-21.7980954],[64.1387702,-21.9188414],[64.1486198,-21.865761],[64.1474666,-21.9620423],[64.118433,-21.8651424],[64.11937,-21.8641783],[64.1249087,-21.8845883],[64.1323386,-21.9125459],[64.1518552,-21.7781496],[64.1413192,-21.9390842],[64.1023605,-21.776195],[64.135338,-21.89521],[64.130178,-21.9518806],[64.1504636,-21.9554792],[64.1494733,-21.9614512],[64.1247051,-21.7506108],[64.1092013,-21.8373194],[64.1358371,-21.9050574],[64.1378841,-21.9020738],[64.1437168,-21.8865119],[64.1415805,-21.9006872],[64.1376927,-21.8172864],[64.1419033,-21.9463298],[64.1493444,-21.9679282],[64.1342545,-21.9110861],[64.135338,-21.89521],[64.1307352,-21.9013806],[64.0986302,-21.8573294],[64.135338,-21.89521],[64.1355208,-21.8937767],[64.13212,-21.8179106],[64.1417322,-21.7952061],[64.1430309,-21.9316078],[64.1335822,-21.9168039],[64.0967611,-21.8323188],[64.1469545,-21.9424916],[64.1204045,-21.8253961],[64.1430808,-21.8871364],[64.1233574,-21.9013908],[64.1309594,-21.855919],[64.1485779,-21.794786],[64.1443135,-21.7943499],[64.1365095,-21.7941015],[64.1399933,-21.9640978],[64.13212,-21.8179106],[64.1404823,-21.9099837],[64.1358371,-21.9050574],[64.1432262,-21.930749],[64.130631,-21.8840468],[64.1470486,-21.9496634],[64.1424436,-21.8209556],[64.1416248,-21.8611399],[64.1479638,-21.79906],[64.1470486,-21.9496634],[64.1200352,-21.8631909],[64.1450623,-21.8918219],[64.1230683,-21.7611181],[64.1518552,-21.7781496],[64.1431785,-21.9031453],[64.1222006,-21.864216],[64.0999001,-21.8155572],[64.14032,-21.9019555],[64.1196162,-21.8853611],[64.0987517,-21.8235881],[64.1535522,-21.7858807],[64.1222006,-21.864216],[64.1012619,-21.8532573],[64.1188446,-21.8594895],[64.1240187,-21.8733188],[64.1500742,-21.9537749],[64.1446093,-21.9536371],[64.1074005,-21.7870701],[64.1089203,-21.8369113],[64.1474241,-21.7833826],[64.1268131,-21.7593159],[64.1235953,-21.8945373],[64.1252238,-21.7428781],[64.0941591,-21.8444725],[64.0993236,-21.8182366],[64.1428279,-21.9375652],[64.1474666,-21.9620423],[64.1053157,-21.7883833],[64.1450623,-21.8918219],[64.1389918,-21.7808217],[64.1358797,-21.8606286],[64.0985848,-21.8543313],[64.1009189,-21.8363986],[64.1539184,-21.7723626],[64.135338,-21.89521],[64.1066997,-21.7837543],[64.1209732,-21.8723376],[64.1355208,-21.8937767],[64.1450531,-21.8859366],[64.1101496,-21.8306338],[64.1415805,-21.9006872],[64.148763,-21.9618977],[64.126452,-21.7389229],[64.1315936,-21.8796106],[64.1364809,-21.7980954],[64.1450531,-21.8859366],[64.149748,-21.878354],[64.1403635,-21.8575422],[64.1439723,-21.9646731],[64.1403155,-21.9261632],[64.1068499,-21.8064966],[64.1083632,-21.8267035],[64.1460117,-21.7860813],[64.1351398,-21.905634],[64.1008534,-21.8365797],[64.1480152,-21.7881522],[64.1002867,-21.7731448],[64.1252238,-21.7428781],[64.1247051,-21.7506108],[64.1336035,-21.8603577],[64.135338,-21.89521],[64.1039033,-21.7817379],[64.1419033,-21.9463298],[64.1260173,-21.8633884],[64.1464486,-21.9257734],[64.1486448,-21.9429478],[64.1191175,-21.8085104],[64.1355208,-21.8937767],[64.1094159,-21.81031],[64.1377748,-21.7969822],[64.1458965,-21.8849333],[64.1399933,-21.9640978],[64.0986302,-21.8573294],[64.1055562,-21.8234513],[64.1462007,-21.964182],[64.1415805,-21.9006872],[64.1058787,-21.7804459],[64.1246736,-21.883381],[64.1191175,-21.8085104],[64.1339291,-21.8001138],[64.1446595,-21.9575606],[64.1233892,-21.8738952],[64.1503833,-21.9477923],[64.1247051,-21.7506108],[64.1413192,-21.9390842],[64.1357247,-21.8626342],[64.111053,-21.8208142],[64.1074005,-21.7870701],[64.1353772,-21.8513184],[64.1458965,-21.8849333],[64.1467019,-21.8828651],[64.1238846,-21.8606743],[64.1053157,-21.7883833],[64.1480152,-21.7881522],[64.1315936,-21.8796106],[64.1430056,-21.7912889],[64.1436398,-21.9224104],[64.0933891,-21.8391621],[64.1474666,-21.9620423],[64.1315936,-21.8796106],[64.0999001,-21.8155572],[64.1441731,-21.8981485],[64.1551493,-21.761286],[64.150555,-21.798705],[64.1256671,-21.8768369],[64.1428279,-21.9375652],[64.1217917,-21.8582077],[64.1060316,-21.8302322],[64.1428279,-21.9375652],[64.1377748,-21.7969822],[64.149748,-21.878354],[64.1339291,-21.8001138],[64.126131,-21.7535609],[64.1496674,-21.7723796],[64.1233574,-21.9013908],[64.1096265,-21.8127856],[64.1485779,-21.794786],[64.1269957,-21.8952287],[64.1494733,-21.9614512],[64.1252238,-21.7428781],[64.1354459,-21.8530231],[64.1096265,-21.8127856],[64.130631,-21.8840468],[64.1096265,-21.8127856],[64.1486198,-21.865761],[64.1196365,-21.8595535],[64.1109993,-21.8317966],[64.1256517,-21.857682],[64.1191175,-21.8085104],[64.1191175,-21.8085104],[64.1355208,-21.8937767],[64.1464708,-21.9503679],[64.1256341,-21.7547774],[64.1025932,-21.8496731],[64.1255194,-21.8662266],[64.1025932,-21.8496731],[64.1324806,-21.9058876],[64.1268131,-21.7593159],[64.1312523,-21.9061875],[64.1430309,-21.9316078],[64.1230683,-21.7611181],[64.1075945,-21.8283235],[64.1009189,-21.8363986],[64.1020693,-21.8257487],[64.1198514,-21.8763807],[64.1378739,-21.9554206],[64.1504636,-21.9554792],[64.101886,-21.8141204],[64.1268905,-21.7630345],[64.1191175,-21.8085104],[64.1039959,-21.7843422],[64.1415805,-21.9006872],[64.1342545,-21.9110861],[64.148763,-21.9618977],[64.116315,-21.7974879],[64.133622,-21.9115584],[64.1096265,-21.8127856],[64.1484696,-21.7837339],[64.0987517,-21.8235881],[64.1017058,-21.835575],[64.1353772,-21.8513184],[64.1399933,-21.9640978],[64.1444784,-21.9462081],[64.1204169,-21.8826048],[64.1158137,-21.7945402],[64.1230683,-21.7611181],[64.1218194,-21.8790684],[64.1396391,-21.960105],[64.1535222,-21.797713],[64.1240187,-21.8733188],[64.1154614,-21.7920262],[64.135338,-21.89521],[64.1017648,-21.8333945],[64.1355208,-21.8937767],[64.129359,-21.7511467],[64.1078233,-21.8164102],[64.1496674,-21.7723796],[64.1431474,-21.8616682],[64.1578278,-21.7546337],[64.1415179,-21.9145437],[64.1357247,-21.8626342],[64.147714,-21.9728869],[64.1385795,-21.8088539],[64.1377719,-21.9083466],[64.1453734,-21.787876],[64.1578278,-21.7546337],[64.1431785,-21.9031453],[64.1296604,-21.9130964],[64.1275013,-21.7366131],[64.1518552,-21.7781496],[64.1212528,-21.8188843],[64.1231365,-21.8170703],[64.1377748,-21.7969822],[64.0988571,-21.7760618],[64.1357247,-21.8626342],[64.1094159,-21.81031],[64.1417322,-21.7952061],[64.1191175,-21.8085104],[64.1409288,-21.8556694],[64.144585,-21.7898751],[64.0937923,-21.8355647],[64.1415805,-21.9006872],[64.1309868,-21.8847978],[64.1482086,-21.9641318],[64.149748,-21.878354],[64.1119675,-21.8310709],[64.1355208,-21.8937767],[64.130631,-21.8840468],[64.1539184,-21.7723626],[64.1301646,-21.8867236],[64.094981,-21.8346314],[64.1404823,-21.9099837],[64.1323799,-21.9033122],[64.0993236,-21.8182366],[64.1439723,-21.9646731],[64.1346598,-21.8083957],[64.1364972,-21.7736943],[64.1096265,-21.8127856],[64.1230683,-21.7611181],[64.1008534,-21.8365797],[64.0989631,-21.7797814],[64.1403635,-21.8575422],[64.135338,-21.89521],[64.1551493,-21.761286],[64.1355208,-21.8937767],[64.1354711,-21.9588311],[64.1339291,-21.8001138],[64.1511792,-21.9549272],[64.1410147,-21.9164137],[64.1364809,-21.7980954],[64.1016261,-21.8202863],[64.1016261,-21.8202863],[64.1479081,-21.9558337],[64.1462007,-21.964182],[64.1389918,-21.7808217],[64.1268131,-21.7593159],[64.1188446,-21.8594895],[64.1229102,-21.8259686],[64.1059746,-21.8110199],[64.1491345,-21.9494508],[64.14504,-21.8640109],[64.094981,-21.8346314],[64.1389918,-21.7808217],[64.1049778,-21.8169326],[64.1377748,-21.7969822],[64.0993236,-21.8182366],[64.1339291,-21.8001138],[64.126452,-21.7389229],[64.1506266,-21.9564735],[64.126131,-21.7535609],[64.1474241,-21.7833826]];
var minPeriod=00;
var maxPeriod=11;
var i=0;
var period = maxPeriod;
var timer = undefined;

var hquad=4,vquad=4;
var mLeft=-22.00183868408203,mRight=-21.72718048095703,mTop=64.08705688372306,mBottom=64.17693170346975;


var addresses=points.map(function(p) {return {period:Math.floor(Math.random()*12), coords:p};})
addresses.forEach(function(a) {var n,x,y;
	x=Math.floor((a.coords[1]-mLeft)/(mRight-mLeft)*hquad);
	y=Math.floor((a.coords[0]-mBottom)/(mTop-mBottom)*vquad)
	n=x*hquad+y;
	a["neighborhood"]=n;
	a["price"]=(Math.floor(Math.random()*30)+10+x+y)*10000;
})


function sum(data) {return pv.sum(data, function(d) {return d.price;});}
function avg(data) {return pv.mean(data, function(d) {return d.price;});}

var cScale=pv.Scale.linear(100000,500000).range("red","green");

var polygonMarkerSet=[];
pv.range(hquad).forEach(function(x) {
	pv.range(vquad).forEach(function(y) {
		var poly=[];
		poly.push(new CM.LatLng(mBottom+y*(mTop-mBottom)/vquad,mLeft-x*(mLeft-mRight)/hquad));
		poly.push(new CM.LatLng(mBottom+y*(mTop-mBottom)/vquad,mLeft-(x+1)*(mLeft-mRight)/hquad));
		poly.push(new CM.LatLng(mBottom+(y+1)*(mTop-mBottom)/vquad,mLeft-(x+1)*(mLeft-mRight)/hquad));
		poly.push(new CM.LatLng(mBottom+(y+1)*(mTop-mBottom)/vquad,mLeft-x*(mLeft-mRight)/hquad));
		polygonMarkerSet.push(poly);
	})
;})









	var CloudMadeIcon = new CM.Icon();
	CloudMadeIcon.image = "house16.png";
	CloudMadeIcon.iconSize = new CM.Size(16, 16);
	CloudMadeIcon.iconAnchor = new CM.Point(9, 15);


    var cloudmade = new CM.Tiles.CloudMade.Web({key: 'b0e97d7c45a944c493831ed88f14f7c3'});
    //var cloudmade = new CM.Tiles.CloudMade.Web({key: 'b0e97d7c45a944c493831ed88f14f7c3'});
    var map = new CM.Map('reykjavik', cloudmade);
    map.setCenter(new CM.LatLng(  64.13203063703041,-21.860389709472656), 12);
 /*   var markers = [];
    for (var i = 0; i < samplepoints.length; i++) {


    	markers.push(createMarker(i););
    }
    var clusterer = new CM.MarkerClusterer(map, {clusterRadius:50});
    clusterer.addMarkers(markers);
*/

// preparing polygons and markers to be added when the time is right
polyPeriod=[];
pv.range(12).forEach(function(period) {
	var polyList=[];
	polygonMarkerSet.forEach(function(p,i) {


		props=addresses.filter(function(d) {return (d.neighborhood==i)&&(d.period==period);});
		if (props.length) {
			var value=avg(props);
			var myColor=cScale(value).color;
			var x=new CM.Polygon(p,myColor,1);
			polyList.push(x);
			}
		;})
	polyPeriod.push(polyList);
});


markerPeriod=pv.range(12).map(function() {return [];})
addresses.forEach(function(a,i) {
var myMarker=new CM.Marker(new CM.LatLng(a.coords[0],a.coords[1]),{icon:CloudMadeIcon});
myMarker.bindInfoWindow("<h3>Property #"+i+"</h3>"+	a.price);
markerPeriod[a.period].push(myMarker);
})
render();
// dealing with the slider


$(periodSlider).slider({
  min: minPeriod,
  max: maxPeriod,
  value: maxPeriod,
  slide: function(e, ui) {
    period = ui.value;
    updatePeriod();
    render();
  }
});

function updatePeriod() {
  var stepSome = setInterval(function() {
    if (i++ > 10) clearInterval(stepSome);
    render();
  }, 20);
}



function playClick() {
  if (timer) {
    stop();
  } else {
    if (period == maxPeriod) period = minPeriod;
    $(periodSlider).slider('value', period);
    $(play).attr("src", 'stop.png');
    updatePeriod();
    render();
    timer = setInterval(function() {
      period++;
      if (period >= maxPeriod) stop();
      $(periodSlider).slider('value', period);
      updatePeriod();
      render();
    }, 900);
  }
}

// Stop the animation
function stop() {
  clearInterval(timer);
  timer = undefined;
  $(play).attr("src", 'play.png');
}

// rendering proper

function render() {
	map.clearOverlays();
	polyPeriod[period].forEach(function(p) {map.addOverlay(p);})
	markerPeriod[period].forEach(function(m) {map.addOverlay(m);})
}

    </script>
  </div></div></body>
</html>