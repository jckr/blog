<!DOCTYPE html>
<html lang="en-US">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="HandheldFriendly" content="True" />
<meta name="MobileOptimized" content="320" />

<title>May | 2012 | jckr.github.io/blog</title>

<link rel="profile" href="http://gmpg.org/xfn/11">
<link rel="pingback" href="/blog/xmlrpc.php">
<link rel='dns-prefetch' href='//fonts.googleapis.com' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel="alternate" type="application/rss+xml" title="jckr.github.io/blog &raquo; Feed" href="/blog/feed/" />
<link rel="alternate" type="application/rss+xml" title="jckr.github.io/blog &raquo; Comments Feed" href="/blog/comments/feed/" />
<!-- This site uses the Google Analytics by MonsterInsights plugin v7.0.5 - Using Analytics tracking - https://www.monsterinsights.com/ -->
<!-- Note: MonsterInsights is not currently configured on this site. The site owner needs to authenticate with Google Analytics in the MonsterInsights settings panel. -->
<!-- No UA code set -->
<!-- / Google Analytics by MonsterInsights -->
		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2\/svg\/","svgExt":".svg","source":{"concatemoji":"http:\/\/localhost:8888\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.6.10"}};
			!function(a,b,c){function d(a){var c,d,e,f,g,h=b.createElement("canvas"),i=h.getContext&&h.getContext("2d"),j=String.fromCharCode;if(!i||!i.fillText)return!1;switch(i.textBaseline="top",i.font="600 32px Arial",a){case"flag":return i.fillText(j(55356,56806,55356,56826),0,0),!(h.toDataURL().length<3e3)&&(i.clearRect(0,0,h.width,h.height),i.fillText(j(55356,57331,65039,8205,55356,57096),0,0),c=h.toDataURL(),i.clearRect(0,0,h.width,h.height),i.fillText(j(55356,57331,55356,57096),0,0),d=h.toDataURL(),c!==d);case"diversity":return i.fillText(j(55356,57221),0,0),e=i.getImageData(16,16,1,1).data,f=e[0]+","+e[1]+","+e[2]+","+e[3],i.fillText(j(55356,57221,55356,57343),0,0),e=i.getImageData(16,16,1,1).data,g=e[0]+","+e[1]+","+e[2]+","+e[3],f!==g;case"simple":return i.fillText(j(55357,56835),0,0),0!==i.getImageData(16,16,1,1).data[0];case"unicode8":return i.fillText(j(55356,57135),0,0),0!==i.getImageData(16,16,1,1).data[0];case"unicode9":return i.fillText(j(55358,56631),0,0),0!==i.getImageData(16,16,1,1).data[0]}return!1}function e(a){var c=b.createElement("script");c.src=a,c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var f,g,h,i;for(i=Array("simple","flag","unicode8","diversity","unicode9"),c.supports={everything:!0,everythingExceptFlag:!0},h=0;h<i.length;h++)c.supports[i[h]]=d(i[h]),c.supports.everything=c.supports.everything&&c.supports[i[h]],"flag"!==i[h]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[i[h]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(g=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",g,!1)):(a.attachEvent("onload",g),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),f=c.source||{},f.concatemoji?e(f.concatemoji):f.wpemoji&&f.twemoji&&(e(f.twemoji),e(f.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<link rel='stylesheet' id='YoutubeShortcodeMargenn-css'  href='/wp-content/plugins/youtube-shortcode/youtube-shortcode.css?ver=4.6.10' type='text/css' media='all' />
<link rel='stylesheet' id='casper-google-fonts-css'  href='//fonts.googleapis.com/css?family=Noto+Serif%3A400%2C700%2C400italic%7COpen+Sans%3A700%2C400&#038;ver=4.6.10' type='text/css' media='all' />
<link rel='stylesheet' id='casper-style-css'  href='/wp-content/themes/casper/style.css?ver=4.6.10' type='text/css' media='all' />
<script type='text/javascript' src='/wp-includes/js/jquery/jquery.js?ver=1.12.4'></script>
<script type='text/javascript' src='/wp-includes/js/jquery/jquery-migrate.min.js?ver=1.4.1'></script>
<link rel='https://api.w.org/' href='/wp-json/' />
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="/blog/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="/blog/wp-includes/wlwmanifest.xml" /> 
<meta name="generator" content="WordPress 4.6.10" />

   	<style type="text/css">
					.blog-title a, .blog-description, .social-icons a { color: #222222; }
		
						                
		
							.main-navigation a { color: ; }
		                                            </style>
    		<style type="text/css">.recentcomments a{display:inline !important;padding:0 !important;margin:0 !important;}</style>
			<style type="text/css">
			.site-title a,
		.site-description {
			color: #222222;
		}
		</style>
	<style type="text/css" id="syntaxhighlighteranchor"></style>
</head>

<body class="archive date group-blog">

<header id="masthead" role="banner" class="site-head site-header" style="background-image: url(/wp-content/uploads/2018/04/Screenshot-2018-04-09-19.38.59.png);">
    <nav id="site-navigation" class="main-navigation" role="navigation">
        <div>
            <h1 class="menu-toggle">
                <a class="icon-bars" href="#">
                    <span class="hidden">Menu</span>
                </a>
            </h1>
            <a class="skip-link screen-reader-text" href="#content">Skip to content</a>
            <div class="menu"><ul><li ><a href="/blog/">Home</a></li></ul></div>
        </div>
    </nav><!-- #site-navigation -->

    <div class="vertical-row">
        <div class="vertical">
            <div class="site-head-content inner">
                
                <div class="social-icons">
                                                                                                                                                                                                                                                                                                                                                                                                                                                    </div>
                <h1 class="blog-title"><a class="blog-logo" href='/' rel='home'>jckr.github.io/blog</a></h1>
                <h2 class="blog-description">Just another WordPress site</h2>
            </div>
        </div>
    </div>
</header><!-- #masthead -->

<main id="content" class="content" role="main">

	<section id="primary" class="content-area">
		<main id="main" class="site-main" role="main">

		
			<header class="page-header">
				<h1 class="page-title">
					Month: <span>May 2012</span>				</h1>
							</header><!-- .page-header -->

						
				
<article id="post-1246" class="post-1246 post type-post status-publish format-standard hentry category-d3 category-data-visualization category-tips">
		    <header class="post-header">
        			<span class="post-meta">
				<span class="posted-on"><a href="/blog/2012/05/28/manipulating-data-like-a-boss-with-d3/" rel="bookmark"><time class="entry-date published" datetime="2012-05-28T03:27:24+00:00">May 28, 2012</time></a></span><span class="byline"> by <span class="author vcard"><a class="url fn n" href="/blog/author/jerome/">jerome</a></span></span> on <a href="/blog/category/d3/" rel="category tag">d3</a>, <a href="/blog/category/data-visualization/" rel="category tag">data visualization</a>, <a href="/blog/category/tips/" rel="category tag">tips</a>			</span>
		        <h1 class="post-title"><a href="/blog/2012/05/28/manipulating-data-like-a-boss-with-d3/" rel="bookmark">Manipulating data like a boss with d3</a></h1>
         
    </header>
	<section class="post-content">

		<p>Updates:<br />
1) I&#8217;ve put all the code examples in http://codepen.io/collection/njzYxo/<br />
2) I will rewrite this post after I&#8217;m done publishing my <a href="/blog/2016/08/09/visualization-with-react/">Visualization with React</a> series, because it&#8217;s 4 years old and there are other ways to do this now.</p>
<p>Data is the first D in d3 (or possibly the 3rd, but it&#8217;s definitely one of these).</p>
<p>Anyway. Putting your data in the right form is crucial to have concise code that runs fast and is easy to read (and, later, troubleshoot).</p>
<p>So what shape should your data be in?<br />
You undoubtedly have many options. </p>
<p>To follow through this tutorial, let&#8217;s assume you want to plot the relationship between R&#038;D expenditure and GDP growth for a number of countries. You have got <a href="http://jckr.github.io/blog/stuff/data%20example/data.csv">this file</a>, full of tabular data, which lists for every country a name, a continent, the gross R&#038;D expenditure as a percentage of GDP, GDP growth, and for context population and GDP per capita.</p>
<p>So one very basic approach would be to put each of these variables into one independent array.</p>
<pre class="brush: jscript; title: ; notranslate" title="">var GERD=[2.21367, 2.74826, 1.96158, 1.80213, 0.39451, 1.52652, 3.01937, 1.44122, 3.84137, 2.20646, 2.78056, 0.5921, 1.14821, 2.64107, 1.78988, 4.2504, 1.26841, 3.33499, 3.3609, 1.67862, 0.41322, 1.81965, 1.13693, 1.75922, 0.67502, 1.65519, 1.24252, 0.48056, 1.85642, 0.92523, 1.38357, 3.61562, 2.99525, 0.84902, 1.82434, 2.78518];
var growth=[2.48590317, 3.10741128, 1.89308521, 3.21494841, 5.19813626, 1.65489834, 1.04974368, 7.63563272, 2.85477157, 1.47996142, 2.99558644, -6.90796403, 1.69192342, -3.99988322, -0.42935239, 4.84602001, 0.43108032, 3.96559062, 6.16184325, 2.67806902, 5.56185685, 1.18517739, 2.33052515, 1.59773989, 4.34962928, -1.60958484, 4.03428262, 3.34920254, -0.17459255, 2.784, -0.06947685, 3.93555895, 2.71404473, 9.00558548, 2.09209263, 3.02171711];
var GDPcap=[40718.78167, 42118.46375, 38809.66436, 39069.91407, 15106.73205, 25956.76492, 40169.83173, 22403.02459, 37577.71225, 34147.98907, 39389.25874, 26878.00015, 21731.55484, 35641.55402, 40457.94273, 28595.68799, 32580.06572, 33751.23348, 29101.34563, 86226.3276, 15200.22119, 43455.30129, 29870.67748, 57230.89, 19882.99226, 25425.59561, 19833, 24429.61828, 27559.75186, 10497.583, 32779.3288, 41526.2995, 46621.77334, 15666.18783, 35715.4691, 46587.61843];
var population=[22319.07, 8427.318, 10590.44, 33909.7, 17248.45, 10286.3, 5495.246, 1335.347, 5366.482, 62747.78, 82852.47, 11312.16, 9993.116, 308.038, 4394.382, 7623.6, 59059.66, 126912.8, 48988.83, 483.701, 109219.9, 16480.79, 4291.9, 4789.628, 37725.21, 10684.97, 142822.5, 5404.493, 2029.418, 50384.55, 44835.48, 9276.365, 7889.345, 73497, 62761.35, 313232];
var country=[&quot;Australia&quot;, &quot;Austria&quot;, &quot;Belgium&quot;, &quot;Canada&quot;, &quot;Chile&quot;, &quot;Czech Republic&quot;, &quot;Denmark&quot;, &quot;Estonia&quot;, &quot;Finland&quot;, &quot;France&quot;, &quot;Germany&quot;, &quot;Greece&quot;, &quot;Hungary&quot;, &quot;Iceland&quot;, &quot;Ireland&quot;, &quot;Israel&quot;, &quot;Italy&quot;, &quot;Japan&quot;, &quot;Korea&quot;, &quot;Luxembourg&quot;, &quot;Mexico&quot;, &quot;Netherlands&quot;, &quot;New Zealand&quot;, &quot;Norway&quot;, &quot;Poland&quot;, &quot;Portugal&quot;, &quot;Russian Federation&quot;, &quot;Slovak Republic&quot;, &quot;Slovenia&quot;, &quot;South Africa&quot;, &quot;Spain&quot;, &quot;Sweden&quot;, &quot;Switzerland&quot;, &quot;Turkey&quot;, &quot;United Kingdom&quot;, &quot;United States&quot;];
var continent=[&quot;Oceania&quot;, &quot;Europe&quot;, &quot;Europe&quot;, &quot;America&quot;, &quot;America&quot;, &quot;Europe&quot;, &quot;Europe&quot;, &quot;Europe&quot;, &quot;Europe&quot;, &quot;Europe&quot;, &quot;Europe&quot;, &quot;Europe&quot;, &quot;Europe&quot;, &quot;Europe&quot;, &quot;Europe&quot;, &quot;Asia&quot;, &quot;Europe&quot;, &quot;Asia&quot;, &quot;Asia&quot;, &quot;Europe&quot;, &quot;America&quot;, &quot;Europe&quot;, &quot;Oceania&quot;, &quot;Europe&quot;, &quot;Europe&quot;, &quot;Europe&quot;, &quot;Europe&quot;, &quot;Europe&quot;, &quot;Europe&quot;, &quot;Africa&quot;, &quot;Europe&quot;, &quot;Europe&quot;, &quot;Europe&quot;, &quot;Europe&quot;, &quot;Europe&quot;, &quot;America&quot;];</pre>
<p>(don&#8217;t bother scrolling, it&#8217;s more of the same 🙂 )<br />
Then, you can just create marks for each data item and fetch each attribute independently.<br />
Let&#8217;s do a bubble chart for instance.<br />
(small aside: in the post I won&#8217;t go through the code to set up the svg container or the scales, instead focusing on the data structures. That code, which is really nothing special, can be found in the source code of the examples).</p>
<p>So to create our circles we would write something like: </p>
<pre class="brush: jscript; title: ; notranslate" title="">svg.selectAll(&quot;circle&quot;).data(country).enter()
  .append(&quot;circle&quot;)
  .attr(&quot;cx&quot;,function(d,i) {return x(GERD[i]);})
  .attr(&quot;cy&quot;,function(d,i) {return y(growth[i]);})
  .attr(&quot;r&quot;,function(d,i) {return r(Math.sqrt(population[i]));})

  .style(&quot;fill&quot;,function(d,i) {return c(continent[i]);})
  .style(&quot;opacity&quot;,function(d,i) {return o(GDPcap[i]);})

    .append(&quot;title&quot;)
    .text(String)</pre>
<p>and this works:<br />
<iframe src="https://jckr.github.io/blog/stuff/data%20example/data-example0.html" width=512px height=520px scrolling=no style="border:0px"></iframe><br />
<a href="http://jckr.github.io/blog/stuff/data%20example/data-example0.html">See example in its own tab or window</a><br />
but this is hell to maintain. If for some reason there is an error in one of the values, for instance due to a cat or a small child in the proximity of the computer, the error will be very difficult to troubleshoot.<br />
Another problem is that it&#8217;s very difficult to apply any kind of subsequent treatment to the data. For instance, you will notice that there are smaller bubbles entirely within the large orange bubble which happens to be on top of them. So it&#8217;s not possible to mouseover the smaller bubbles. One way to address that would be to sort data in order of decreasing population (the size of the bubbles) so that it would be impossible to have this kind of situation. Now while it is possible sorting 6 arrays according to the values of one, it&#8217;s very messy.</p>
<p><strong>Ideally, you should have all the values that will be translated graphically within one, single object.</strong> You want to have an array of these objects that you will pass to the data method, and be able to write something like: </p>
<pre class="brush: jscript; title: ; notranslate" title="">svg.selectAll(&quot;circle&quot;).data(data).enter()
  .append(&quot;circle&quot;)
  .attr(&quot;cx&quot;,function(d) {return x(+d.GERD);})
  .attr(&quot;cy&quot;,function(d) {return y(+d.growth);})
  .attr(&quot;r&quot;,function(d) {return r(Math.sqrt(+d.population));})

  .style(&quot;fill&quot;,function(d) {return c(d.continent);})
  .style(&quot;opacity&quot;,function(d) {return o(+d.GDPcap);})</pre>
<p>Here, you have just one data source, which is much safer. </p>
<p>So if you&#8217;re thinking: I know, I should create a variable like this: </p>
<pre class="brush: jscript; title: ; notranslate" title="">var data=[
  {&quot;country&quot;:&quot;Australia&quot;,&quot;continent&quot;:&quot;Oceania&quot;,&quot;population&quot;:22319.07,&quot;GDPcap&quot;:40718.78167,&quot;GERD&quot;:2.21367,&quot;growth&quot;:2.48590317},
  {&quot;country&quot;:&quot;Austria&quot;,&quot;continent&quot;:&quot;Europe&quot;,&quot;population&quot;:8427.318,&quot;GDPcap&quot;:42118.46375,&quot;GERD&quot;:2.74826,&quot;growth&quot;:3.10741128},
  {&quot;country&quot;:&quot;Belgium&quot;,&quot;continent&quot;:&quot;Europe&quot;,&quot;population&quot;:10590.44,&quot;GDPcap&quot;:38809.66436,&quot;GERD&quot;:1.96158,&quot;growth&quot;:1.89308521},
  {&quot;country&quot;:&quot;Canada&quot;,&quot;continent&quot;:&quot;America&quot;,&quot;population&quot;:33909.7,&quot;GDPcap&quot;:39069.91407,&quot;GERD&quot;:1.80213,&quot;growth&quot;:3.21494841},
  {&quot;country&quot;:&quot;Chile&quot;,&quot;continent&quot;:&quot;America&quot;,&quot;population&quot;:17248.45,&quot;GDPcap&quot;:15106.73205,&quot;GERD&quot;:0.39451,&quot;growth&quot;:5.19813626},
  {&quot;country&quot;:&quot;Czech Republic&quot;,&quot;continent&quot;:&quot;Europe&quot;,&quot;population&quot;:10286.3,&quot;GDPcap&quot;:25956.76492,&quot;GERD&quot;:1.52652,&quot;growth&quot;:1.65489834},
  {&quot;country&quot;:&quot;Denmark&quot;,&quot;continent&quot;:&quot;Europe&quot;,&quot;population&quot;:5495.246,&quot;GDPcap&quot;:40169.83173,&quot;GERD&quot;:3.01937,&quot;growth&quot;:1.04974368},
  {&quot;country&quot;:&quot;Estonia&quot;,&quot;continent&quot;:&quot;Europe&quot;,&quot;population&quot;:1335.347,&quot;GDPcap&quot;:22403.02459,&quot;GERD&quot;:1.44122,&quot;growth&quot;:7.63563272},
  {&quot;country&quot;:&quot;Finland&quot;,&quot;continent&quot;:&quot;Europe&quot;,&quot;population&quot;:5366.482,&quot;GDPcap&quot;:37577.71225,&quot;GERD&quot;:3.84137,&quot;growth&quot;:2.85477157},
  {&quot;country&quot;:&quot;France&quot;,&quot;continent&quot;:&quot;Europe&quot;,&quot;population&quot;:62747.78,&quot;GDPcap&quot;:34147.98907,&quot;GERD&quot;:2.20646,&quot;growth&quot;:1.47996142},
  {&quot;country&quot;:&quot;Germany&quot;,&quot;continent&quot;:&quot;Europe&quot;,&quot;population&quot;:82852.47,&quot;GDPcap&quot;:39389.25874,&quot;GERD&quot;:2.78056,&quot;growth&quot;:2.99558644},
  {&quot;country&quot;:&quot;Greece&quot;,&quot;continent&quot;:&quot;Europe&quot;,&quot;population&quot;:11312.16,&quot;GDPcap&quot;:26878.00015,&quot;GERD&quot;:0.5921,&quot;growth&quot;:-6.90796403},
  {&quot;country&quot;:&quot;Hungary&quot;,&quot;continent&quot;:&quot;Europe&quot;,&quot;population&quot;:9993.116,&quot;GDPcap&quot;:21731.55484,&quot;GERD&quot;:1.14821,&quot;growth&quot;:1.69192342},
  {&quot;country&quot;:&quot;Iceland&quot;,&quot;continent&quot;:&quot;Europe&quot;,&quot;population&quot;:308.038,&quot;GDPcap&quot;:35641.55402,&quot;GERD&quot;:2.64107,&quot;growth&quot;:-3.99988322},
  {&quot;country&quot;:&quot;Ireland&quot;,&quot;continent&quot;:&quot;Europe&quot;,&quot;population&quot;:4394.382,&quot;GDPcap&quot;:40457.94273,&quot;GERD&quot;:1.78988,&quot;growth&quot;:-0.42935239},
  {&quot;country&quot;:&quot;Israel&quot;,&quot;continent&quot;:&quot;Asia&quot;,&quot;population&quot;:7623.6,&quot;GDPcap&quot;:28595.68799,&quot;GERD&quot;:4.2504,&quot;growth&quot;:4.84602001},
  {&quot;country&quot;:&quot;Italy&quot;,&quot;continent&quot;:&quot;Europe&quot;,&quot;population&quot;:59059.66,&quot;GDPcap&quot;:32580.06572,&quot;GERD&quot;:1.26841,&quot;growth&quot;:0.43108032},
  {&quot;country&quot;:&quot;Japan&quot;,&quot;continent&quot;:&quot;Asia&quot;,&quot;population&quot;:126912.8,&quot;GDPcap&quot;:33751.23348,&quot;GERD&quot;:3.33499,&quot;growth&quot;:3.96559062},
  {&quot;country&quot;:&quot;Korea&quot;,&quot;continent&quot;:&quot;Asia&quot;,&quot;population&quot;:48988.83,&quot;GDPcap&quot;:29101.34563,&quot;GERD&quot;:3.3609,&quot;growth&quot;:6.16184325},
  {&quot;country&quot;:&quot;Luxembourg&quot;,&quot;continent&quot;:&quot;Europe&quot;,&quot;population&quot;:483.701,&quot;GDPcap&quot;:86226.3276,&quot;GERD&quot;:1.67862,&quot;growth&quot;:2.67806902},
  {&quot;country&quot;:&quot;Mexico&quot;,&quot;continent&quot;:&quot;America&quot;,&quot;population&quot;:109219.9,&quot;GDPcap&quot;:15200.22119,&quot;GERD&quot;:0.41322,&quot;growth&quot;:5.56185685},
  {&quot;country&quot;:&quot;Netherlands&quot;,&quot;continent&quot;:&quot;Europe&quot;,&quot;population&quot;:16480.79,&quot;GDPcap&quot;:43455.30129,&quot;GERD&quot;:1.81965,&quot;growth&quot;:1.18517739},
  {&quot;country&quot;:&quot;New Zealand&quot;,&quot;continent&quot;:&quot;Oceania&quot;,&quot;population&quot;:4291.9,&quot;GDPcap&quot;:29870.67748,&quot;GERD&quot;:1.13693,&quot;growth&quot;:2.33052515},
  {&quot;country&quot;:&quot;Norway&quot;,&quot;continent&quot;:&quot;Europe&quot;,&quot;population&quot;:4789.628,&quot;GDPcap&quot;:57230.89,&quot;GERD&quot;:1.75922,&quot;growth&quot;:1.59773989},
  {&quot;country&quot;:&quot;Poland&quot;,&quot;continent&quot;:&quot;Europe&quot;,&quot;population&quot;:37725.21,&quot;GDPcap&quot;:19882.99226,&quot;GERD&quot;:0.67502,&quot;growth&quot;:4.34962928},
  {&quot;country&quot;:&quot;Portugal&quot;,&quot;continent&quot;:&quot;Europe&quot;,&quot;population&quot;:10684.97,&quot;GDPcap&quot;:25425.59561,&quot;GERD&quot;:1.65519,&quot;growth&quot;:-1.60958484},
  {&quot;country&quot;:&quot;Russian Federation&quot;,&quot;continent&quot;:&quot;Europe&quot;,&quot;population&quot;:142822.5,&quot;GDPcap&quot;:19833,&quot;GERD&quot;:1.24252,&quot;growth&quot;:4.03428262},
  {&quot;country&quot;:&quot;Slovak Republic&quot;,&quot;continent&quot;:&quot;Europe&quot;,&quot;population&quot;:5404.493,&quot;GDPcap&quot;:24429.61828,&quot;GERD&quot;:0.48056,&quot;growth&quot;:3.34920254},
  {&quot;country&quot;:&quot;Slovenia&quot;,&quot;continent&quot;:&quot;Europe&quot;,&quot;population&quot;:2029.418,&quot;GDPcap&quot;:27559.75186,&quot;GERD&quot;:1.85642,&quot;growth&quot;:-0.17459255},
  {&quot;country&quot;:&quot;South Africa&quot;,&quot;continent&quot;:&quot;Africa&quot;,&quot;population&quot;:50384.55,&quot;GDPcap&quot;:10497.583,&quot;GERD&quot;:0.92523,&quot;growth&quot;:2.784},
  {&quot;country&quot;:&quot;Spain&quot;,&quot;continent&quot;:&quot;Europe&quot;,&quot;population&quot;:44835.48,&quot;GDPcap&quot;:32779.3288,&quot;GERD&quot;:1.38357,&quot;growth&quot;:-0.06947685},
  {&quot;country&quot;:&quot;Sweden&quot;,&quot;continent&quot;:&quot;Europe&quot;,&quot;population&quot;:9276.365,&quot;GDPcap&quot;:41526.2995,&quot;GERD&quot;:3.61562,&quot;growth&quot;:3.93555895},
  {&quot;country&quot;:&quot;Switzerland&quot;,&quot;continent&quot;:&quot;Europe&quot;,&quot;population&quot;:7889.345,&quot;GDPcap&quot;:46621.77334,&quot;GERD&quot;:2.99525,&quot;growth&quot;:2.71404473},
  {&quot;country&quot;:&quot;Turkey&quot;,&quot;continent&quot;:&quot;Europe&quot;,&quot;population&quot;:73497,&quot;GDPcap&quot;:15666.18783,&quot;GERD&quot;:0.84902,&quot;growth&quot;:9.00558548},
  {&quot;country&quot;:&quot;United Kingdom&quot;,&quot;continent&quot;:&quot;Europe&quot;,&quot;population&quot;:62761.35,&quot;GDPcap&quot;:35715.4691,&quot;GERD&quot;:1.82434,&quot;growth&quot;:2.09209263},
  {&quot;country&quot;:&quot;United States&quot;,&quot;continent&quot;:&quot;America&quot;,&quot;population&quot;:313232,&quot;GDPcap&quot;:46587.61843,&quot;GERD&quot;:2.78518,&quot;growth&quot;:3.02171711}
]</pre>
<p>and get this done, and furthermore if you are thinking &#8220;Hey, I can do this in Excel from my csv file, with one formula that I will copy across the rows&#8221;, <strong>you need to stop right now in the name of all that is good and holy</strong>.<br />
Even though it works: </p>
<p><iframe src="https://jckr.github.io/blog/stuff/data%20example/data-example1.html" width=512px height=520px scrolling=no style="border:0px"></iframe><br />
<a href="http://jckr.github.io/blog/stuff/data%20example/data-example1.html">See example in its own tab or window</a></p>
<p>This approach has a number of flaws which you can all avoid if you read on.<br />
First, the execution of your program will be stopped while your browser reads the source code that contains the &#8220;data&#8221; variable. This is negligible for 36 rows, but as objects get bigger and more complex, an equivalent variable may take seconds or even minutes to load. And now we have a problem.<br />
That&#8217;s a problem for your users. Now to you: creating a JSON variable from tabular data is tedious and error prone. The formula editing interface in Excel doesn&#8217;t really help you spot where you have misplaced a quote or a colon. As a result, this is very time-consuming. </p>
<p>Don&#8217;t do that: there is a much simpler way.</p>
<p>Enters the d3.csv function.</p>
<pre class="brush: jscript; title: ; notranslate" title="">d3.csv(&quot;data.csv&quot;,function(csv) {
  // we first sort the data

  csv.sort(function(a,b) {return b.population-a.population;});

  // then we create the marks, which we put in an initial position

  svg.selectAll(&quot;circle&quot;).data(csv).enter()
    .append(&quot;circle&quot;)
    .attr(&quot;cx&quot;,function(d) {return x(0);})
    .attr(&quot;cy&quot;,function(d) {return y(0);})
    .attr(&quot;r&quot;,function(d) {return r(0);})

    .style(&quot;fill&quot;,function(d) {return c(d.continent);})
    .style(&quot;opacity&quot;,function(d) {return o(+d.GDPcap);})

      .append(&quot;title&quot;)
      .text(function(d) {return d.country;})
  
  // now we initiate - moving the marks to their position

  svg.selectAll(&quot;circle&quot;).transition().duration(1000)
    .attr(&quot;cx&quot;,function(d) {return x(+d.GERD);})
    .attr(&quot;cy&quot;,function(d) {return y(+d.growth);})
    .attr(&quot;r&quot;,function(d) {return r(Math.sqrt(+d.population));})
})</pre>
<p>Here&#8217;s how it works.<br />
You tell your d3.csv function the location of a csv file, (which we had all along) and a function that must run on the array of objects (what we always wanted) created by using the first row as keys.<br />
In other words, once inside the d3.csv function, the &#8220;csv&#8221; variable will be worth exactly what we assigned to &#8220;data&#8221; earlier, with one major difference, it&#8217;s that we didn&#8217;t have to manufacture this variable or do any kind of manual intervention: we are certain it corresponds to the file exactly. </p>
<p>One nice thing with this method is that since your variable is not explicitly in the source code, your browser can read it much faster. The data is only read when the d3.csv function is called, as opposed to the previous approach where the entirety of the source code (including the data) had to be read before the first statement could be executed. Of course, it only makes a difference when the data size is significant. But using the d3.csv approach would let you display a &#8220;loading data&#8221; warning somewhere on your page, and remove it when inside d3.csv. Much better than a blank page.</p>
<p>Three caveats with this method.</p>
<ul>
<li>This will no longer work in a local file system (ie opening a file in the browser). The resulting file can only run on a webserver, which can be local (ie the page has a url). </li>
<li>whatever happens within the d3.csv function is no longer in the global scope of the program. This means that after the program has run its course you cannot open the javascript console and inspect the value of &#8220;csv&#8221;, for instance. This makes these programs slightly more difficult to debug (there are obviously ways, though).</li>
<li>Everything read from the file is treated as strings. Javascript does a lot of type conversion but be mindful of that or you will have surprises. This is why I wrote x(+d.GERD) for instance (+ before a string converts it to a number).</li>
</ul>
<p>To celebrate this superior way of aquiring data, we&#8217;ve thrown in animated data entry: the circles are initiated at a default value and move towards their position. You may want to check the link to see the transition effect.</p>
<p><iframe src="https://jckr.github.io/blog/stuff/data%20example/data-example2.html" width=512px height=520px scrolling=no style="border:0px"></iframe><br />
<a href="http://jckr.github.io/blog/stuff/data%20example/data-example2.html">See example in its own tab or window</a></p>
<p>So, at the level of the mark (ie our circles) the most comfortable form of data is an object with at least as many keys as there will be graphical properties to change dynamically.<br />
One flat array of data is fine if we have just one series of data. But what if we have several series? Indeed, most visualizations have a structure and a hierarchy.<br />
So let&#8217;s proceed with our data but now let&#8217;s assume that we want to show values for different continents as different little scatterplots (&#8220;small multiples&#8221;).<br />
Intuitively:
<ul>
<li>we&#8217;ll want to add 5 &#8220;g&#8221; groups to our svg container, one for each continent,</li>
<li>and then add one dots per country in each continent to those groups.</li>
</ul>
<p>Our flat array won&#8217;t work so well then. What to do?</p>
<p>The d3 answer to this problem is the d3.nest() set of methods.<br />
d3.nest() turns a flat array of objects, which thanks to d3.csv() is a very easily available format, in an array of arrays with the hierarchy you need.<br />
Following our intuition, wouldn&#8217;t it be nice if our data would be: </p>
<ul>
<li>An array of 5 items, one for each continent, so we could create the &#8220;g&#8221; groups, </li>
<li>And if each of these 5 items contained an array with the data of all the corresponding countries, still in that object format that we love? </li>
</ul>
<p>This is exactly what d3.nest() does. d3.nest(), go!</p>
<pre class="brush: jscript; title: ; notranslate" title="">var data=d3.nest()
  .key(function(d) {return d.continent;})
  .sortKeys(d3.ascending)
  .entries(csv);</pre>
<p>With the .key() method, we are indicating what we will be using to create the hierarchy. We want to group those data by continent, so we use this syntax.<br />
.sortKeys is used to sort the keys in alphabetical order, so our panels appear in the alphabetical order of the continents. If we omit that, the panels will show up in the order of the data (ie Oceania first as Australia is the first country). We could have avoided that by sorting the data by continent first before nesting it, but it&#8217;s easier like this.<br />
Here, we just have one level of grouping, but we could have several by chaining several .key() methods.<br />
The last part of the statement, .entries(csv), says that we want to do that operation on our csv variable.</p>
<p>Here is what the data variable will look like: </p>
<pre class="brush: jscript; title: ; notranslate" title="">[
  {&quot;key&quot;:&quot;Africa&quot;,&quot;values&quot;:[...]},
  {&quot;key&quot;:&quot;America&quot;,&quot;values&quot;:[
    {&quot;country&quot;:&quot;United States&quot;,&quot;continent&quot;:&quot;America&quot;,&quot;population&quot;:&quot;313232&quot;,&quot;GDPcap&quot;:&quot;46587.61843&quot;,&quot;GERD&quot;:&quot;2.78518&quot;,&quot;growth&quot;:&quot;3.02171711&quot;},
     {&quot;country&quot;:&quot;Mexico&quot;,&quot;continent&quot;:&quot;America&quot;,&quot;population&quot;:&quot;109219.9&quot;,&quot;GDPcap&quot;:&quot;15200.22119&quot;,&quot;GERD&quot;:&quot;0.41322&quot;,&quot;growth&quot;:&quot;5.56185685&quot;},
      {&quot;country&quot;:&quot;Canada&quot;,&quot;continent&quot;:&quot;America&quot;,&quot;population&quot;:&quot;33909.7&quot;,&quot;GDPcap&quot;:&quot;39069.91407&quot;,&quot;GERD&quot;:&quot;1.80213&quot;,&quot;growth&quot;:&quot;3.21494841&quot;},      {&quot;country&quot;:&quot;Chile&quot;,&quot;continent&quot;:&quot;America&quot;,&quot;population&quot;:&quot;17248.45&quot;,&quot;GDPcap&quot;:&quot;15106.73205&quot;,&quot;GERD&quot;:&quot;0.39451&quot;,&quot;growth&quot;:&quot;5.19813626&quot;}
  ]
}, 
  {&quot;key&quot;:&quot;Asia&quot;,&quot;values&quot;:[...]},
  {&quot;key&quot;:&quot;Europe&quot;,&quot;values&quot;:[...]},
  {&quot;key&quot;:&quot;Oceania&quot;,&quot;values&quot;:[...]},
]</pre>
<p>Now that we have our data in an ideal form let&#8217;s draw those marks: </p>
<pre class="brush: jscript; title: ; notranslate" title="">  // One cell for each continent
  var g=svg.selectAll(&quot;g&quot;).data(data).enter()
    .append(&quot;g&quot;)
    .attr(&quot;transform&quot;,function(d,i) {return &quot;translate(&quot;+(100*i)+&quot;,0)&quot;;});
  // we add a rect element with a title element
  // so that mousing over the cell will tell us which continent it is
  g
    .append(&quot;rect&quot;)
    .attr(&quot;x&quot;,cmargin)
    .attr(&quot;y&quot;,cmargin)
    .attr(&quot;width&quot;,cwidth-2*cmargin)
    .attr(&quot;height&quot;,cheight-2*cmargin)
      .append(&quot;title&quot;)
      .text(function(d) {return d.key;})
  // we also write its name below.
  g
    .append(&quot;text&quot;)
    .attr(&quot;y&quot;,cheight+10)
    .attr(&quot;x&quot;,cmargin)
    .text(function(d) {return d.key;})
  
  // now marks, initiated to default values
  g.selectAll(&quot;circle&quot;)
  // we are getting the values of the countries like this:
  .data(function(d) {return d.values}) 
  .enter()
      .append(&quot;circle&quot;)
      .attr(&quot;cx&quot;,cmargin)
      .attr(&quot;cy&quot;,cheight-cmargin)
      .attr(&quot;r&quot;,1)
      // throwing in a title element
      .append(&quot;title&quot;)
        .text(function(d) {return d.country;});

  // finally, we animate our marks in position
  g.selectAll(&quot;circle&quot;).transition().duration(1000)
      .attr(&quot;r&quot;,3)
      .attr(&quot;cx&quot;,function(d) {return x(+d.GERD);})
      .attr(&quot;cy&quot;,function(d) {return y(+d.growth);})
      .style(&quot;opacity&quot;,function(d) {return o(d.population)})
      .style(&quot;opacity&quot;,function(d) {return o(+d.GDPcap);})</pre>
<p>(you may want to click on the link to see the transition effect and read the full source).<br />
<iframe src="https://jckr.github.io/blog/stuff/data%20example/data-example3.html" width=512px height=122px scrolling=no style="border:0px"></iframe><br />
<a href="http://jckr.github.io/blog/stuff/data%20example/data-example3.html">See example in its own tab or window</a></p>
<p>This is all very nice but wouldn&#8217;t it be better if we could characterize some aggregate information from the continents? Let&#8217;s try to find out the average values for R&#038;D expenditure and GDP growth. </p>
<p>Can it be done easily? This is a job for the other main d3.nest method, rollup.</p>
<p>rollup is the aggregating function. Here&#8217;s an example.</p>
<pre class="brush: jscript; title: ; notranslate" title="">var avgs=d3.nest()
    .key(function(d) {return d.continent;})
    .sortKeys(d3.ascending)
    .rollup(function(d) {
      return {
        GERD:d3.mean(d,function(g) {return +g.GERD;}),
        growth:d3.mean(d,function(g) {return +g.growth})
      };
    })
    .entries(csv);
</pre>
<p>Remember how the combination of .key() and .entries() rearranges an array into arrays of smaller arrays, depending on these keys? well, the value that is being passed to the function inside the rollup method is each of these arrays (ie an array of all the objects corresponding to countries in America, then an array of all the objects corresponding to countries in Europe, etc.)<br />
Also, if we use sortKeys in our previous nesting effort we&#8217;d better use it here too.<br />
Here is what the variable will look like: </p>
<pre class="brush: jscript; title: ; notranslate" title="">[
  {
    &quot;key&quot;:&quot;Africa&quot;,
    &quot;values&quot;:{
      &quot;GERD&quot;:0.92523,
      &quot;growth&quot;:2.784
    }
  },  
  {
    &quot;key&quot;:&quot;America&quot;,
    &quot;values&quot;:{
      &quot;GERD&quot;:1.34876,
      &quot;growth&quot;:4.2491646575
    }
  },
  {
    &quot;key&quot;:&quot;Asia&quot;,
    &quot;values&quot;:{
      &quot;GERD&quot;:3.6487633333333336,
      &quot;growth&quot;:4.991151293333334
    }
  },
  {
    &quot;key&quot;:&quot;Europe&quot;,
    &quot;values&quot;:{
      &quot;GERD&quot;:1.8769234615384616,
      &quot;growth&quot;:1.7901778096153846
    }
  },
  {
    &quot;key&quot;:&quot;Oceania&quot;,
    &quot;values&quot;:{
      &quot;GERD&quot;:1.6753,
      &quot;growth&quot;:2.40821416
    }
  }
]</pre>
<p>Incredible! just the values we need.<br />
Now it&#8217;s just a matter of adding them to the sketch. Two little additions here: </p>
<pre class="brush: jscript; title: ; notranslate" title="">// we add 2 lines for the average. They will start at a default value.
  g
    .append(&quot;line&quot;).classed(&quot;growth&quot;,1)
    .attr(&quot;x1&quot;,cmargin).attr(&quot;x2&quot;,cwidth-cmargin)
    .attr(&quot;y1&quot;,cheight-cmargin)
    .attr(&quot;y2&quot;,cheight-cmargin)
    // we give these lines a title for mouseover interaction.
      .append(&quot;title&quot;).text(function(d,i) {
        return &quot;Average growth:&quot;+avgs[i].values.growth
      });
  g.append(&quot;line&quot;).classed(&quot;GERD&quot;,1)
    .attr(&quot;y1&quot;,cmargin)
    .attr(&quot;y2&quot;,cheight-cmargin)
    .attr(&quot;x1&quot;,cmargin)
    .attr(&quot;x2&quot;,cmargin)
      .append(&quot;title&quot;).text(function(d,i) {
        return &quot;Average GERD:&quot;+avgs[i].values.GERD
      });

 ...
  // we also animate the lines
  g.select(&quot;.growth&quot;).transition().duration(1000)
    .attr(&quot;y1&quot;,function(d,i) {return y(avgs[i].values.growth);})
    .attr(&quot;y2&quot;,function(d,i) {return y(avgs[i].values.growth);})
  g.select(&quot;.GERD&quot;).transition().duration(1000)
    .attr(&quot;x1&quot;,function(d,i) {return x(avgs[i].values.GERD);})
    .attr(&quot;x2&quot;,function(d,i) {return x(avgs[i].values.GERD);})</pre>
<p>This is the final example &#8211; again you may want to click on the link to see the transition and get the entirety of the source.<br />
<iframe src="https://jckr.github.io/blog/stuff/data%20example/data-example4.html" width=512px height=122px scrolling=no style="border:0px"></iframe><br />
<a href="http://jckr.github.io/blog/stuff/data%20example/data-example4.html">See example in its own tab or window</a></p>
<p>To wrap up:</p>
<ul>
<li>At the mark level, you want to have objects with as many properties as you need graphical variables (like x,y, fill, etc.)</li>
<li>using d3.csv() and a flat file will make this easy (d3 also provides functions like d3.json or d3.xml to process data in another format).</li>
<li>d3.nest can help you group your entries to structure your data and create more sophisticated visualizations</li>
<li>rollup can be used to aggregate the data grouped using d3.nest</li>
</ul>
	    		<div class="clear">&nbsp;</div>
	</section>
</article><!-- #post-## -->
			
				
<article id="post-1297" class="post-1297 post type-post status-publish format-standard hentry category-d3 category-data-visualization category-tips">
		    <header class="post-header">
        			<span class="post-meta">
				<span class="posted-on"><a href="/blog/2012/05/24/making-of-the-map-of-congress-equality/" rel="bookmark"><time class="entry-date published" datetime="2012-05-24T12:36:37+00:00">May 24, 2012</time></a></span><span class="byline"> by <span class="author vcard"><a class="url fn n" href="/blog/author/jerome/">jerome</a></span></span> on <a href="/blog/category/d3/" rel="category tag">d3</a>, <a href="/blog/category/data-visualization/" rel="category tag">data visualization</a>, <a href="/blog/category/tips/" rel="category tag">tips</a>			</span>
		        <h1 class="post-title"><a href="/blog/2012/05/24/making-of-the-map-of-congress-equality/" rel="bookmark">Making-of: the map of congress equality</a></h1>
         
    </header>
	<section class="post-content">

		<p><div id="attachment_1290" style="width: 620px" class="wp-caption aligncenter"><a href="http://jckr.github.io/blog/projects/elections/parite.html"><img class="size-full wp-image-1290" title="La parité, c'est maintenant" src="https://jckr.github.io/blog/wp-content/uploads/2012/05/parite.png" alt="" width="610" height="572" /></a><p class="wp-caption-text">It&#39;s all about this map (click for interactive version)</p></div></p>
<p>To my datavis readers, sorry for that string of posts in French but what better data to visualize than political data, and what better time to visualize political data than election time, and what better audience for such visualizations than the folks who are asked to vote?</p>
<p><a href="http://jckr.github.io/blog/blog/2012/05/15/making-of-cutting-paris-in-voting-districts/">Like last time</a>, though, I am writing a follow-up technical post about how I dealt with the issues of this visualization.</p>
<p>So anyone who ever tried to make data visualizations knows that you can hardly start without <strong>data</strong>.</p>
<p>My ingredients for the recipe were:</p>
<p>2012 presidential election results <a href="http://www.data.gouv.fr/donnees/view/Pr%C3%A9sidentielle-2012%2C-r%C3%A9sultats-par-circonscriptions-l%C3%A9gislatives%2C-2%C3%A8me-tour-551768?xtmc=presidentielle+circonscription&amp;xtcr=4">by circonscription</a>, plus those <a href="http://www.data.gouv.fr/donnees/view/R%C3%A9sultats-par-circonscription-%C3%A9lection-pr%C3%A9sidentielle-2007---Tours-1-et-2-30379819?xtmc=presidentielle+circonscription&amp;xtcr=1">of 2007</a>.</p>
<p>Results of the <a href="http://www.data.gouv.fr/donnees/view/R%C3%A9sultats-par-circonscription-%C3%A9lections-l%C3%A9gislatives-2007---Tour-1-383529">previous</a> <a href="http://www.data.gouv.fr/donnees/view/R%C3%A9sultats-par-circonscription-%C3%A9lections-l%C3%A9gislatives-2007---Tour-2-383531">congressional </a>election. There were 2 files, one per round, as opposed to a flat file of <em>députés </em>in place (I didn&#8217;t find one that didn&#8217;t required some significant editing to be of use). Most importantly, I needed their political orientation which required some tweaking.</p>
<p>Matching tables between <a href="http://www.data.gouv.fr/donnees/view/Table-de-correspondance-des-communes-et-des-cantons-avec-les-circonscriptions-l%C3%A9gislat-551418?xtmc=communes+circonscription&amp;xtcr=1">circonscriptions and cities</a>.  From a previous project, presidential election data at the city level. Also, <a href="http://professionnels.ign.fr/ficheProduitCMS.do?idDoc=5323862">geo coordinates of the cities</a>.</p>
<p>The data which was most painful to extract was the list of candidates. In all fairness, UMP made it easier than PS as they had them all on <a href="http://www.u-m-p.org/actualites/a-la-une/candidats-investis-ou-soutenus-par-le-conseil-national-de-lump-du-4982102">a page</a>. For PS, they had a google fusion table which had <a href="https://www.google.com/fusiontables/DataSource?docid=14Nu51pqxD4PmZd8FlcSqQNruHR1yfZgg0QJwe_A">this</a> as a data source. That file required a lot of massaging. Eventually local pages of the PS site would list the candidates missing from the map (or provide alternate names). When it was up, I also used the <a href="http://www.elections-legislatives.fr/">http://www.elections-legislatives.fr/</a> site to check for the missing names.</p>
<p>Finally, I figured out the genders of all the candidates by extracting their first name and looking up all the ones I wasn&#8217;t sure about (there are quite a few unisex first names in French).</p>
<p>Now <strong>calculations</strong>.</p>
<p>There is a pretty strong statistical link between the score of a party on an election in a certain territory, and the chances of a congress candidate of the same party of winning the district.</p>
<p>Predicting these chances is a well-known problem known as <em>classification </em> for which the textbook method is <em>logistic regression.</em></p>
<p>All we need was the 575 districts for which I had results. We then associate the score of a party at the 2nd round of the election to whether the corresponding congress candidate got elected (1 or 0). That gives us <a href="http://jckr.github.io/blog/projects/elections/deputes.txt">1150 pairs of values</a> which we throw in the mathematical cooking pot.</p>
<p>And what we get is the following formula:</p>
<p><a href="http://jckr.github.io/blog/wp-content/uploads/2012/05/equation.png"><img class="aligncenter size-full wp-image-1305" title="equation" src="https://jckr.github.io/blog/wp-content/uploads/2012/05/equation.png" alt="" width="297" height="66" /></a></p>
<p>where x is the score in the previous election (between 0 and 1).  As you can see when x gets close to 0, the denominator becomes a very large number and the probability quickly drops to virtually nothing, and converserly when x gets close to 1, the denominator becomes very close to 1 so the probability rises up to 1 equally fast.</p>
<p><iframe style="border: none;" src="https://jckr.github.io/blog/stuff/littlesigmoid.html" scrolling="no" width="502px" height="270px"></iframe></p>
<p>With this and that in place, it is possible to come up with a <a href="http://jckr.github.io/blog/projects/elections/pariteFM.csv">reasonable estimation</a> of the chances of any candidate based on the recent results. As an aside, the current Prime Minister has renewed the tradition started by his predecessor to ask ministers to seek office and to force them to step down if they fail to win their district. As a result, 24 out of the 37 ministers are campaigning. Out of those 24, 2 are taking very serious risks according to this model: Marie-Anne Carlotti and Benoît Hamon.</p>
<p>Finally, <strong>geography</strong>.</p>
<p>In an ideal world, there will be an abundance of geoJSON files describing France and its many administrative entities. Usable data must exist somewhere, because the maps on <a href="view-source:http://www.elections-legislatives.fr/candidats.asp">www.elections-legislatives.fr</a> have all been generated (by Raphael.js says the source code). If I&#8217;m doing another project on these elections I might reverse engineer the shape of the maps to extract the coordinates.</p>
<p>Without a dataset, the work of drawing the boundaries of 577 districts is just huge. However, accuracy is not required as I&#8217;m only putting the districts on a map so people can look up where they live or places they know. <a href="http://jckr.github.io/blog/blog/2012/05/15/making-of-cutt…ting-districts/">In my previous work</a> in order to let users change the composition of the districts, I wanted to be rigorous in the placement of everything but here we can live with imperfection.</p>
<p>So I am using the same <a href="http://jckr.github.io/blog/blog/2012/05/15/making-of-cutt…ting-districts/">principle as I did</a>: voronoi tesselation.</p>
<p>For each district I am picking the largest city, for which I have the coordinates. But most large cities belong to several districts. So I am adding random noise to each point. Then, I am drawing shapes around them.</p>
<p><iframe style="border: none;" src="https://jckr.github.io/blog/stuff/littlevoronoi.html" scrolling="no" width="502px" height="270px"></iframe></p>
<p>That would normally fill a rectangle, so in order to make it look like France, I have drawn a <a href="http://commons.oreilly.com/wiki/index.php/SVG_Essentials/Clipping_and_Masking">clipping mask</a> on top of it (that, I&#8217;ve done by hand, picking coordinates of the outline of France).</p>
<p>That about wraps it up!</p>
	    		<div class="clear">&nbsp;</div>
	</section>
</article><!-- #post-## -->
			
				
<article id="post-1289" class="post-1289 post type-post status-publish format-standard hentry category-d3 category-data-visualization category-francais">
		    <header class="post-header">
        			<span class="post-meta">
				<span class="posted-on"><a href="/blog/2012/05/23/la-parite-cest-maintenant/" rel="bookmark"><time class="entry-date published" datetime="2012-05-23T17:56:51+00:00">May 23, 2012</time></a></span><span class="byline"> by <span class="author vcard"><a class="url fn n" href="/blog/author/jerome/">jerome</a></span></span> on <a href="/blog/category/d3/" rel="category tag">d3</a>, <a href="/blog/category/data-visualization/" rel="category tag">data visualization</a>, <a href="/blog/category/francais/" rel="category tag">français</a>			</span>
		        <h1 class="post-title"><a href="/blog/2012/05/23/la-parite-cest-maintenant/" rel="bookmark">La parité, c&#8217;est maintenant?</a></h1>
         
    </header>
	<section class="post-content">

		<p><div id="attachment_1290" style="width: 620px" class="wp-caption aligncenter"><a href="http://jckr.github.io/blog/projects/elections/parite.html"><img class="size-full wp-image-1290" title="La parité, c'est maintenant" src="https://jckr.github.io/blog/wp-content/uploads/2012/05/parite.png" alt="" width="610" height="572" /></a><p class="wp-caption-text">Cliquez sur l&#39;image pour arriver à l&#39;application interactive</p></div></p>
<p>J&#8217;ai eu l&#8217;idée de créer cette carte quand j&#8217;ai pu mettre la main sur les données des résultats de la présidentielle par circonscription législative. En 2007, les résulats du deuxième tour ont été un très bon prédicteur de ceux des législatives qui ont suivi: une circonscription pour qui un candidat à la présidentielle au second tour a fait ne serait-ce que 52% a plus de 75% de chances d&#8217;être remportée par le député du même parti.<br />
Et encore, tout le monde s&#8217;était accordé à dire qu&#8217;en 2007, la gauche avait fait une très bonne campagne et qu&#8217;elle avait <a href="http://www.rfi.fr/actufr/articles/090/article_52924.asp">endigué la vague bleue</a>. Les probabilités sont sûrement encore plus élevées.</p>
<p>Or, presque 80% des circonscriptions ont été gagnées avec un score supérieur à 52%, ce qui est donc une très grosse marge. Dans plus du quart d&#8217;entre elles, le gagnant du scrutin a même récolté plus de 60% des voix&#8230;</p>
<p>Bref. Dans la plupart des circonscriptions, il n&#8217;y aura pas tellement de suspsens. Là où je vote, on n&#8217;a pas souvent le droit à un deuxième tour.</p>
<p>Comme pour<a href="http://jckr.github.io/blog/blog/2012/05/15/le-decoupage-de-paris-en-circonscriptions/"> le découpage électoral</a>, je trouve ça un peu dérangeant. L&#8217;élection n&#8217;est pas tant la rencontre entre une personne et une population qui la choisit, mais surtout le fait d&#8217;un parti qui place ses pions, surtout si on rajoute les &#8220;accords électoraux&#8221;. Je crois que j&#8217;ai moins de chance de rencontrer la candidate <em>challenger</em> de ma circonscription que de voir François Hollande ou Nicolas Sarkozy &#8220;en vrai&#8221;.</p>
<p>Alors pourquoi ne pas en profiter pour s&#8217;approcher de la parité à l&#8217;assemblée?</p>
<p>Pourquoi ne pas le faire d&#8217;abord: si un parti ne présente pas autant de femmes que d&#8217;hommes, il récupère une amende. Ou plutôt, comme l&#8217;explique bien <a href="http://www.lemonde.fr/politique/article/2012/05/22/les-manquements-a-la-parite-coutent-cher-aux-partis_1705246_823448.html">Alexandre Léchenet</a>,  il perd des financements. Mais le mode de calcul est biaisé. Un parti récupère une certaine somme par voix  au niveau national, puis cette somme est minorée si les femmes représentent moins de la moitié des candidats. Pour contrer ce système, il aurait été plus judicieux de le baser sur la proportion des voix <em>remportées</em> par des femmes, pas sur celles qu&#8217;on a alignées au départ.</p>
<p>Donc, on envoie les femmes au casse-pipe: on les met dans des circonscriptions impossibles à gagner, histoire d&#8217;éviter l&#8217;amende. Il y a presque 100 candidates qui se retrouvent contre le représentant d&#8217;un parti qui a fait plus de 55% au second tour.</p>
<p>A Paris, par exemple, Annie Novelli défie Claude Goasguen dans la 14ème circonscription (qui a voté à 77% pour Sarkozy) et c&#8217;est Agnès Pannier qui affronte Bernard Debré dans la 4ème (75% pour Sarkozy). Pendant ce temps, Roxane Decorte se frotte à Daniel Vaillant dans la 17ème circonscription (qui a voté Hollande à 72%).</p>
<p>Et encore, en théorie elles pourraient gagner, mais dans 238 circonscriptions, soit plus de 40%, ni le PS ni l&#8217;UMP n&#8217;ont investi de femme, comme ça on est tranquille.</p>
<p>Ce qui fait qu&#8217;au final, même s&#8217;il y a 40% de candidates, le nombre d&#8217;élues devrait tourner autour de 175 soit 28%. Ce serait quand même presque 70 de plus qu&#8217;aujourd&#8217;hui, malgré le cynisme de l&#8217;actuel patron de l&#8217;UMP. Espérons qu&#8217;elle pourront aller à l&#8217;Assemblée<a href="http://www.lemonde.fr/politique/article/2011/06/07/l-assemblee-se-defend-d-etre-un-bastion-du-sexisme_1533148_823448.html"> habillées comme elles veulent</a>.</p>
<p><a href="http://www.insee.fr/fr/themes/tableau.asp?reg_id=0&amp;ref_id=NATnon02145">Mine de rien</a>, il y aurait 51.5% de femmes en France.</p>
	    		<div class="clear">&nbsp;</div>
	</section>
</article><!-- #post-## -->
			
				
<article id="post-1277" class="post-1277 post type-post status-publish format-standard hentry category-d3 category-data-visualization category-tips">
		    <header class="post-header">
        			<span class="post-meta">
				<span class="posted-on"><a href="/blog/2012/05/15/making-of-cutting-paris-in-voting-districts/" rel="bookmark"><time class="entry-date published" datetime="2012-05-15T15:33:44+00:00">May 15, 2012</time></a></span><span class="byline"> by <span class="author vcard"><a class="url fn n" href="/blog/author/jerome/">jerome</a></span></span> on <a href="/blog/category/d3/" rel="category tag">d3</a>, <a href="/blog/category/data-visualization/" rel="category tag">data visualization</a>, <a href="/blog/category/tips/" rel="category tag">tips</a>			</span>
		        <h1 class="post-title"><a href="/blog/2012/05/15/making-of-cutting-paris-in-voting-districts/" rel="bookmark">Making-of: cutting Paris in voting districts</a></h1>
         
    </header>
	<section class="post-content">

		<p>Hi, in my previous post I showcased <a href="http://jckr.github.io/blog/projects/elections/circonscriptions.html#">one of my recent projects</a>. I really enjoyed building it and so would like to share how this has been done.</p>
<p>First, getting the data. I already scraped the results of both rounds of the presidential election by city. The districts for the congress election are also known, but it&#8217;s not possible to do a match, because large cities are almost systematically broken down into several such districts. Paris, for instance, will be represented by no less than 18 <em>députés</em>.</p>
<p>So I needed the results by the finest possible unit, that is by individual polling station. During the election night these results are compiled by city and centralized, so you would assume that the raw data of each polling station is available somewhere. That is not the case, unfortunately. Although it seems that they will be made public eventually, that may not be the case before the June 2012 election.</p>
<p>Fortunately, <a href="http://opendata.paris.fr/opendata/jsp/site/Portal.jsp?document_id=133&amp;portlet_id=102">Open Data Paris</a> had the results by polling station. More: it had their address and matching of every inhabited building in Paris to its corresponding polling station.</p>
<p>To map the polling stations, my first intuition was to create a <a href="http://en.wikipedia.org/wiki/Voronoi_diagram">voronoi tesselation</a> of their projected, geocoded coordinates (I only had their addresses in the raw data file). In short, voronoi polygons can be generated for a certain number of control points and correspond to the area nearer to that control point than to any other. So it&#8217;s a good approximation of the areas  which correspond to a given polling station.</p>
<p><iframe style="border:none;" src="https://jckr.github.io/blog/stuff/littlevoronoi.html" scrolling="no" width="502px" height="270px"></iframe></p>
<p>Problem: several polling stations could be in the same address, and for the voronoi algorithm the control points have to be distinct. So I tried jittering them (adding random noise to each one). A tesselation could be done that kind of looked like Paris but voting districts will look messy as there were frequent inversions between neighboring districts.</p>
<p>So I had to come up with a better approximation of what part of the city corresponded to what voting district. So I used the address to polling station correspondance, and for each polling station I took the first and the last street number of any street that was covered by it. Then I geocoded the whole lot. That&#8217;s about 16000 points. It took some time.</p>
<p><div id="attachment_1280" style="width: 616px" class="wp-caption aligncenter"><a href="http://jckr.github.io/blog/wp-content/uploads/2012/05/centroids.png"><img class="wp-image-1280" title="centroids" src="https://jckr.github.io/blog/wp-content/uploads/2012/05/centroids.png" alt="" width="606" height="478" /></a><p class="wp-caption-text">Here&#39;s my polling station as an example.</p></div></p>
<p>Then, for each polling station area, I took the minimum and maximum longitude and latitude, which formed a bounding box, and assigned the polling station to the center of that box. Then, I used tesselation again.</p>
<p>I found a number of oddities in the geocoding that I had to correct manually, because if one address was not accurately coded, chances are it would change the shape of the bounding box drastically and so the position of its corresponding polling station. Sometimes the geocoding service wouldn&#8217;t find the street and/or would use a street of the same name in another city, sometimes they did find the street but the coordinates were way off&#8230; So the dataset required a lot of massaging before it got into shape.</p>
<p>The last geographic errand I had to do for this visualization was to create a perimeter of Paris to use as a clipping mask, else the tesselation would be done on a rectangular shape with the edge polygons being very large and very skewed. So I collected coordinates of points around Paris to create one polygon. Only what&#8217;s inside of this polygon is shown (.style(&#8220;clip-path&#8221;) in d3).</p>
<p>After the data has been acquired, the building of the rest of the datavis was nothing special. I have used extensively mouseover and click events to trigger transformations as I always do, although this time I did prepare a lot of rules.</p>
<p>Originally I wanted to make the whole of France like this, though it will be difficult: one, to get the data, and two, to get it into shape. As of today the location (i.e. street address) of most of the polling stations is not available online, so even if we got the number of votes for each of the polling stations (there should be about 40000 of them) the geographic part of the problem will remain unsolved. Though, it&#8217;s a worthy endeavour. While the election results have little interest at a macro-geographic level &#8211; by region or by <em>département &#8211; </em>they are very useful at a very fine level as strategies can be constructed.</p>
<p>For instance, it&#8217;s worthwhile to send heavyweights to conquer districts that are winnable, but it&#8217;s a waste to keep them in their respective fiefdoms if victory in these districts is already certain. Also, when districts would have to be redefined, having this kind of information can be invaluable to the political force which gets to draw their new limits, or to their opponents.</p>
	    		<div class="clear">&nbsp;</div>
	</section>
</article><!-- #post-## -->
			
				
<article id="post-1273" class="post-1273 post type-post status-publish format-standard hentry category-data-visualization category-francais">
		    <header class="post-header">
        			<span class="post-meta">
				<span class="posted-on"><a href="/blog/2012/05/15/le-decoupage-de-paris-en-circonscriptions/" rel="bookmark"><time class="entry-date published" datetime="2012-05-15T15:33:18+00:00">May 15, 2012</time></a></span><span class="byline"> by <span class="author vcard"><a class="url fn n" href="/blog/author/jerome/">jerome</a></span></span> on <a href="/blog/category/data-visualization/" rel="category tag">data visualization</a>, <a href="/blog/category/francais/" rel="category tag">français</a>			</span>
		        <h1 class="post-title"><a href="/blog/2012/05/15/le-decoupage-de-paris-en-circonscriptions/" rel="bookmark">Le découpage de Paris en circonscriptions</a></h1>
         
    </header>
	<section class="post-content">

		<p>Mon <a href="http://jckr.github.io/blog/projects/elections/circonscriptions.html">dernier projet</a> permet de voir les résultats des élections présidentielles à Paris par bureau de vote et de les projeter sur les circonscriptions qui serviront aux élections législatives de juin 2012.</p>
<p><a href="http://jckr.github.io/blog/projects/elections/circonscriptions.html"><img class="aligncenter size-full wp-image-1274" title="votes" src="https://jckr.github.io/blog/wp-content/uploads/2012/05/votes.jpg" alt="" width="556" height="385" /></a>Et surtout il permet de changer la composition de ces circonscriptions, dont le tracé aujourd&#8217;hui est assez arbitraire. Il y aura 18 circonscriptions à Paris contre 21 aujourd&#8217;hui, et elles ne suivent pas les arrondissements.</p>
<p>Le tracé de ces circonscriptions est déterminant pour le résultat des élections. Aujourd&#8217;hui, par exemple, il y a deux circonscriptions où Nicolas Sarkozy a récupéré plus de 75% des voix au 2ème tour de l&#8217;élection présidentielle, j&#8217;imagine que la gauche ne place pas trop d&#8217;espoir sur leur reconquête. De même, il existe pas moins de 9 circonscriptions où François Hollande a reçu plus de 60% des votes. En l&#8217;état actuel des choses, 12 circonscriptions semblent acquises à la gauche et 6 à la droite, dont 3 pourraient peut-être quand même être gagnées par la gauche.</p>
<p>Le découpage actuel n&#8217;est optimum ni pour la gauche, ni pour la droite. En modifiant le tracé des circonscriptions, la gauche pourrait toutes les remporter, et la droite pourrait en gagner 12 sur 18 (ou peut-être plus, 12 restant mon <em>high-score</em> personnel). Pour favoriser un camp, l&#8217;idée consiste à répartir les bureaux de votes les plus favorables entre le plus de circonscriptions possibles, plutôt que de les garder dans peu de circonscriptions. En généralisant sur le territoire, on imagine ce que ça peut donner!</p>
<p>Donc, quelque soit le sentiment actuel, tel ou tel redécoupage peut complètement redistribuer les cartes. C&#8217;est un sentiment dérangeant parce que ces redécoupages arrivent régulièrement et sont relativement opaques. D&#8217;ailleurs, il est assez difficile de faire le lien entre les données des élections présidentielles et les circonscriptions législatives parce que les résultats ne sont que rarement disponibles par bureau de vote.</p>
<p>Je donnerai les détails techniques de l&#8217;implémentation dans un futur post.</p>
	    		<div class="clear">&nbsp;</div>
	</section>
</article><!-- #post-## -->
			
				
<article id="post-1264" class="post-1264 post type-post status-publish format-standard hentry category-d3 category-data-visualization category-francais tag-coordonnees-paralleles tag-elections">
		    <header class="post-header">
        			<span class="post-meta">
				<span class="posted-on"><a href="/blog/2012/05/07/a-la-decouverte-des-resultats-des-presidentielles-avec-les-coordonnees-paralleles/" rel="bookmark"><time class="entry-date published" datetime="2012-05-07T19:20:39+00:00">May 7, 2012</time></a></span><span class="byline"> by <span class="author vcard"><a class="url fn n" href="/blog/author/jerome/">jerome</a></span></span> on <a href="/blog/category/d3/" rel="category tag">d3</a>, <a href="/blog/category/data-visualization/" rel="category tag">data visualization</a>, <a href="/blog/category/francais/" rel="category tag">français</a>			</span>
		        <h1 class="post-title"><a href="/blog/2012/05/07/a-la-decouverte-des-resultats-des-presidentielles-avec-les-coordonnees-paralleles/" rel="bookmark">À la découverte des résultats des présidentielles avec les coordonnées parallèles</a></h1>
         
    </header>
	<section class="post-content">

		<p style="text-align: center;"><a href="http://jckr.github.io/blog/projects/elections/dtour2012.html"><img class="aligncenter size-full wp-image-1265" title="front" src="https://jckr.github.io/blog/wp-content/uploads/2012/05/front.jpg" alt="" width="700" height="374" /></a></p>
<p>Qui dit élection présidentielle, dit résultats.</p>
<p>Et qui dit résultats dit représentation visuelle dans les médias.</p>
<p>Et donc souvent carte.</p>
<p>Cela dit, une carte ne nous apprend pas grand chose de ce qui s&#8217;est vraiment passé dans une élection. C&#8217;est vrai que c&#8217;est utile pour retrouver sa région ou sa ville, mais les résultats de deux villes proches géographiquement (par exemple, Boulogne-Billancourt et Issy-les-Moulineaux) n&#8217;a strictement rien à voir.</p>
<p>En revanche, avec une carte c&#8217;est très difficile de répondre à certaines questions, comme: où a-t-on le plus voté pour Nicolas Sarkozy? Qu&#8217;est ce qui s&#8217;est passé dans les villes qui ont beaucoup voté pour Marine Le Pen ou François Bayrou? D&#8217;où vient l&#8217;explosion du vote blanc au deuxième tour?</p>
<p>Pour répondre à ces questions, on peut utiliser les <a href="http://jckr.github.io/blog/projects/elections/dtour2012.html">coordonnées parallèles</a>.</p>
<p>Chaque axe vertical correspond à un vote possible &#8211; d&#8217;abord ceux du premier tour, puis ceux du deuxième. Chaque ligne de couleur correspond à une ville (ou à un département, à une région, ou à la France). Chacune de ces lignes coupe chaque axe à une hauteur qui correspond à la proportion des gens qui ont fait tel ou tel choix. Par exemple, les villes où on a beaucoup voté pour Jean-Luc Mélenchon, comme Bagnolet ou Gennevilliers, se retrouveront vers le haut de l&#8217;axe du milieu.</p>
<p>En s&#8217;approchant des axes, le curseur devient une croix. Il suffit alors de le faire glisser le long de l&#8217;axe pour dessiner un rectangle, et mettre en valeur toutes les lignes qui passent par ce rectangle. Par exemple, voici les villes qui ont donné plus de 70% de leurs voix du second tour à François Hollande:</p>
<p><a href="http://jckr.github.io/blog/projects/elections/dtour2012.html"><img class="aligncenter size-full wp-image-1266" title="hollande70" src="https://jckr.github.io/blog/wp-content/uploads/2012/05/hollande70.jpg" alt="" width="700" height="500" /></a></p>
<p>&nbsp;</p>
<p>On peut tracer autant de rectangles qu&#8217;on veut. Par exemple, on peut ne garder que les endroits qui avaient soutenu Bayrou (par exemple à plus de 10%).</p>
<p><a href="http://jckr.github.io/blog/projects/elections/dtour2012.html"><img class="aligncenter size-full wp-image-1267" title="hollande70bayrou10" src="https://jckr.github.io/blog/wp-content/uploads/2012/05/hollande70bayrou10.jpg" alt="" width="700" height="500" /></a></p>
<p>et voilà: il n&#8217;y en a plus que 2.</p>
<p>Pour supprimer une sélection, il suffit de cliquer près de l&#8217;axe sans glisser. Si on clique sur un rectangle, on peut aussi le faire coulisser le long de l&#8217;axe.</p>
<p>Avec cette technique, on peut tout de suite voir les fiefs de tel ou tel candidat: il s&#8217;agit des lignes qui touchent le haut du graphique.</p>
<p>On peut répondre à des questions plus complexes. Par exemple, je parlais de l&#8217;explosion du vote blanc au deuxième tour. Que s&#8217;est-il passé?</p>
<p>Sélectionnons les endroits où le vote blanc a dépassé les 4% au deuxième tour, tout en restant à moins de 1.5% au premier tour:</p>
<p><a href="http://jckr.github.io/blog/projects/elections/dtour2012.html"><img class="aligncenter size-full wp-image-1268" title="blanc" src="https://jckr.github.io/blog/wp-content/uploads/2012/05/blanc.jpg" alt="" width="700" height="370" /></a></p>
<p>On voit trois pics: les villes où Marine Le Pen, Jean-Luc Mélenchon ou François Bayrou ont fait un très gros score. On peut continuer à sélectionner et voir que ce sont bien les villes qui sont dans la pointe de l&#8217;un des trois triangles et pas celles qui passent par le bas qui se retrouvent dans ce cas de figure. Ces électeurs ont préféré voter blanc plutôt que de choisir.</p>
<p>Bonne exploration!</p>
<p><a href="http://jckr.github.io/blog/projects/elections/dtour2012.html">http://jckr.github.io/blog/projects/elections/dtour2012.html</a></p>
	    		<div class="clear">&nbsp;</div>
	</section>
</article><!-- #post-## -->
			
				
<article id="post-1255" class="post-1255 post type-post status-publish format-standard hentry category-conferences tag-datavis tag-see-conference tag-see tag-wiesbaden">
		    <header class="post-header">
        			<span class="post-meta">
				<span class="posted-on"><a href="/blog/2012/05/07/see7-conference/" rel="bookmark"><time class="entry-date published" datetime="2012-05-07T18:43:12+00:00">May 7, 2012</time></a></span><span class="byline"> by <span class="author vcard"><a class="url fn n" href="/blog/author/jerome/">jerome</a></span></span> on <a href="/blog/category/conferences/" rel="category tag">conferences</a>			</span>
		        <h1 class="post-title"><a href="/blog/2012/05/07/see7-conference/" rel="bookmark">See#7 conference</a></h1>
         
    </header>
	<section class="post-content">

		<p><a href="http://jckr.github.io/blog/wp-content/uploads/2012/05/into-eternity-poster.jpg"><br />
</a>Last week, I had the privilege to attend the <a href="http://see-conference.com/">See#7 conference</a> in Wiesbaden. I wrote a <a href="/blog/2012/05/03/impressions-from-wiesbaden/">quick post</a> summarizing the immediate feelings I had on my way back so here&#8217;s a more detailed follow-up.</p>
<p>Three things to know about the conference. It&#8217;s one of the main events on visualization in Europe. The main event takes place in a church which sits hundreds.</p>
<p><a href="http://farm8.staticflickr.com/7211/7135484013_0d34768b01_z.jpg"><img class="aligncenter" src="http://farm8.staticflickr.com/7211/7135484013_0d34768b01_z.jpg" alt="" width="640" height="427" /></a></p>
<p>Also, the conference is not called <em>die Konferenz zur Visualisierung von Information</em> for no reason. It&#8217;s mostly German-centric.</p>
<p>Finally, the conference&#8217;s approach to talking about visualization is to offer some height of view by inviting experts who do not work in information visualization proper but offer an interesting perspective to the field from their point of view.</p>
<p>Videos from all talks will be made available shortly.</p>
<p>The first speaker was Dr Thomas Henningsen from Greenpeace and was about how the organization is using visual impact for their agenda. Greenpeace goes indeed to considerable lengths to take the one picture that shows that what they are fighting is not an abstract possibility but something very tangible. Sometimes they create the picture as in this example,</p>
<p><a href="http://www.faz.net/polopoly_fs/1.929590!/image/2064909508.jpg_gen/derivatives/default/2064909508.jpg"><img class="aligncenter" src="http://www.faz.net/polopoly_fs/1.929590!/image/2064909508.jpg_gen/derivatives/default/2064909508.jpg" alt="&quot;If the planet were a bank, you would have saved it long ago&quot;" width="552" height="357" /></a></p>
<p>sometimes they capture a certain moment, but they also use charts and data to make their point.</p>
<p>Next was Prof. Dr. Norbert Bolz. From the opinion of many of the native German speakers I heard this was the highlight of the day. As my German is somewhat rusty and as he didn&#8217;t use visual aides I admit I missed a lot of it. Prof. Bolz is presented on the see conference site as a media scholar and many of his books were on display at the conference. His talk was on how can one inform and be memorable through images. So here are parts I grabbed. To be remarkable a piece of information has to be new, it has to be on something that the reader didn&#8217;t know. This is very different from being important. A lot of the talk was also about the memorable faculty of images (Prägnanz), that images can&#8217;t be cancelled.</p>
<p>The next speaker was <a href="http://itsbeenreal.co.uk/">Stefanie Posavec</a> who describes herself as a data illustrator. Like most people, you may think of data visualization  as a supervised but automated process by which a computer generates an image based on data and a set of rules. Then, enters the data illustrator, who works entirely by hand.</p>
<p>Perhaps Stefanie&#8217;s best-known work is the representation she&#8217;s done of Kerouac&#8217;s<em> On the Road</em>:</p>
<p><a href="http://www.itsbeenreal.co.uk/files/lrg-literary-organism-poste.jpg"><img class="aligncenter" src="http://www.itsbeenreal.co.uk/files/lrg-literary-organism-poste.jpg" alt="" width="600" height="849" /></a></p>
<p>which most people assume is a fine example of generative art. Wrong: every. single. element. is. placed. by. hand.</p>
<p>Stefanie took us through her project and shared how she works, how she collects data and encodes it (she did bring a computer).</p>
<p><a href="http://jckr.github.io/blog/wp-content/uploads/2012/05/stefanie1.jpg"><img class="size-full wp-image-1258 aligncenter" title="stefanie" src="https://jckr.github.io/blog/wp-content/uploads/2012/05/stefanie1.jpg" alt="" width="600" height="450" /></a></p>
<p>Here&#8217;s a picture I took at the workshop the next day along with some of her sketches.</p>
<p>Stefanie always seems to be apologetic that she does not write code which is ironic considering that this approach is what makes her work unique. During the workshop, she took us through specifications that she had written for a developer to create an interactive visualization and which were insanely detailed. Everybody who writes code would be really thrilled to be able to rely on such a structured document!</p>
<p>The next speaker was Ben Kreukniet from <a href="http://www.uva.co.uk/">UnitedVisualArtists</a>. Now UVA may not be a household name, but how about Red Hot Chili Peppers or U2? Remember how everyone was talking about the gigantic scenic structure on the U2 last tour, which AFAIK was the highest-grossing concert tour ever? that was UVA&#8217;s work. They are lighting artists who specialize in large installations, and by large they mean friggin&#8217; epic.</p>
<p>Ben&#8217;s talk took us through their work, with a focus on their &#8220;origin&#8221; project:</p>
<p><a href="http://www.uva.co.uk/wp-content/gallery/origin/uva_origin_1625.jpg"><img class="aligncenter" src="http://www.uva.co.uk/wp-content/gallery/origin/uva_origin_1625.jpg" alt="" width="814" height="543" /></a></p>
<p>Origin is a gigantic cube of light and sound which is made to interact with an audience. During the workshop the next day, UVA showed us the tools they use to work, which revolves around a platform they call d3 (though not that <a href="http://d3-js.org/">d3</a>). And we had the privilege to preview their next work which would be an advertisement campaign to be shown in movie theaters.</p>
<p>The next speaker was <a href="http://www.legoman.net/site/index.php/en/">Yannick Jacquet</a> from the <a href="http://www.antivj.com/">antiVJ</a> collective. More than a portfolio talk, this was an introduction to what VJing is about for the many of us who only had a vague idea. Basically, VJing is about showing moving pictures. But it doesn&#8217;t have to be ugly psychedelic shapes moving on flat screens in night clubs. antiVJ was created in reaction to this reductive view of the field. Through a technique called video-mapping, VJs can use one projector to cast images on many separate surfaces, and with a couple of projectors which can be controlled from just one computer, they can cover very complex geometries.</p>
<p><a href="http://www.legoman.net/site/images/works/intangible-states/intangible-states1.jpg"><img class="aligncenter" src="http://www.legoman.net/site/images/works/intangible-states/intangible-states1.jpg" alt="" width="800" height="364" /></a></p>
<p>Next was Michael Madsen. I covered his workshop talk in my previous post, but during the conference he presented his movie &#8220;Into Eternity&#8221;:</p>
<p style="text-align: center;"><a href="http://jckr.github.io/blog/wp-content/uploads/2012/05/into-eternity-poster.jpg"><img class="aligncenter" title="into-eternity-poster" src="https://jckr.github.io/blog/wp-content/uploads/2012/05/into-eternity-poster-747x1024.jpg" alt="" width="598" height="819" /></a></p>
<p>Here&#8217;s the story. In Finland, law requires that nuclear waste be disposed within the country. So a company is building a bunker to bury it deep, deep within the earth &#8211; eventually, canisters of nuclear waste will be stored 4000 meters underground. In 2100, the facility will be reaching its capacity and it will be sealed and expected to remain undisturbed for the next 100 000 years. This is the first human creation designed with such a horizon. Contrary to religious buildings which are being built &#8220;forever&#8221; everything has been done to give the facility the highest chances to last 100 000 years. This led to surprising choices. First, the location of the facility is secret. When it will be sealed, there will be no distinctive mark at all. And while there is a possibility of a next ice age or a similar global disaster and with that the possibility that the security be breached. This is precisely on what the movie is about &#8211; which decisions were made, why, with what perspective.</p>
<p>So documentaries are all about telling stories visually, which could also be told of data visualization. Only for documentaries, the angle &#8211; a combination of the subject, the approach, the questions that need to be answered &#8211; is the result of an overly elaborate research, which we sometimes do in datavis, and sometimes don&#8217;t. More often than not it&#8217;s tempting to just go ahead with a form that agrees with the dataset though, so this work process is a welcome perspective.</p>
<p>The last talk of the conference was by none other than Manuel Lima, who pioneered visualization blogs with <a href="http://www.visualcomplexity.com/">visualcomplexity</a>. Both his talks (to the exception of the description of his experience at Bing) relate to material in his highly-recommended book, <a href="http://www.visualcomplexity.com/vc/book/">Visual Complexity: Mapping Patterns of Information</a>, the See conference talk focusing more on trees and hierarchical displays of information and the second one more on networks.</p>
<p><div id="attachment_1259" style="width: 610px" class="wp-caption aligncenter"><a href="http://jckr.github.io/blog/wp-content/uploads/2012/05/manuel.jpg"><img class="size-full wp-image-1259" title="manuel" src="https://jckr.github.io/blog/wp-content/uploads/2012/05/manuel.jpg" alt="" width="600" height="450" /></a><p class="wp-caption-text">Trees can be taken literally</p></div></p>
<p>This was definitely the closest talk to actual datavis practice. The principles he exposed really come to life with the examples, so I will encourage you to watch <a href="http://www.see-conference.org/video-stream/">his talk in its entirety</a> (it should be available on the 12th of May). In passing, in his workshop talk he mentioned that most of his &#8220;ancient&#8221; examples come from an out-of-print grimmoire called <em>The Album of Science</em>, I found one for $4 on Amazon so you may want to check it out.</p>
<p>That about wraps it up.</p>
<p>Pros of see conference:</p>
<ul>
<li>really cheap to attend from anywhere in Europe &#8211; transportation, accommodation and conference fees are super reasonable.</li>
<li>big.</li>
<li>not just about datavis, but rather on subjects which are particularly interesting for the datavis practitioner.</li>
<li>in pleasant Wiesbaden.</li>
<li>party-time/conference-time ratio about optimal.</li>
<li>workshop is really, really fantastic (and free to attend btw).</li>
</ul>
<p>Cons:</p>
<ul>
<li>you&#8217;re kind of expected to speak German.</li>
</ul>
	    		<div class="clear">&nbsp;</div>
	</section>
</article><!-- #post-## -->
			
				
<article id="post-1250" class="post-1250 post type-post status-publish format-standard hentry category-data-visualization tag-conference tag-michael-madsen tag-practice tag-see-conference tag-see">
		    <header class="post-header">
        			<span class="post-meta">
				<span class="posted-on"><a href="/blog/2012/05/03/impressions-from-wiesbaden/" rel="bookmark"><time class="entry-date published" datetime="2012-05-03T01:59:15+00:00">May 3, 2012</time></a></span><span class="byline"> by <span class="author vcard"><a class="url fn n" href="/blog/author/jerome/">jerome</a></span></span> on <a href="/blog/category/data-visualization/" rel="category tag">data visualization</a>			</span>
		        <h1 class="post-title"><a href="/blog/2012/05/03/impressions-from-wiesbaden/" rel="bookmark">Impressions from Wiesbaden</a></h1>
         
    </header>
	<section class="post-content">

		<p>I&#8217;m just returning from the 7th <a href="http://see-conference.com/">See conference</a> on information visualization. I&#8217;ll do a longer, more descriptive post later (a lot happens in just 2 days) but for now I would like to mention one talk which really moved me. After the conference proper which takes place in the impressive <a href="http://www.lutherkirche-wiesbaden.de/">Lutherkirche</a> which sit hundreds, the See+ workshop was held in the offices of the organizing agency, <a href="http://www.s-v.de/">Scholz und Volkmer</a>. Most speakers of the main conference came back for a more laid-back discussion with a much smaller audience.</p>
<p>The theme of See+ was tools. Speakers were invited to tell us how they work.</p>
<p>One characteristic of the See conference is that it offers a broader perspective on data visualization. In addition to well-known datavis specialists, such as Manuel Lima this year, other guests include visual artists and designers who also work with data, as well as experts in communication who apply that skill to data.</p>
<p>Michael Madsen is a Danish film-maker who lives in Berlin. In his see conference talk, he presented <a href="http://www.imdb.com/title/tt1194612/">Into Eternity</a>, a powerful documentary about an incredible facility in <del>Black Mesa</del> Finland which is designed to hold nuclear waste for 100,000 years. While the eerie tone of the narration is fascinating this was perhaps the topic most remote from &#8220;traditional&#8221; datavis (as in data, graphs and stuff).</p>
<p>Then came his See+ talk which took a turn I didn&#8217;t expect.</p>
<p><div style="width: 610px" class="wp-caption alignnone"><img class="" src="http://25.media.tumblr.com/tumblr_m3d58aEkJ51rv82n3o1_1280.jpg" alt="" width="600" height="800" /><p class="wp-caption-text">Pic courtesy of Joshua de Haseth. I&#39;m actually the guy on the right.</p></div></p>
<p>Filming a documentary takes at least two years by a conservative count. A filmmaker first worry is therefore to find what will drive them for that long. More than a 9 to 5 job, more than a simple theme, what they are looking for is a vision, one unique way to treat one unique subject. Michael elaborated on the difference between executing what you are told to do, and a fulfilling calling that comes from the self. The flipside is that it is very difficult to go through times of no project. One subject powerful enough to give one a reason to work everyday for years does not simply come by; it can take months or even years of doubt before one is found. In Michael&#8217;s words: when I have no project, I have no identity. But when he does, his thrill is to seek and explore as he is doing something that has never been done before.</p>
<p>(I&#8217;m leaving a lot out which is more directly related to film-making.)</p>
<p>As he was discussing that I could sense people in the room tune to this, as I did. We datavis practitioners are all makers, tinkerers, inventors. Fortunately, our work cycles are often shorter and it is easier to start a new one. Certainly, there are patterns and recipes and things that need to be done for work. There are also hacks found on stackoverflow (thanks for that) and inspiration from the works of other (and thanks for the debugging console).</p>
<p>But there is also a &#8220;great unknown&#8221; in visualization &#8211; data that has never been collected let alone represented, techniques that have never been used, combinations that have never been tried &#8211; and things that can not even be put in words. All of this requires curiosity, independence and dedication. And the outcome may not live up to expectations. But it&#8217;s just a reminder that to do what we do we must leave our comfort zones and our ways, set off and explore.</p>
<p>&nbsp;</p>
	    		<div class="clear">&nbsp;</div>
	</section>
</article><!-- #post-## -->
			
			
		
		</main><!-- #main -->
	</section><!-- #primary -->

	<div id="secondary" class="widget-area" role="complementary">
		<aside id="search-2" class="widget widget_search"><form role="search" method="get" class="search-form" action="/">
				<label>
					<span class="screen-reader-text">Search for:</span>
					<input type="search" class="search-field" placeholder="Search &hellip;" value="" name="s" />
				</label>
				<input type="submit" class="search-submit" value="Search" />
			</form></aside>		<aside id="recent-posts-2" class="widget widget_recent_entries">		<h1 class="widget-title">Recent Posts</h1>		<ul>
					<li>
				<a href="/blog/2016/08/17/the-big-leagues/">The big leagues</a>
						</li>
					<li>
				<a href="/blog/2016/08/17/creating-a-react-visualization-web-app/">Creating a React visualization web app</a>
						</li>
					<li>
				<a href="/blog/2016/08/13/beyond-rendering/">Beyond rendering</a>
						</li>
					<li>
				<a href="/blog/2016/08/11/react-components/">React components</a>
						</li>
					<li>
				<a href="/blog/2016/08/10/coding-with-react/">Coding with React</a>
						</li>
				</ul>
		</aside>		<aside id="recent-comments-2" class="widget widget_recent_comments"><h1 class="widget-title">Recent Comments</h1><ul id="recentcomments"><li class="recentcomments"><span class="comment-author-link"><a href='http://omeraz.wordpress.com/' rel='external nofollow' class='url'>עומר עזריאל</a></span> on <a href="/blog/2016/08/17/the-big-leagues/#comment-567">The big leagues</a></li><li class="recentcomments"><span class="comment-author-link">Carlos Ayres</span> on <a href="/blog/2012/05/28/manipulating-data-like-a-boss-with-d3/#comment-312">Manipulating data like a boss with d3</a></li><li class="recentcomments"><span class="comment-author-link"><a href='https://migrate.powertripanalytics.com/game-of-thrones-interactions-among-the-top-30-characters/' rel='external nofollow' class='url'>Game of ThronesInteractions Among the Top 30 Characters &#8211; PowerTrip Analytics</a></span> on <a href="/blog/2013/05/13/making-the-game-of-thrones-visualization/#comment-466">Making the game of thrones visualization</a></li><li class="recentcomments"><span class="comment-author-link"><a href='https://abgoswam.wordpress.com/2016/10/08/d3-getting-started/' rel='external nofollow' class='url'>D3 &#8211; Getting Started | abgoswam&#039;s tech blog</a></span> on <a href="/blog/2012/09/04/getting-to-hello-world-with-d3/#comment-419">Getting to &#8220;Hello world&#8221; with d3</a></li><li class="recentcomments"><span class="comment-author-link"><a href='https://plus.google.com/+BrotoBhattacharjee' rel='external nofollow' class='url'>Broto Bhattacharjee</a></span> on <a href="/blog/2012/09/04/getting-to-hello-world-with-d3/#comment-418">Getting to &#8220;Hello world&#8221; with d3</a></li></ul></aside><aside id="archives-2" class="widget widget_archive"><h1 class="widget-title">Archives</h1>		<ul>
			<li><a href='/2016/08/'>August 2016</a></li>
	<li><a href='/2015/05/'>May 2015</a></li>
	<li><a href='/2015/02/'>February 2015</a></li>
	<li><a href='/2014/10/'>October 2014</a></li>
	<li><a href='/2013/11/'>November 2013</a></li>
	<li><a href='/2013/05/'>May 2013</a></li>
	<li><a href='/2013/03/'>March 2013</a></li>
	<li><a href='/2013/01/'>January 2013</a></li>
	<li><a href='/2012/12/'>December 2012</a></li>
	<li><a href='/2012/11/'>November 2012</a></li>
	<li><a href='/2012/10/'>October 2012</a></li>
	<li><a href='/2012/09/'>September 2012</a></li>
	<li><a href='/2012/07/'>July 2012</a></li>
	<li><a href='/2012/06/'>June 2012</a></li>
	<li><a href='/2012/05/'>May 2012</a></li>
	<li><a href='/2012/04/'>April 2012</a></li>
	<li><a href='/2012/01/'>January 2012</a></li>
	<li><a href='/2011/11/'>November 2011</a></li>
	<li><a href='/2011/10/'>October 2011</a></li>
	<li><a href='/2011/09/'>September 2011</a></li>
	<li><a href='/2011/08/'>August 2011</a></li>
	<li><a href='/2011/07/'>July 2011</a></li>
	<li><a href='/2011/06/'>June 2011</a></li>
	<li><a href='/2011/05/'>May 2011</a></li>
	<li><a href='/2011/04/'>April 2011</a></li>
	<li><a href='/2011/03/'>March 2011</a></li>
	<li><a href='/2011/02/'>February 2011</a></li>
	<li><a href='/2011/01/'>January 2011</a></li>
	<li><a href='/2010/11/'>November 2010</a></li>
	<li><a href='/2010/04/'>April 2010</a></li>
	<li><a href='/2010/03/'>March 2010</a></li>
	<li><a href='/2010/02/'>February 2010</a></li>
	<li><a href='/2010/01/'>January 2010</a></li>
	<li><a href='/2009/12/'>December 2009</a></li>
	<li><a href='/2009/10/'>October 2009</a></li>
	<li><a href='/2009/09/'>September 2009</a></li>
	<li><a href='/2009/08/'>August 2009</a></li>
	<li><a href='/2009/07/'>July 2009</a></li>
	<li><a href='/2009/06/'>June 2009</a></li>
	<li><a href='/2009/05/'>May 2009</a></li>
	<li><a href='/2008/12/'>December 2008</a></li>
	<li><a href='/2008/11/'>November 2008</a></li>
	<li><a href='/2008/10/'>October 2008</a></li>
		</ul>
		</aside><aside id="categories-2" class="widget widget_categories"><h1 class="widget-title">Categories</h1>		<ul>
	<li class="cat-item cat-item-2"><a href="/blog/category/book-review/" >book review</a>
</li>
	<li class="cat-item cat-item-3"><a href="/blog/category/charts/" >charts</a>
</li>
	<li class="cat-item cat-item-4"><a href="/blog/category/conferences/" >conferences</a>
</li>
	<li class="cat-item cat-item-5"><a href="/blog/category/d3/" >d3</a>
</li>
	<li class="cat-item cat-item-6"><a href="/blog/category/dashboards/" >dashboards</a>
</li>
	<li class="cat-item cat-item-7"><a href="/blog/category/data-publishing/" >data publishing</a>
</li>
	<li class="cat-item cat-item-8"><a href="/blog/category/data-visualization/" >data visualization</a>
</li>
	<li class="cat-item cat-item-9"><a href="/blog/category/francais/" >français</a>
</li>
	<li class="cat-item cat-item-10"><a href="/blog/category/javascript/" >javascript</a>
</li>
	<li class="cat-item cat-item-11"><a href="/blog/category/presentation/" >presentation</a>
</li>
	<li class="cat-item cat-item-12"><a href="/blog/category/protovis/" >protovis</a>
</li>
	<li class="cat-item cat-item-13"><a href="/blog/category/react/" >react</a>
</li>
	<li class="cat-item cat-item-14"><a href="/blog/category/tips/" >tips</a>
</li>
	<li class="cat-item cat-item-1"><a href="/blog/category/uncategorized/" >Uncategorized</a>
</li>
	<li class="cat-item cat-item-15"><a href="/blog/category/web-sites/" >web sites</a>
</li>
		</ul>
</aside><aside id="meta-2" class="widget widget_meta"><h1 class="widget-title">Meta</h1>			<ul>
						<li><a href="/blog/wp-login.php">Log in</a></li>
			<li><a href="/blog/feed/">Entries <abbr title="Really Simple Syndication">RSS</abbr></a></li>
			<li><a href="/blog/comments/feed/">Comments <abbr title="Really Simple Syndication">RSS</abbr></a></li>
			<li><a href="https://wordpress.org/" title="Powered by WordPress, state-of-the-art semantic personal publishing platform.">WordPress.org</a></li>			</ul>
			</aside>		<div class="clear">&nbsp;</div>
	</div><!-- #secondary -->
	<footer id="colophon" class="site-footer" role="contentinfo">
	    <a class="subscribe icon-feed" href="/blog/feed/"><span class="tooltip">Subscribe!</span></a>
		<div class="site-info inner">
		    <section class="copyright">
		    			    		<a href="https://github.com/lacymorrow/casper" rel="home">Casper WP</a> by Lacy Morrow		    			    </section>
		</div><!-- .site-info -->
	</footer><!-- #colophon -->
</main><!-- /#content -->

<script type='text/javascript' src='/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shCore.js?ver=3.0.9b'></script>
<script type='text/javascript' src='/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushJScript.js?ver=3.0.9b'></script>
<script type='text/javascript'>
	(function(){
		var corecss = document.createElement('link');
		var themecss = document.createElement('link');
		var corecssurl = "/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shCore.css?ver=3.0.9b";
		if ( corecss.setAttribute ) {
				corecss.setAttribute( "rel", "stylesheet" );
				corecss.setAttribute( "type", "text/css" );
				corecss.setAttribute( "href", corecssurl );
		} else {
				corecss.rel = "stylesheet";
				corecss.href = corecssurl;
		}
		document.getElementsByTagName("head")[0].insertBefore( corecss, document.getElementById("syntaxhighlighteranchor") );
		var themecssurl = "/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shThemeDefault.css?ver=3.0.9b";
		if ( themecss.setAttribute ) {
				themecss.setAttribute( "rel", "stylesheet" );
				themecss.setAttribute( "type", "text/css" );
				themecss.setAttribute( "href", themecssurl );
		} else {
				themecss.rel = "stylesheet";
				themecss.href = themecssurl;
		}
		//document.getElementById("syntaxhighlighteranchor").appendChild(themecss);
		document.getElementsByTagName("head")[0].insertBefore( themecss, document.getElementById("syntaxhighlighteranchor") );
	})();
	SyntaxHighlighter.config.strings.expandSource = '+ expand source';
	SyntaxHighlighter.config.strings.help = '?';
	SyntaxHighlighter.config.strings.alert = 'SyntaxHighlighter\n\n';
	SyntaxHighlighter.config.strings.noBrush = 'Can\'t find brush for: ';
	SyntaxHighlighter.config.strings.brushNotHtmlScript = 'Brush wasn\'t configured for html-script option: ';
	SyntaxHighlighter.defaults['pad-line-numbers'] = false;
	SyntaxHighlighter.defaults['toolbar'] = false;
	SyntaxHighlighter.all();
</script>
<script type='text/javascript' src='/wp-content/themes/casper/js/main.js?ver=1.0.0'></script>
<script type='text/javascript' src='/wp-includes/js/wp-embed.min.js?ver=4.6.10'></script>
<!--stats_footer_test--></body>
</html>
