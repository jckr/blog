<!DOCTYPE html>
<html lang="en-US">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="HandheldFriendly" content="True" />
<meta name="MobileOptimized" content="320" />

<title>Creating a React visualization web app | jckr.github.io/blog</title>

<link rel="profile" href="http://gmpg.org/xfn/11">
<link rel="pingback" href="/blog/xmlrpc.php">
<link rel='dns-prefetch' href='//fonts.googleapis.com' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel="alternate" type="application/rss+xml" title="jckr.github.io/blog &raquo; Feed" href="/blog/feed/" />
<link rel="alternate" type="application/rss+xml" title="jckr.github.io/blog &raquo; Comments Feed" href="/blog/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="jckr.github.io/blog &raquo; Creating a React visualization web app Comments Feed" href="/blog/2016/08/17/creating-a-react-visualization-web-app/feed/" />
<!-- This site uses the Google Analytics by MonsterInsights plugin v7.0.5 - Using Analytics tracking - https://www.monsterinsights.com/ -->
<!-- Note: MonsterInsights is not currently configured on this site. The site owner needs to authenticate with Google Analytics in the MonsterInsights settings panel. -->
<!-- No UA code set -->
<!-- / Google Analytics by MonsterInsights -->
		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2\/svg\/","svgExt":".svg","source":{"concatemoji":"http:\/\/localhost:8888\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.6.10"}};
			!function(a,b,c){function d(a){var c,d,e,f,g,h=b.createElement("canvas"),i=h.getContext&&h.getContext("2d"),j=String.fromCharCode;if(!i||!i.fillText)return!1;switch(i.textBaseline="top",i.font="600 32px Arial",a){case"flag":return i.fillText(j(55356,56806,55356,56826),0,0),!(h.toDataURL().length<3e3)&&(i.clearRect(0,0,h.width,h.height),i.fillText(j(55356,57331,65039,8205,55356,57096),0,0),c=h.toDataURL(),i.clearRect(0,0,h.width,h.height),i.fillText(j(55356,57331,55356,57096),0,0),d=h.toDataURL(),c!==d);case"diversity":return i.fillText(j(55356,57221),0,0),e=i.getImageData(16,16,1,1).data,f=e[0]+","+e[1]+","+e[2]+","+e[3],i.fillText(j(55356,57221,55356,57343),0,0),e=i.getImageData(16,16,1,1).data,g=e[0]+","+e[1]+","+e[2]+","+e[3],f!==g;case"simple":return i.fillText(j(55357,56835),0,0),0!==i.getImageData(16,16,1,1).data[0];case"unicode8":return i.fillText(j(55356,57135),0,0),0!==i.getImageData(16,16,1,1).data[0];case"unicode9":return i.fillText(j(55358,56631),0,0),0!==i.getImageData(16,16,1,1).data[0]}return!1}function e(a){var c=b.createElement("script");c.src=a,c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var f,g,h,i;for(i=Array("simple","flag","unicode8","diversity","unicode9"),c.supports={everything:!0,everythingExceptFlag:!0},h=0;h<i.length;h++)c.supports[i[h]]=d(i[h]),c.supports.everything=c.supports.everything&&c.supports[i[h]],"flag"!==i[h]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[i[h]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(g=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",g,!1)):(a.attachEvent("onload",g),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),f=c.source||{},f.concatemoji?e(f.concatemoji):f.wpemoji&&f.twemoji&&(e(f.twemoji),e(f.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<link rel='stylesheet' id='YoutubeShortcodeMargenn-css'  href='/wp-content/plugins/youtube-shortcode/youtube-shortcode.css?ver=4.6.10' type='text/css' media='all' />
<link rel='stylesheet' id='casper-google-fonts-css'  href='//fonts.googleapis.com/css?family=Noto+Serif%3A400%2C700%2C400italic%7COpen+Sans%3A700%2C400&#038;ver=4.6.10' type='text/css' media='all' />
<link rel='stylesheet' id='casper-style-css'  href='/wp-content/themes/casper/style.css?ver=4.6.10' type='text/css' media='all' />
<script type='text/javascript' src='/wp-includes/js/jquery/jquery.js?ver=1.12.4'></script>
<script type='text/javascript' src='/wp-includes/js/jquery/jquery-migrate.min.js?ver=1.4.1'></script>
<link rel='https://api.w.org/' href='/wp-json/' />
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="/blog/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="/blog/wp-includes/wlwmanifest.xml" /> 
<link rel='prev' title='Beyond rendering' href='/2016/08/13/beyond-rendering/' />
<link rel='next' title='The big leagues' href='/2016/08/17/the-big-leagues/' />
<meta name="generator" content="WordPress 4.6.10" />
<link rel="canonical" href="/blog/2016/08/17/creating-a-react-visualization-web-app/" />
<link rel="alternate" type="application/json+oembed" href="/blog/wp-json/oembed/1.0/embed?url=http%3A%2F%2Flocalhost%3A8888%2F2016%2F08%2F17%2Fcreating-a-react-visualization-web-app%2F" />
<link rel="alternate" type="text/xml+oembed" href="/blog/wp-json/oembed/1.0/embed?url=http%3A%2F%2Flocalhost%3A8888%2F2016%2F08%2F17%2Fcreating-a-react-visualization-web-app%2F&#038;format=xml" />

   	<style type="text/css">
					.blog-title a, .blog-description, .social-icons a { color: #222222; }
		
						                
		
							.main-navigation a { color: ; }
		                                            </style>
    		<style type="text/css">.recentcomments a{display:inline !important;padding:0 !important;margin:0 !important;}</style>
			<style type="text/css">
			.site-title a,
		.site-description {
			color: #222222;
		}
		</style>
	<style type="text/css" id="syntaxhighlighteranchor"></style>
</head>

<body class="single single-post postid-1761 single-format-standard group-blog">

<header id="masthead" role="banner" class="site-head site-header" style="background-image: url(/wp-content/uploads/2018/04/Screenshot-2018-04-09-19.38.59.png);">
    <nav id="site-navigation" class="main-navigation" role="navigation">
        <div>
            <h1 class="menu-toggle">
                <a class="icon-bars" href="#">
                    <span class="hidden">Menu</span>
                </a>
            </h1>
            <a class="skip-link screen-reader-text" href="#content">Skip to content</a>
            <div class="menu"><ul><li ><a href="/blog/">Home</a></li></ul></div>
        </div>
    </nav><!-- #site-navigation -->

    <div class="vertical-row">
        <div class="vertical">
            <div class="site-head-content inner">
                
                <div class="social-icons">
                                                                                                                                                                                                                                                                                                                                                                                                                                                    </div>
                <h1 class="blog-title"><a class="blog-logo" href='/blog/' rel='home'>jckr.github.io/blog</a></h1>
                <h2 class="blog-description">Just another WordPress site</h2>
            </div>
        </div>
    </div>
</header><!-- #masthead -->

<main id="content" class="content" role="main">


		
			<article id="post-1761" class="post-1761 post type-post status-publish format-standard hentry category-uncategorized">
    <header class="post-header">
                	<span class="post-meta">
        	    <span class="posted-on"><a href="/blog/2016/08/17/creating-a-react-visualization-web-app/" rel="bookmark"><time class="entry-date published" datetime="2016-08-17T07:36:32+00:00">August 17, 2016</time></a></span><span class="byline"> by <span class="author vcard"><a class="url fn n" href="/blog/author/jerome/">jerome</a></span></span> | <a href="/blog/category/uncategorized/" rel="category tag">Uncategorized</a>        	</span>
		        <h1 class="post-title"><a href="/blog/2016/08/17/creating-a-react-visualization-web-app/" rel="bookmark">Creating a React visualization web app</a></h1>
        
    </header>
    		<section class="post-content">
		    <p>This is the 6th post in my <a href="/blog/2016/08/09/visualization-with-react/">Visualization with React</a> series. Previous post: <a href="/blog/2016/08/13/beyond-rendering/">Beyond rendering</a></p>
<p>Playing with codepen is fun, but chances are that you have other ambitions for your visualization projects. In the real world, well, in my day job at least, React is used to create web apps. So, in that last part, we&#8217;re going to create our own web app, load some real data, and use some existing modules to visualize it like pros! In this article, we are going to build this:<br />
<img src="https://jckr.github.io/blog/assets/visualization-with-react/example-app-screenshot.png" alt="" /><br />
You can try a demo of the app at <a href="https://jckr.github.io/example-react-app/">https://jckr.github.io/example-react-app/</a>.<br />
All the code is at <a href="https://github.com/jckr/example-react-app">https://github.com/jckr/example-react-app</a>.</p>
<p>What&#8217;s the difference between a web app and a web page you may ask? Well, a web page is an html document with some links to scripts or some inline javascript. A web app is a comprehensive system of code files working together, including a server. All of these files are transformed via a build system, which creates a compiled version that runs on the browser. Such transformations can include JSX support, or supporting ES6/ES7 syntax. Your work can be split in many, easy to read, easy to maintain source files, but your browser will just read one single file written in a version of Javascript it can understand. </p>
<p>That may sound like a lot of work to setup. Up to a few weeks ago, the easiest way to get started was to use a web scaffolding tool such as <a href="http://yeoman.io/">Yeoman</a>. Scaffolding means that all the little parts that need to be installed or configured to get that going are taken care of, leaving you with a structure that you can use to build your web app upon.<br />
Facebook recently released &#8216;create-react-app&#8217;, which is a simpler scaffolding tool, aimed at simple React apps.</p>
<p>You will need access to a command line environment, such as Terminal on MacOS or Cygwin on windows, and have nodejs and npm installed. (see <a href="https://nodejs.org/en/">https://nodejs.org/en/</a>). You will need node version 4 and above. You may want to use <a href="https://github.com/creationix/nvm">nvm</a> to easily change versions of node if needed.</p>
<p>Here&#8217;s an illustrated guide to what you need to do to get started:<br />
<img src="https://jckr.github.io/blog/assets/visualization-with-react/installing-create-react-app.png" alt="" /><br />
First, install create-react-app with the command: npm install create-react-app -g.<br />
<img src="https://jckr.github.io/blog/assets/visualization-with-react/create-a-new-react-app.png" alt="" /><br />
From the parent directory where you want your app to be, use the command: create-react-app + the name of your app. This will also be the name of the directory this app will be in.<br />
<img src="https://jckr.github.io/blog/assets/visualization-with-react/start-the-app.png" alt="" /><br />
The above command will copy a bunch of files. When it&#8217;s done, go to the directory of your app and type npm start&#8230;<br />
<img src="https://jckr.github.io/blog/assets/visualization-with-react/a-new-react-app-created-with-create-react-app.png" alt="" /><br />
And lo and behold, the app will start and a browser window will appear with the results!<br />
From now on, whenever you change one of the source files, the app will reload and reflect the changes.</p>
<p>Remember when we did scatterplots, I never really got into doing the menial work of making gridlines, axes etc. Exactly for this reason &#8211; it can be a lot of manual work.<br />
But now that we are going to build a professional looking web app, we are going to go all the way. </p>
<h2>One component, one file</h2>
<p>The app we are building has 3 components: the App, which is the parent; Scatterplot, which is the chart proper and HintContent, for some fine control about what the tooltip looks like.<br />
There an index.html and an index.js file, which are very simple: </p>
<pre class="brush: xml; title: ; notranslate" title="">
&lt;!doctype html&gt;
&lt;html lang=&quot;en&quot;&gt;
  &lt;head&gt;
    &lt;meta charset=&quot;utf-8&quot;&gt;
    &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1&quot;&gt;
    &lt;title&gt;React App&lt;/title&gt;
  &lt;/head&gt;
  &lt;body&gt;
    &lt;div id=&quot;root&quot;&gt;&lt;/div&gt;
  &lt;/body&gt;
&lt;/html&gt;
</pre>
<pre class="brush: plain; title: ; notranslate" title="">
import React from 'react';
import ReactDOM from 'react-dom';
import App from './App';
import './index.css';

ReactDOM.render(
  &lt;App /&gt;,
  document.getElementById('root')
);
</pre>
<p>There&#8217;s really not much to say about the index.html. All it does it create a div with an id of root, where everything will go.<br />
The index.js ends with the familiar command ReactDOM.render( &#8230; ), which will output our component into the aforementioned root div.</p>
<p>But it starts with a few import statements. What they do is that they link the source files together.<br />
Index starts by importing functionalities from react: React and ReactDOM. This was done in our codepen environment by using the settings.<br />
The next two lines link our index.js file with other files that we control: App and index.css. App contains our highest-level component, and index.css contains the styles.<br />
I&#8217;ve done some changes in index.css for styles I couldn&#8217;t reach with react &#8211; styles of the body, for instance, or some styles of elements created by libraries over which I didn&#8217;t have direct control (more on that later). Else, I&#8217;m using inline styles, in the React tradition.</p>
<p>Let&#8217;s move to our App.js source file, which describes the App component.</p>
<p>Its last line is: </p>
<pre class="brush: plain; title: ; notranslate" title="">
export default App;
</pre>
<p>And this is the line which corresponds to what we had seen earlier in index.js: </p>
<pre class="brush: plain; title: ; notranslate" title="">
import App from './App';
</pre>
<p>With this pair of statements, inside of index.js, App will be equivalent to what it was inside of App.js when exported.<br />
Using this construct, using import and export, files can be kept short, legible and focused on one specific problem.</p>
<p>But let&#8217;s take another look at the first two lines of App.js: </p>
<pre class="brush: plain; title: ; notranslate" title="">
import React, {Component} from 'react';
import {csv} from 'd3-request';
</pre>
<p>What are those curly braces?</p>
<p>If a module (a javascript file which imports or exports) has a <em>default</em> export, then when importing it, you can just use </p>
<pre class="brush: plain; title: ; notranslate" title="">
import WhatEverNameYouWant from 'module'; 
</pre>
<p>Where WhatEverNameYouWant is actually whatever name you want. Typically, it would start by an uppercase letter, but you do you.<br />
But a module can export other things than the default export. In that case, you have to use curly braces. There&#8217;s many articles on the subject such as <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/import">this one</a>. I&#8217;m mostly bringing it up so that you see there&#8217;s a difference between using the curly braces or not.</p>
<p>In our source files, we are going to use export default. We are also going to define <em>one component only</em> per source file, which makes the whole import / export deal easier to follow.</p>
<p>create-react-app has no dependencies beyond react &#8211; which means that it doesn&#8217;t need other modules to be installed. But this project does! It needs d3-request and react-vis.<br />
You can install them from the command line, by typing npm install d3-request &#8211;save, and npm install react-vis. </p>
<h2>The App component &#8211; loading and passing data</h2>
<p>Our app component will do two things: load the data, and when the data is loaded, pass it to the Scatterplot component so it can draw a chart.<br />
I&#8217;ve hinted at the componentWillMount lifecycle method as a great place to load data, so let&#8217;s try that!</p>
<pre class="brush: plain; title: ; notranslate" title="">
class App extends Component {
  constructor(props) {
    super(props);
    this.state = {};
  }
</pre>
<p>I&#8217;m starting with the constructor method. The only reason why I do that is to initialize the state to an empty object. If I didn&#8217;t, the state would initially be <em>undefined</em>. And while it&#8217;s not a deal-breaker, I would have to add more tests so that the app doesn&#8217;t break before there&#8217;s anything actually useful in the state.</p>
<pre class="brush: plain; title: ; notranslate" title="">
  componentWillMount() {
    csv('./src/data/birthdeathrates.csv', (error, data) =&gt; {
      if (error) {
        this.setState({loadError: true});
      }
      this.setState({
        data: data.map(d =&gt; ({...d, x: Number(d.birth), y: Number(d.death)}))
      });
    })
  }
</pre>
<p>ComponentWillMount: there we go.<br />
we are using the same data file as before. Here, I&#8217;ve hardcoded it in a string, but that address could totally come from a property passed to App.<br />
Also, note I&#8217;m using csv from d3. That used to be d3.csv, but not anymore because I&#8217;m importing just <em>csv</em> from d3, or more precisely from its sublibrary &#8216;d3-request&#8217;. One of the big changes of d3 v4, also recently released, is that its code is available as smaller chunks. There are other ways to load a csv file, but d3&#8217;s csv method is super convenient and it&#8217;s also a great way to show how to cherrypick one useful part of a large library.</p>
<p>So, we are loading this file. What&#8217;s next? If loading the file raises an error, I am going to signal it via the state (setState({loadError: true});). Else, I am going to pass the content of the file to the state.<br />
Not just the raw contents: I am going to slightly transform it. Inside the csv method, data is an array of objects corresponding to the columns of my file. There are three columns: country, birth and deaths. I have therefore arrays with three properties, and their values is what is being read by csv from the file, as strings.<br />
The map statement turns that object into: a copy of all these properties (that&#8217;s what {&#8230;d does), plus x and y properties which simply convert the birth and deaths properties of each object to numbers (ie &#8220;36.4&#8221; to 36.4).<br />
So, whether this file succeeds or fails to load, I&#8217;m going to change the state of the component. </p>
<p>What values can the state take? </p>
<p>When the component is first created, state is empty.<br />
Then, componentWillMount attempts to load the file. State is still empty. During that very short time, render will fire (more on that soon).<br />
Then, the file will either load or not. If it loads, state will now hold a data property, and since state changes, the component will re-render. If it doesn&#8217;t load, state will have a loadError property and the component will also re-render.</p>
<p>Which takes us to the rendering of the component. You&#8217;ll see that these 3 situations are taken care of.</p>
<pre class="brush: plain; title: ; notranslate" title="">
render() {
    if (this.state.loadError) {
      return &lt;div&gt;couldn't load file&lt;/div&gt;;
    }
    if (!this.state.data) {
      return &lt;div /&gt;;
    }
    return &lt;div style={{
      background: '#fff',
      borderRadius: '3px',
      boxShadow: '0 1 2 0 rgba(0,0,0,0.1)',
      margin: 12,
      padding: 24,
      width: '350px'
    }}&gt;
      &lt;h1&gt;Birth and death rates of selected countries&lt;/h1&gt;
      &lt;h2&gt;per 1,000 inhabitants&lt;/h2&gt;
      &lt;Scatterplot data={this.state.data}/&gt;
    &lt;/div&gt;;
  }
</pre>
<p>if (this.state.loadError) &#8211; that&#8217;s the situation where the data didn&#8217;t load. That&#8217;s also why I did initiate state to an empty object, because if this.state was undefined, this syntax would cause an error. (this.state &#038;&#038; this.state.error) would be ok, but I might as well just initialize the state.</p>
<p>if (!this.state.data) takes care of the situation where the data didn&#8217;t load yet. We <em>also</em> know that there hasn&#8217;t been an error yet, else the first condition would have been triggered. In a professional setting, that&#8217;s where you&#8217;d put a progress bar or a spinner. Loading a 70 line csv isn&#8217;t going to take long though, so that would be over the top, which is why there&#8217;s just an empty div.</p>
<p>Finally, if neither of these conditions are met, we are going to render a card with a Scatterplot element inside. We&#8217;re going to render a little more than <em>just</em> the Scatterplot element &#8211; we&#8217;re styling the div on which it will stand and adding some titling.</p>
<h2>The Scatterplot component: introducing react-vis</h2>
<p><a href="https://github.com/uber/react-vis/">React-vis</a> is the charting library we use at Uber.<br />
The main idea is that we can create charts by composing elements, just like a web page: </p>
<pre class="brush: plain; title: ; notranslate" title="">
&lt;XYPlot
  width={300}
  height={300}&gt;
  &lt;HorizontalGridLines /&gt;
  &lt;LineSeries
    data={[
      {x: 1, y: 10},
      {x: 2, y: 5},
      {x: 3, y: 15}
    ]}/&gt;
  &lt;XAxis /&gt;
  &lt;YAxis /&gt;
&lt;/XYPlot&gt;
</pre>
<p>&#8230; creates a very simple line chart with horizontal gridlines and axes. Don&#8217;t want the gridline? remove the <horizontalgridlines /> part. Want vertical gridlines too? Just add <verticalgridlines /> underneath.<br />
Do you need another line chart? You can add another LineSeries element. Or a VerticalBarSeries. Or a RadialChart (pie or donut charts). And so on and so forth.<br />
React-vis handles all the nitty gritty of making charts, so we don&#8217;t have to.</p>
<p>Let&#8217;s dive into Scatterplot. </p>
<pre class="brush: plain; title: ; notranslate" title="">
import React, {Component} from 'react';
import {
  Hint,
  HorizontalGridLines,
  MarkSeries,
  VerticalGridLines,
  XAxis,
  XYPlot,
  YAxis
} from 'react-vis';
</pre>
<p>scatterplot.js starts by familiar import statements. We only import what we need from &#8216;react-vis&#8217;.</p>
<pre class="brush: plain; title: ; notranslate" title="">
import HintContent from './hint-content.js';
</pre>
<p>Then, we import HintContent &#8211; hint-content.js uses a default export, so no need for curly braces. By the way, that .js extension is not mandatory in the file name.</p>
<pre class="brush: plain; title: ; notranslate" title="">
export default class Scatterplot extends Component {
  constructor(props) {
    super(props);
    this.state = {
      value: null
    };
    this._rememberValue = this._rememberValue.bind(this);
    this._forgetValue = this._forgetValue.bind(this);
  }

  _rememberValue(value) {
    this.setState({value});
  }

  _forgetValue() {
    this.setState({
      value: null
    });
  }
</pre>
<p>We could have made Scatterplot a pure functional component&#8230; if we had passed callback functions for handling mouseover. Those functions could have changed the state of the App component, which would re-render its children &#8211; Scatterplot. Since no component outside of Scatterplot is interested in knowing where the mouse is, that component can have its own state.<br />
We are also adding two private functions. They have to be bound to &#8220;this&#8221; &#8211; we are creating a class, and those functions have to be tied to each instance of that class. The other way  to think about it is: you can add private functions to a React component, but if they use the state, properties or private variables, you <em>will</em> have to bind them to &#8216;this&#8217; in the constructor. </p>
<pre class="brush: plain; title: ; notranslate" title="">
render() {
    const {data} = this.props;
    const {value} = this.state;
    return &lt;div&gt;
      &lt;XYPlot
        margin={{top:5, left: 60, right: 5, bottom: 30}}
        width={320}
        height={290}&gt;
        &lt;VerticalGridLines /&gt;
        &lt;HorizontalGridLines /&gt;
        &lt;XAxis/&gt;
        &lt;YAxis/&gt;
        &lt;MarkSeries
          data={data}
          onValueMouseOver={this._rememberValue}
          onValueMouseOut={this._forgetValue}
          opacity={0.7}
        /&gt;
        {value ?
          &lt;Hint value={value}&gt;
            &lt;HintContent value={value} /&gt;
          &lt;/Hint&gt; :
          null
        }
      &lt;/XYPlot&gt;
      &lt;div style={{
        color: '#c6c6c6',
        fontSize: 11,
        lineHeight: '13px',
        textAlign: 'right',
        transform: 'rotate(-90deg) translate(120px, -160px)'
      }}&gt;Death Rates&lt;/div&gt;
      &lt;div style={{
        color: '#c6c6c6',
        fontSize: 11,
        lineHeight: '13px',
        textAlign: 'right',
        transform: 'translate(-5px,-14px)',
        width: '320px'
      }}&gt;Birth Rates&lt;/div&gt;
    &lt;/div&gt;;
  }
</pre>
<p>What we are returning is a div element. The reason is that at the very end, we are writing the name of the axes on that div. But mostly, that div will hold a XYPlot component, which comes from react-vis. I&#8217;m passing: a margin property, a height and a width. Margin is optional and I&#8217;m using it for control. Height is mandatory, width as well, though react-vis has a responsive component that makes the charts adapt to the width of the page (not used here).<br />
Then, I&#8217;m simply adding: horizontal and vertical gridlines, and horizontal and vertical axes. I&#8217;m using default settings for all of them (full disclosure &#8211; I&#8217;ve changed a few things via the index.css stylesheet). But the way labels and lines are organized is fine by me.<br />
Then, we&#8217;re adding the MarkSeries component, which is all the circles. </p>
<pre class="brush: plain; title: ; notranslate" title="">
 &lt;MarkSeries
  data={data}
  onValueMouseOver={this._rememberValue}
  onValueMouseOut={this._forgetValue}
  opacity={0.7}
/&gt;
</pre>
<p>The data property comes from the properties passed to the Scatterplot component. It needs to have an x and y properties, which is why I transformed our csv file like so. It could also have a size or a color property, but we&#8217;re not going to use these in our example.<br />
I&#8217;m using an opacity property to better show which marks overlap. I could also have made them smaller, but I&#8217;m sticking to the defaults.<br />
Finally, we&#8217;re using the onValueMouseOver and onValueMouseOut properties to pass functions to handle what happens when the user is going to, well, mouse over one of the marks, or remove their mouse cursor from them. Those are our private functions from before:</p>
<pre class="brush: plain; title: ; notranslate" title="">
  _rememberValue(value) {
    this.setState({value});
  }

  _forgetValue() {
    this.setState({
      value: null
    });
  }
</pre>
<p>When a user passes their mouse on a mark, the corresponding datapoint (value) will be passed to the state. And when the user removes their mouse, the value property is reset to null.</p>
<p>finally, right under the MarkSeries component, is where we call our Hint: </p>
<pre class="brush: plain; title: ; notranslate" title="">
  {value ?
    &lt;Hint value={value}&gt;
      &lt;HintContent value={value} /&gt;
    &lt;/Hint&gt; :
    null
   }
</pre>
<p>If value (from the state) is worth something, then we create a Hint component. That one comes from react-vis, and handles positioning of the tooltip plus some default content. But I want to control exactly what I show inside my tooltip, so I&#8217;ve created a component to do just that.<br />
Creating a specialized component like this is great, because it hides this complexity from the Scatterplot component. All that Scatterplot needs to know is that it&#8217;s passing properties to a HintContent component, which returns&#8230; something good.</p>
<p>Because of imports and exports, it&#8217;s generally a good idea to create such small specialized components. </p>
<h2>For the win: the hint content component</h2>
<pre class="brush: plain; title: ; notranslate" title="">
import React from 'react';
export default function HintContent({value}) {
  const {birth, country, death} = value;
  return &lt;div&gt;
    &lt;div style={{
      borderBottom: '1px solid #717171',
      fontWeight: 'bold',
      marginBottom: 5,
      paddingBottom: 5,
      textTransform: 'uppercase'
    }}&gt;{country}&lt;/div&gt;
    {_hintRow({label: 'Birth Rates', value: birth})},
    {_hintRow({label: 'Death Rates', value: death})}
  &lt;/div&gt;;
}

function _hintRow({label, value}) {
  return &lt;div style={{position: 'relative', height: '15px', width: '100%'}}&gt;
    &lt;div style={{position: 'absolute'}}&gt;{label}&lt;/div&gt;
    &lt;div style={{position: 'absolute', right: 0}}&gt;{value}&lt;/div&gt;
  &lt;/div&gt;;
}
</pre>
<p>The HintComponent is a pure functional component and is our default export.<br />
There&#8217;s another function in that module, and we&#8217;re not exporting it. In other words, it won&#8217;t be accessible by other parts of the app. The only place where it can be used is within this file. Traditionally, those start with an underscore.</p>
<p>The only point of the HintComponent is to offer fine control on the appearance of the tooltip (which also receives styles from index.css). But I wanted to control exactly how the various parts of the data point will appear inside.<br />
So, it has 3 rows. The first one contains the name of the country (well, its 3-letter ISO code). I chose to make it bolder and uppercase. Also, it will have a border separating it from the rest of the card.<br />
The next two rows are similar, which is why I created a function to render them as opposed to just retype it.<br />
It&#8217;s a relative div, which takes all the space, with two absolute divs as children. The label one has no position information, so its attached to its top left corner, but the value one has a right attribute of 0, so its attached to its top right corner. So, for each row, the label is going to be left-aligned, and the value, right-aligned. </p>
<p>And that&#8217;s it! </p>
<p>For our <a href="/blog/2016/08/17/the-big-leagues/">grand finale</a>, we are going to create a more complex application with several charts that interact with one another&#8230;</p>
		    			<div class="clear">&nbsp;</div>
		</section>
	
	<footer class="post-footer">

	    <section class="author">
	    	<img alt='' src='https://0.gravatar.com/avatar/9bb03f0a91eab52fe022450c323810f2?s=100&#038;d=mm&#038;r=g' srcset='http://0.gravatar.com/avatar/9bb03f0a91eab52fe022450c323810f2?s=200&amp;d=mm&amp;r=g 2x' class='avatar avatar-100 photo' height='100' width='100' />	        <h4>jerome</h4>
	        <p></p>
			<div class="clear">&nbsp;</div>
	    </section>
	</footer>
</article><!-- #post-## -->

				<nav class="pagination navigation post-navigation" role="navigation">
		<div class="nav-links">
			<div class="older-posts"><a href="/blog/2016/08/13/beyond-rendering/" rel="prev">Beyond rendering <span class="meta-nav">&rarr;</span></a></div>				<div class="page-number">&bull;</div>
				<div class="newer-posts"><a href="/blog/2016/08/17/the-big-leagues/" rel="next"><span class="meta-nav">&larr;</span> The big leagues</a></div>		</div><!-- .nav-links -->
	</nav><!-- .navigation -->
	
			
<div id="comments" class="comments-area">

	
			<h2 class="comments-title">
			2 thoughts on &ldquo;<span>Creating a React visualization web app</span>&rdquo;		</h2>

		
		<ol class="comment-list">
					<li id="comment-564" class="comment even thread-even depth-1 parent">
			<article id="div-comment-564" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://0.gravatar.com/avatar/0d12047141e9d4fd699b783e3441e652?s=32&#038;d=mm&#038;r=g' srcset='http://0.gravatar.com/avatar/0d12047141e9d4fd699b783e3441e652?s=64&amp;d=mm&amp;r=g 2x' class='avatar avatar-32 photo' height='32' width='32' />						<b class="fn"><a href='http://twitter.com/srhise' rel='external nofollow' class='url'>Sean Hise (@srhise)</a></b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="/blog/2016/08/17/creating-a-react-visualization-web-app/#comment-564">
							<time datetime="2016-08-26T03:40:32+00:00">
								August 26, 2016 at 3:40 am							</time>
						</a>
											</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>One of the links to your github repo is broken.</p>
				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/2016/08/17/creating-a-react-visualization-web-app/?replytocom=564#respond' onclick='return addComment.moveForm( "div-comment-564", "564", "respond", "1761" )' aria-label='Reply to Sean Hise (@srhise)'>Reply</a></div>			</article><!-- .comment-body -->
<ol class="children">
		<li id="comment-565" class="comment byuser comment-author-jerome bypostauthor odd alt depth-2">
			<article id="div-comment-565" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://0.gravatar.com/avatar/9bb03f0a91eab52fe022450c323810f2?s=32&#038;d=mm&#038;r=g' srcset='http://0.gravatar.com/avatar/9bb03f0a91eab52fe022450c323810f2?s=64&amp;d=mm&amp;r=g 2x' class='avatar avatar-32 photo' height='32' width='32' />						<b class="fn"><a href='http://jckr.github.io/blog/' rel='external nofollow' class='url'>jerome</a></b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="/blog/2016/08/17/creating-a-react-visualization-web-app/#comment-565">
							<time datetime="2016-08-26T06:12:50+00:00">
								August 26, 2016 at 6:12 am							</time>
						</a>
											</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>fixed, thanks!</p>
				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/2016/08/17/creating-a-react-visualization-web-app/?replytocom=565#respond' onclick='return addComment.moveForm( "div-comment-565", "565", "respond", "1761" )' aria-label='Reply to jerome'>Reply</a></div>			</article><!-- .comment-body -->
</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		
	
	
					<div id="respond" class="comment-respond">
			<h3 id="reply-title" class="comment-reply-title">Leave a Reply <small><a rel="nofollow" id="cancel-comment-reply-link" href="/blog/2016/08/17/creating-a-react-visualization-web-app/#respond" style="display:none;">Cancel reply</a></small></h3>				<form action="/wp-comments-post.php" method="post" id="commentform" class="comment-form" novalidate>
					<p class="comment-notes"><span id="email-notes">Your email address will not be published.</span> Required fields are marked <span class="required">*</span></p><p class="comment-form-comment"><label for="comment">Comment</label> <textarea id="comment" name="comment" cols="45" rows="8" maxlength="65525" aria-required="true" required="required"></textarea></p><p class="comment-form-author"><label for="author">Name <span class="required">*</span></label> <input id="author" name="author" type="text" value="" size="30" maxlength="245" aria-required='true' required='required' /></p>
<p class="comment-form-email"><label for="email">Email <span class="required">*</span></label> <input id="email" name="email" type="email" value="" size="30" maxlength="100" aria-describedby="email-notes" aria-required='true' required='required' /></p>
<p class="comment-form-url"><label for="url">Website</label> <input id="url" name="url" type="url" value="" size="30" maxlength="200" /></p>
<p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Post Comment" /> <input type='hidden' name='comment_post_ID' value='1761' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
</p><p style="display: none;"><input type="hidden" id="akismet_comment_nonce" name="akismet_comment_nonce" value="4f67f292ad" /></p><p style="display: none;"><input type="hidden" id="ak_js" name="ak_js" value="22"/></p>				</form>
					</div><!-- #respond -->
		
</div><!-- #comments -->

		

	<div id="secondary" class="widget-area" role="complementary">
		<aside id="search-2" class="widget widget_search"><form role="search" method="get" class="search-form" action="/">
				<label>
					<span class="screen-reader-text">Search for:</span>
					<input type="search" class="search-field" placeholder="Search &hellip;" value="" name="s" />
				</label>
				<input type="submit" class="search-submit" value="Search" />
			</form></aside>		<aside id="recent-posts-2" class="widget widget_recent_entries">		<h1 class="widget-title">Recent Posts</h1>		<ul>
					<li>
				<a href="/blog/2016/08/17/the-big-leagues/">The big leagues</a>
						</li>
					<li>
				<a href="/blog/2016/08/17/creating-a-react-visualization-web-app/">Creating a React visualization web app</a>
						</li>
					<li>
				<a href="/blog/2016/08/13/beyond-rendering/">Beyond rendering</a>
						</li>
					<li>
				<a href="/blog/2016/08/11/react-components/">React components</a>
						</li>
					<li>
				<a href="/blog/2016/08/10/coding-with-react/">Coding with React</a>
						</li>
				</ul>
		</aside>		<aside id="recent-comments-2" class="widget widget_recent_comments"><h1 class="widget-title">Recent Comments</h1><ul id="recentcomments"><li class="recentcomments"><span class="comment-author-link"><a href='http://omeraz.wordpress.com/' rel='external nofollow' class='url'>עומר עזריאל</a></span> on <a href="/blog/2016/08/17/the-big-leagues/#comment-567">The big leagues</a></li><li class="recentcomments"><span class="comment-author-link">Carlos Ayres</span> on <a href="/blog/2012/05/28/manipulating-data-like-a-boss-with-d3/#comment-312">Manipulating data like a boss with d3</a></li><li class="recentcomments"><span class="comment-author-link"><a href='https://migrate.powertripanalytics.com/game-of-thrones-interactions-among-the-top-30-characters/' rel='external nofollow' class='url'>Game of ThronesInteractions Among the Top 30 Characters &#8211; PowerTrip Analytics</a></span> on <a href="/blog/2013/05/13/making-the-game-of-thrones-visualization/#comment-466">Making the game of thrones visualization</a></li><li class="recentcomments"><span class="comment-author-link"><a href='https://abgoswam.wordpress.com/2016/10/08/d3-getting-started/' rel='external nofollow' class='url'>D3 &#8211; Getting Started | abgoswam&#039;s tech blog</a></span> on <a href="/blog/2012/09/04/getting-to-hello-world-with-d3/#comment-419">Getting to &#8220;Hello world&#8221; with d3</a></li><li class="recentcomments"><span class="comment-author-link"><a href='https://plus.google.com/+BrotoBhattacharjee' rel='external nofollow' class='url'>Broto Bhattacharjee</a></span> on <a href="/blog/2012/09/04/getting-to-hello-world-with-d3/#comment-418">Getting to &#8220;Hello world&#8221; with d3</a></li></ul></aside><aside id="archives-2" class="widget widget_archive"><h1 class="widget-title">Archives</h1>		<ul>
			<li><a href='/2016/08/'>August 2016</a></li>
	<li><a href='/2015/05/'>May 2015</a></li>
	<li><a href='/2015/02/'>February 2015</a></li>
	<li><a href='/2014/10/'>October 2014</a></li>
	<li><a href='/2013/11/'>November 2013</a></li>
	<li><a href='/2013/05/'>May 2013</a></li>
	<li><a href='/2013/03/'>March 2013</a></li>
	<li><a href='/2013/01/'>January 2013</a></li>
	<li><a href='/2012/12/'>December 2012</a></li>
	<li><a href='/2012/11/'>November 2012</a></li>
	<li><a href='/2012/10/'>October 2012</a></li>
	<li><a href='/2012/09/'>September 2012</a></li>
	<li><a href='/2012/07/'>July 2012</a></li>
	<li><a href='/2012/06/'>June 2012</a></li>
	<li><a href='/2012/05/'>May 2012</a></li>
	<li><a href='/2012/04/'>April 2012</a></li>
	<li><a href='/2012/01/'>January 2012</a></li>
	<li><a href='/2011/11/'>November 2011</a></li>
	<li><a href='/2011/10/'>October 2011</a></li>
	<li><a href='/2011/09/'>September 2011</a></li>
	<li><a href='/2011/08/'>August 2011</a></li>
	<li><a href='/2011/07/'>July 2011</a></li>
	<li><a href='/2011/06/'>June 2011</a></li>
	<li><a href='/2011/05/'>May 2011</a></li>
	<li><a href='/2011/04/'>April 2011</a></li>
	<li><a href='/2011/03/'>March 2011</a></li>
	<li><a href='/2011/02/'>February 2011</a></li>
	<li><a href='/2011/01/'>January 2011</a></li>
	<li><a href='/2010/11/'>November 2010</a></li>
	<li><a href='/2010/04/'>April 2010</a></li>
	<li><a href='/2010/03/'>March 2010</a></li>
	<li><a href='/2010/02/'>February 2010</a></li>
	<li><a href='/2010/01/'>January 2010</a></li>
	<li><a href='/2009/12/'>December 2009</a></li>
	<li><a href='/2009/10/'>October 2009</a></li>
	<li><a href='/2009/09/'>September 2009</a></li>
	<li><a href='/2009/08/'>August 2009</a></li>
	<li><a href='/2009/07/'>July 2009</a></li>
	<li><a href='/2009/06/'>June 2009</a></li>
	<li><a href='/2009/05/'>May 2009</a></li>
	<li><a href='/2008/12/'>December 2008</a></li>
	<li><a href='/2008/11/'>November 2008</a></li>
	<li><a href='/2008/10/'>October 2008</a></li>
		</ul>
		</aside><aside id="categories-2" class="widget widget_categories"><h1 class="widget-title">Categories</h1>		<ul>
	<li class="cat-item cat-item-2"><a href="/blog/category/book-review/" >book review</a>
</li>
	<li class="cat-item cat-item-3"><a href="/blog/category/charts/" >charts</a>
</li>
	<li class="cat-item cat-item-4"><a href="/blog/category/conferences/" >conferences</a>
</li>
	<li class="cat-item cat-item-5"><a href="/blog/category/d3/" >d3</a>
</li>
	<li class="cat-item cat-item-6"><a href="/blog/category/dashboards/" >dashboards</a>
</li>
	<li class="cat-item cat-item-7"><a href="/blog/category/data-publishing/" >data publishing</a>
</li>
	<li class="cat-item cat-item-8"><a href="/blog/category/data-visualization/" >data visualization</a>
</li>
	<li class="cat-item cat-item-9"><a href="/blog/category/francais/" >français</a>
</li>
	<li class="cat-item cat-item-10"><a href="/blog/category/javascript/" >javascript</a>
</li>
	<li class="cat-item cat-item-11"><a href="/blog/category/presentation/" >presentation</a>
</li>
	<li class="cat-item cat-item-12"><a href="/blog/category/protovis/" >protovis</a>
</li>
	<li class="cat-item cat-item-13"><a href="/blog/category/react/" >react</a>
</li>
	<li class="cat-item cat-item-14"><a href="/blog/category/tips/" >tips</a>
</li>
	<li class="cat-item cat-item-1"><a href="/blog/category/uncategorized/" >Uncategorized</a>
</li>
	<li class="cat-item cat-item-15"><a href="/blog/category/web-sites/" >web sites</a>
</li>
		</ul>
</aside><aside id="meta-2" class="widget widget_meta"><h1 class="widget-title">Meta</h1>			<ul>
						<li><a href="/blog/wp-login.php">Log in</a></li>
			<li><a href="/blog/feed/">Entries <abbr title="Really Simple Syndication">RSS</abbr></a></li>
			<li><a href="/blog/comments/feed/">Comments <abbr title="Really Simple Syndication">RSS</abbr></a></li>
			<li><a href="https://wordpress.org/" title="Powered by WordPress, state-of-the-art semantic personal publishing platform.">WordPress.org</a></li>			</ul>
			</aside>		<div class="clear">&nbsp;</div>
	</div><!-- #secondary -->
	<footer id="colophon" class="site-footer" role="contentinfo">
	    <a class="subscribe icon-feed" href="/blog/feed/"><span class="tooltip">Subscribe!</span></a>
		<div class="site-info inner">
		    <section class="copyright">
		    			    		<a href="https://github.com/lacymorrow/casper" rel="home">Casper WP</a> by Lacy Morrow		    			    </section>
		</div><!-- .site-info -->
	</footer><!-- #colophon -->
</main><!-- /#content -->

<script type='text/javascript' src='/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shCore.js?ver=3.0.9b'></script>
<script type='text/javascript' src='/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushXml.js?ver=3.0.9b'></script>
<script type='text/javascript' src='/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushPlain.js?ver=3.0.9b'></script>
<script type='text/javascript'>
	(function(){
		var corecss = document.createElement('link');
		var themecss = document.createElement('link');
		var corecssurl = "/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shCore.css?ver=3.0.9b";
		if ( corecss.setAttribute ) {
				corecss.setAttribute( "rel", "stylesheet" );
				corecss.setAttribute( "type", "text/css" );
				corecss.setAttribute( "href", corecssurl );
		} else {
				corecss.rel = "stylesheet";
				corecss.href = corecssurl;
		}
		document.getElementsByTagName("head")[0].insertBefore( corecss, document.getElementById("syntaxhighlighteranchor") );
		var themecssurl = "/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shThemeDefault.css?ver=3.0.9b";
		if ( themecss.setAttribute ) {
				themecss.setAttribute( "rel", "stylesheet" );
				themecss.setAttribute( "type", "text/css" );
				themecss.setAttribute( "href", themecssurl );
		} else {
				themecss.rel = "stylesheet";
				themecss.href = themecssurl;
		}
		//document.getElementById("syntaxhighlighteranchor").appendChild(themecss);
		document.getElementsByTagName("head")[0].insertBefore( themecss, document.getElementById("syntaxhighlighteranchor") );
	})();
	SyntaxHighlighter.config.strings.expandSource = '+ expand source';
	SyntaxHighlighter.config.strings.help = '?';
	SyntaxHighlighter.config.strings.alert = 'SyntaxHighlighter\n\n';
	SyntaxHighlighter.config.strings.noBrush = 'Can\'t find brush for: ';
	SyntaxHighlighter.config.strings.brushNotHtmlScript = 'Brush wasn\'t configured for html-script option: ';
	SyntaxHighlighter.defaults['pad-line-numbers'] = false;
	SyntaxHighlighter.defaults['toolbar'] = false;
	SyntaxHighlighter.all();
</script>
<script type='text/javascript' src='/wp-content/themes/casper/js/main.js?ver=1.0.0'></script>
<script type='text/javascript' src='/wp-includes/js/comment-reply.min.js?ver=4.6.10'></script>
<script type='text/javascript' src='/wp-includes/js/wp-embed.min.js?ver=4.6.10'></script>
<script async="async" type='text/javascript' src='/wp-content/plugins/akismet/_inc/form.js?ver=4.0.3'></script>
<!--stats_footer_test--></body>
</html>
